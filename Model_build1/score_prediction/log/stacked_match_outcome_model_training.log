2024-10-22 23:17:54,213 - INFO - Model directory checked/created.
2024-10-22 23:17:54,331 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-22 23:17:56,018 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-22 23:17:56,019 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (13447, 56)
2024-10-22 23:17:56,831 - INFO - New score dataframe created with errors:    running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
0        7971         2.122105         1.201717              3.0              0.0                 1.0    0.877895   -1.201717       0.006483
1        7972         0.935789        -0.003282              1.0              1.0                 0.0    0.064211    1.003282      -1.024491
2       14408         2.325106         0.318673              3.0              2.0                 1.0    0.674894    1.681327       0.010585
3       14410         1.086156         0.081375              1.0              2.0                -1.0   -0.086156    1.918625      -1.992787
4        6411         0.816743         2.678010              0.0              2.0                -1.0   -0.816743   -0.678010       0.039193
2024-10-22 23:17:56,856 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-22 23:17:58,563 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-22 23:17:58,563 - INFO - Data prepared for modeling. Feature shape: (13447, 44), Target shape: (13447,)
2024-10-22 23:17:58,563 - INFO - Data split into train and test. Train shape: (10757, 44), Test shape: (2690, 44)
2024-10-22 23:17:58,580 - INFO - Data scaling completed.
2024-10-22 23:17:58,596 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-22 23:19:32,998 - INFO - Feature selection using RFE completed.
2024-10-22 23:19:33,219 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-22 23:21:31,966 - INFO - Stacking model for match_outcome trained successfully.
2024-10-22 23:21:33,854 - INFO - match_outcome Stacking Model MSE: 0.000975602237268025, R2: 0.9983297176266359, Stacking Model MAE: 0.010053732381882358, Stacking Model MAPE: inf%
2024-10-22 23:30:01,581 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpo0s8trb6\assets
2024-10-22 23:30:01,650 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-22 23:30:02,161 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-22 23:30:02,243 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-22 23:30:02,310 - INFO - Start match_outcome predictions
2024-10-22 23:30:02,320 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-22 23:30:02,397 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-22 23:30:02,415 - INFO - [[-1.54187569 -1.54728339  1.2267892  ...  0.27838243 -0.81743435
   0.30176534]
 [-1.54173038  0.78407313  3.32179812 ...  0.6832782  -1.13245679
   1.59659553]
 [-1.54158506  0.6462861   0.0138893  ...  0.10485567 -0.34881889
   0.52218069]
 ...
 [ 1.20369695 -0.75914158  1.55758008 ...  0.03680596  0.17852332
   0.68708253]
 [ 1.20384227 -0.69300381  0.12415293 ... -0.69047531 -0.32335066
   0.10798555]
 [ 1.20398758 -1.50870302  1.33705283 ...  0.46636975  0.9245927
  -0.12914709]]
2024-10-22 23:30:02,580 - INFO - home goal predictions: [ 0.92751473  1.0585284   0.67094594 ... -0.07623851  1.0359368
  1.0433294 ]
2024-10-22 23:30:02,588 - INFO - home goal error predictions: [-0.36806607 -0.53599976 -0.51460543 ... -0.54290077 -0.39219515
 -0.33482962]
2024-10-23 00:34:24,949 - INFO - Model directory checked/created.
2024-10-23 00:34:25,035 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 00:34:26,841 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 00:34:26,854 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (13447, 56)
2024-10-23 00:34:27,550 - INFO - New score dataframe created with errors:    running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
0        7971         2.122105         1.201717              3.0              0.0                 1.0    0.877895   -1.201717       0.006483
1        7972         0.935789        -0.003282              1.0              1.0                 0.0    0.064211    1.003282      -1.024491
2       14408         2.325106         0.318673              3.0              2.0                 1.0    0.674894    1.681327       0.010585
3       14410         1.086156         0.081375              1.0              2.0                -1.0   -0.086156    1.918625      -1.992787
4        6411         0.816743         2.678010              0.0              2.0                -1.0   -0.816743   -0.678010       0.039193
2024-10-23 00:34:27,555 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 00:34:29,200 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-23 00:34:29,200 - INFO - Data prepared for modeling. Feature shape: (13447, 44), Target shape: (13447,)
2024-10-23 00:34:29,200 - INFO - Data split into train and test. Train shape: (10757, 44), Test shape: (2690, 44)
2024-10-23 00:34:29,217 - INFO - Data scaling completed.
2024-10-23 00:34:29,234 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-23 00:36:03,049 - INFO - Feature selection using RFE completed.
2024-10-23 00:36:03,266 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-23 00:38:08,041 - INFO - Stacking model for match_outcome trained successfully.
2024-10-23 00:38:09,919 - INFO - match_outcome Stacking Model MSE: 0.005543089882412348, R2: 0.9991241007573978, Stacking Model MAE: 0.025834663638163495, Stacking Model MAPE: 1.111667259783793%
2024-10-23 00:47:06,661 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpi0i_qjtw\assets
2024-10-23 00:47:06,732 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-23 00:47:07,275 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-23 00:47:07,373 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-23 00:47:07,445 - INFO - Start match_outcome predictions
2024-10-23 00:47:07,449 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-23 00:47:07,538 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-23 00:47:07,549 - INFO - [[-1.54187569 -1.54728339  1.2267892  ...  0.27838243 -0.56028235
   0.30176534]
 [-1.54173038  0.78407313  3.32179812 ...  0.6832782   0.22943566
   1.59659553]
 [-1.54158506  0.6462861   0.0138893  ...  0.10485567  0.05485029
   0.52218069]
 ...
 [ 1.20369695 -0.75914158  1.55758008 ...  0.03680596  0.09358698
   0.68708253]
 [ 1.20384227 -0.69300381  0.12415293 ... -0.69047531 -0.07915163
   0.10798555]
 [ 1.20398758 -1.50870302  1.33705283 ...  0.46636975  0.28096446
  -0.12914709]]
2024-10-23 00:47:07,707 - INFO - home goal predictions: [1.0833676 1.218996  1.7881725 ... 4.115946  1.008523  1.0012605]
2024-10-23 00:47:07,720 - INFO - home goal error predictions: [-0.46724365 -0.55016977 -0.52285438 ... -0.58614097 -0.47491951
 -0.41963544]
2024-10-23 19:26:10,091 - INFO - Model directory checked/created.
2024-10-23 19:26:15,041 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 64)
2024-10-23 19:26:16,424 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 19:26:16,424 - INFO - Data loaded with 5174 rows
2024-10-23 19:26:16,439 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 64)
2024-10-23 19:26:16,966 - INFO - new real scores length: 92
2024-10-23 19:26:16,970 - INFO - prediction_df length: 3754
2024-10-23 19:26:16,972 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 19:26:18,657 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-23 19:26:18,657 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 19:26:18,657 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 19:26:18,675 - INFO - Data scaling completed.
2024-10-23 19:26:18,689 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-23 19:28:40,858 - INFO - Feature selection using RFE completed.
2024-10-23 19:28:41,074 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-23 19:30:30,679 - INFO - Stacking model for match_outcome trained successfully.
2024-10-23 19:30:32,416 - INFO - match_outcome Stacking Model MSE: 0.005564993201499581, R2: 0.999134049007922, Stacking Model MAE: 0.03460236188507091, Stacking Model MAPE: 1.5721353955906532%
2024-10-23 19:37:53,706 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmplvu134lt\assets
2024-10-23 19:37:53,775 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-23 19:37:54,272 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-23 19:37:54,353 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-23 19:37:54,354 - INFO - Start match_outcome predictions
2024-10-23 19:37:54,356 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 19:37:54,440 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-23 19:37:54,450 - INFO - [[ -1.53341891   0.48031961  -1.29687217 ... -15.98830556 -16.20428816
   32.33591896]
 [ -1.53327399  -0.11199913  -1.18637382 ... -15.99106351 -16.19335345
   40.1458725 ]
 [ -1.53312906   1.67132611   0.13960643 ... -15.99808138 -16.20765789
   39.92090491]
 ...
 [  2.40468564  -0.35402184  -0.96537711 ... -15.99568487 -16.20690169
   44.390742  ]
 [  2.40483057   0.30835611  -1.07587546 ... -15.98262906 -16.20737095
   44.390742  ]
 [  2.40497549  -1.57687343  -0.7443804  ... -15.98483461 -16.21177063
   45.30373   ]]
2024-10-23 19:37:54,583 - INFO - home goal predictions: [399.01248 421.50003 375.9546  ... 377.31134 391.45096 392.22598]
2024-10-23 19:41:00,173 - INFO - Model directory checked/created.
2024-10-23 19:41:07,057 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 64)
2024-10-23 19:41:08,786 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 19:41:08,789 - INFO - Data loaded with 5174 rows
2024-10-23 19:41:08,794 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 64)
2024-10-23 19:41:09,776 - INFO - new real scores length: 92
2024-10-23 19:41:09,776 - INFO - prediction_df length: 3754
2024-10-23 19:41:09,791 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 19:41:11,807 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-23 19:41:11,807 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 19:41:11,807 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 19:41:11,824 - INFO - Data scaling completed.
2024-10-23 19:41:11,841 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-23 19:43:52,449 - INFO - Feature selection using RFE completed.
2024-10-23 19:43:52,666 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-23 19:46:03,889 - INFO - Stacking model for match_outcome trained successfully.
2024-10-23 19:46:05,830 - INFO - match_outcome Stacking Model MSE: 0.005707868829140298, R2: 0.9991118165833675, Stacking Model MAE: 0.03863947454243863, Stacking Model MAPE: 1.7832176226854672%
2024-10-23 19:54:22,371 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpga1lr453\assets
2024-10-23 19:54:22,456 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-23 19:54:23,094 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-23 19:54:23,174 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-23 19:54:23,174 - INFO - Start match_outcome predictions
2024-10-23 19:54:23,174 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 19:54:23,292 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-23 19:54:23,314 - INFO - [[-1.53341891e+00  4.80319613e-01 -1.29687217e+00 ...  1.44085374e+03
  -1.62042882e+01  6.53662516e+02]
 [-1.53327399e+00 -1.11999126e-01 -1.18637382e+00 ...  1.39230321e+03
  -1.61933534e+01  4.89629506e+02]
 [-1.53312906e+00  1.67132611e+00  1.39606434e-01 ...  1.29469812e+03
  -1.62076579e+01  8.91333264e+01]
 ...
 [ 2.40468564e+00 -3.54021837e-01 -9.65377109e-01 ...  1.35852055e+03
  -1.62069017e+01  9.97848205e+01]
 [ 2.40483057e+00  3.08356108e-01 -1.07587546e+00 ...  1.33765070e+03
  -1.62073710e+01  9.97848205e+01]
 [ 2.40497549e+00 -1.57687343e+00 -7.44380401e-01 ...  1.34239751e+03
  -1.62117706e+01  3.36247991e+02]]
2024-10-23 19:54:23,343 - INFO - X_new_prepared:             0         1         2          3           4          5         6         7         8   ...        21        22        23        24        25           26           27         28           29
0    -1.533419  0.480320 -1.296872  18.379416   -7.217877  17.774578 -1.786437  0.965258 -0.858445  ... -0.457068  0.652989 -1.547638  0.898067  1.742432  1267.355217  1440.853740 -16.204288   653.662516
1    -1.533274 -0.111999 -1.186374   6.027313  123.837806   7.873112 -0.255387 -1.083457 -0.510086  ... -1.128716  0.913409 -1.552738  2.212351  0.519073  1343.191127  1392.303205 -16.193353   489.629506
2    -1.533129  1.671326  0.139606   7.857254   15.574416 -25.131772 -0.255387 -0.937121 -1.083335  ... -0.759310 -0.388693 -1.549821  0.273412  0.419661  1186.435893  1294.698117 -16.207658    89.133326
3    -1.532984  1.110852 -0.744380   1.909945  158.026245  -8.629330 -1.446204 -0.937121 -0.945755  ... -0.624980  0.913409 -1.554330  2.404325  2.335398  1363.104130  1241.295161 -16.205959  1324.706647
4    -1.532839 -1.201101 -1.296872  19.294386   26.970562  24.375554 -1.105970 -0.937121 -0.782379  ... -0.591397  0.392568 -1.551854  1.444455 -0.363359  1211.912790  1387.740068 -16.203318  1145.761546
...        ...       ...       ...        ...         ...        ...       ...       ...       ...  ...       ...       ...       ...       ...       ...          ...          ...        ...          ...
3749  2.404396 -0.315808 -1.186374   2.824916    9.876342  -0.378109 -1.276087 -0.725745 -0.808175  ... -0.792892 -0.649113 -1.547964  1.713218 -0.325348  1252.617493  1357.491550 -16.203461  1083.982880
3750  2.404541  0.582224 -1.296872   4.197372   21.272489   6.222868 -1.786437  1.599385 -0.601806  ... -0.507441  0.392568 -1.551147  1.022111  0.647725  1230.235129  1361.064027 -16.197998   971.077042
3751  2.404686 -0.354022 -0.965377   1.452460  -41.406316  -2.028353 -1.786437 -1.571247 -1.014545  ... -0.708936 -1.169954 -1.550086 -0.129734  0.229607  1211.467146  1358.520546 -16.206902    99.784821
3752  2.404831  0.308356 -1.075875   1.452460   26.970562  -0.378109 -1.786437  0.965258 -0.911360  ... -1.128716  0.392568 -1.551412  0.676558 -1.450464  1254.760753  1337.650704 -16.207371    99.784821
3753  2.404975 -1.576873 -0.744380   0.537489   26.970562  -8.629330 -1.616320  1.599385 -1.152125  ... -0.624980 -0.388693 -1.546904 -0.590472 -0.910713  1239.397282  1342.397509 -16.211771   336.247991

[3754 rows x 30 columns]
2024-10-23 19:54:23,505 - INFO - home goal predictions: [532.70184 501.3919  362.58936 ... 357.77048 370.86145 445.13666]
2024-10-23 21:52:23,477 - INFO - Model directory checked/created.
2024-10-23 21:52:30,267 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-23 21:52:31,729 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 53)
2024-10-23 21:52:31,731 - INFO - Data loaded with 5174 rows
2024-10-23 21:52:31,735 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-23 21:52:32,210 - INFO - new real scores length: 92
2024-10-23 21:52:32,214 - INFO - prediction_df length: 3754
2024-10-23 21:52:32,218 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 21:52:34,142 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-23 21:52:34,142 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 21:52:34,142 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 21:52:34,159 - INFO - Data scaling completed.
2024-10-23 21:52:34,177 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-23 21:55:03,258 - INFO - Feature selection using RFE completed.
2024-10-23 21:55:03,559 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-23 21:57:08,193 - INFO - Stacking model for match_outcome trained successfully.
2024-10-23 21:57:10,125 - INFO - match_outcome Stacking Model MSE: 0.00407000075990661, R2: 0.9993805987642829, Stacking Model MAE: 0.03185073571920729, Stacking Model MAPE: 1.2441014275958446%
2024-10-23 22:05:29,375 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpjau0ipw9\assets
2024-10-23 22:05:29,442 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-23 22:05:29,941 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-23 22:05:30,026 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-23 22:05:30,026 - INFO - Start match_outcome predictions
2024-10-23 22:05:30,042 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 22:05:30,159 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-23 22:05:30,176 - INFO - [[ 5.43481802e-01  1.91734594e-01 -1.07753142e+00 ... -1.61368569e+01
  -1.61442386e+01  8.95698454e+02]
 [ 9.20760406e-01  2.48022206e+00 -5.26714845e-01 ... -1.61248212e+01
  -1.61371197e+01  9.12565113e+02]
 [-1.89359447e-01 -7.23660391e-01  2.44428353e-01 ... -1.61308653e+01
  -1.61495523e+01  4.84573646e+02]
 ...
 [-5.41013219e-01 -1.08981839e+00  1.23589818e+00 ... -1.61292947e+01
  -1.61465252e+01  8.05040163e+02]
 [-5.41881858e-01  1.83944557e+00  1.56638812e+00 ... -1.61270792e+01
  -1.61467799e+01  3.33905232e+01]
 [-5.41157992e-01  6.49432087e-01  1.56638812e+00 ... -1.61315696e+01
  -1.61448670e+01  4.90898643e+02]]
2024-10-23 22:05:30,192 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8   ...        21        22        23        24           25           26         27         28           29
0     0.543482  0.191735 -1.077531 -3.152869 -2.981503 -1.062083 -1.290769 -1.511744  1.920401  ... -6.643509 -1.380818 -1.809635 -0.115472  1168.557181  1310.203326 -16.136857 -16.144239   895.698454
1     0.920760  2.480222 -0.526715  1.445962 -1.278421 -1.213031 -1.108568 -0.808979  7.669334  ... -7.007762 -0.518834  0.307852  0.209980  1333.900353  1294.329998 -16.124821 -16.137120   912.565113
2    -0.189359 -0.723660  0.244428 -1.279271 -8.090748 -1.107368 -1.233831  1.861529  2.064124  ... -7.136906 -0.319915 -1.073265 -0.824328  1057.858718  1206.867814 -16.130865 -16.149552   484.573646
3     1.001544 -0.906739 -0.967368 -1.790253 -2.640886 -1.288505 -1.214852 -1.511744  2.303663  ... -6.958091 -0.585141 -0.411550  0.178485  1197.487658  1238.472051 -16.131977 -16.148373   634.265243
4     0.634834 -1.364437 -0.196225 -4.174832 -5.536125 -1.213031 -1.240158 -1.511744  1.984278  ... -7.007762 -1.778656 -0.615155 -2.870266  1145.984566  1170.837319 -16.134046 -16.149390   322.232055
...        ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...          ...          ...        ...        ...          ...
3749 -0.542316  2.388683  1.566388 -0.086982 -2.470578 -1.103251 -1.171942 -1.256193  5.219789  ... -6.958091  0.041756 -0.591549  0.485421  1199.034027  1310.451079 -16.130436 -16.146377  1418.564877
3750 -0.542461  2.388683  0.905408  0.423999 -3.151811 -1.226754 -1.166541 -1.511744  3.958659  ... -6.727799  0.439595  0.082036 -0.339185  1272.737615  1371.247983 -16.124431 -16.147085   330.665385
3751 -0.541013 -1.089818  1.235898 -2.301234 -3.492427 -1.197936 -1.166541 -0.387320  4.742604  ... -6.719671 -0.956457  0.322660  1.020041  1195.981881  1275.544734 -16.129295 -16.146525   805.040163
3752 -0.541882  1.839446  1.566388 -1.279271 -2.470578 -1.103251 -1.171942 -1.256193  5.219789  ... -6.930998  0.801266 -0.131225  0.347987  1241.455641  1371.490754 -16.127079 -16.146780    33.390523
3753 -0.541158  0.649432  1.566388 -2.301234 -3.151811 -1.123835 -1.166541 -1.256193  5.526550  ... -6.849719 -0.410333  0.766888 -0.284211  1195.969538  1255.891078 -16.131570 -16.144867   490.898643

[3754 rows x 30 columns]
2024-10-23 22:05:30,337 - INFO - home goal predictions: [220.71661  202.7878   248.74397  ... 346.4974    87.02655  120.028244]
2024-10-24 17:30:54,177 - INFO - Model directory checked/created.
2024-10-24 17:30:59,880 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 17:31:01,055 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 17:31:01,057 - INFO - Data loaded with 3754 rows
2024-10-24 17:31:01,063 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 17:31:01,562 - INFO - new real scores length: 92
2024-10-24 17:31:01,580 - INFO - prediction_df length: 3754
2024-10-24 17:31:01,582 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 17:31:06,019 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 17:31:06,022 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 17:31:06,028 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 17:31:06,040 - INFO - Data scaling completed.
2024-10-24 17:31:06,059 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 17:33:37,778 - INFO - Feature selection using RFE completed.
2024-10-24 17:33:37,995 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 17:35:37,196 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 17:35:39,128 - INFO - match_outcome Stacking Model MSE: 0.005917091999354185, R2: 0.9990994954761787, Stacking Model MAE: 0.04010474616474573, Stacking Model MAPE: 1.5860361915710812%
2024-10-24 17:43:32,361 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp796gd_45\assets
2024-10-24 17:43:32,435 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 17:43:33,061 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 17:43:33,146 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 17:43:33,148 - INFO - Start match_outcome predictions
2024-10-24 17:43:33,150 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 17:43:33,262 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 17:43:33,274 - INFO - [[ 5.43481802e-01  1.93968651e+00  1.91734594e-01 ...  1.31020333e+03
  -1.61368569e+01  8.95698454e+02]
 [ 9.20760406e-01 -1.46318221e-01  2.48022206e+00 ...  1.29433000e+03
  -1.61248212e+01  9.12565113e+02]
 [-1.89359447e-01 -1.46318221e-01 -7.23660391e-01 ...  1.20686781e+03
  -1.61308653e+01  4.84573646e+02]
 ...
 [-5.41013219e-01  3.75182961e-01 -1.08981839e+00 ...  1.27554473e+03
  -1.61292947e+01  8.05040163e+02]
 [-5.41881858e-01  3.75182961e-01  1.83944557e+00 ...  1.37149075e+03
  -1.61270792e+01  3.33905232e+01]
 [-5.41157992e-01  1.93968651e+00  6.49432087e-01 ...  1.25589108e+03
  -1.61315696e+01  4.90898643e+02]]
2024-10-24 17:43:33,300 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8   ...        21        22        23        24        25           26           27         28           29
0     0.543482  1.939687  0.191735 -1.077531 -3.152869 -2.981503 -1.062083 -1.290769 -1.511744  ... -1.551364  1.448900 -1.961229 -0.115472 -2.665198  1168.557181  1310.203326 -16.136857   895.698454
1     0.920760 -0.146318  2.480222 -0.526715  1.445962 -1.278421 -1.213031 -1.108568 -0.808979  ... -1.549241  2.220837  0.335464  0.209980 -0.837241  1333.900353  1294.329998 -16.124821   912.565113
2    -0.189359 -0.146318 -0.723660  0.244428 -1.279271 -8.090748 -1.107368 -1.233831  1.861529  ... -1.551364  1.717400 -0.755465 -0.824328 -0.275833  1057.858718  1206.867814 -16.130865   484.573646
3     1.001544  0.896684 -0.906739 -0.967368 -1.790253 -2.640886 -1.288505 -1.214852 -1.511744  ... -1.550480  4.133900  0.297186  0.178485 -0.822500  1197.487658  1238.472051 -16.131977   634.265243
4     0.634834 -0.146318 -1.364437 -0.196225 -4.174832 -5.536125 -1.213031 -1.240158 -1.511744  ... -1.542518  0.106399  0.552374 -2.870266 -1.215609  1145.984566  1170.837319 -16.134046   322.232055
...        ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...          ...          ...        ...          ...
3749 -0.542316 -0.407069  2.388683  1.566388 -0.086982 -2.470578 -1.103251 -1.171942 -1.256193  ... -1.552749  1.497718  0.505220  0.485421  0.718957  1199.034027  1310.451079 -16.130436  1418.564877
3750 -0.542461 -0.407069  2.388683  0.905408  0.423999 -3.151811 -1.226754 -1.166541 -1.511744  ... -1.554742  3.310093 -0.259588 -0.339185  0.618155  1272.737615  1371.247983 -16.124431   330.665385
3751 -0.541013  0.375183 -1.089818  1.235898 -2.301234 -3.492427 -1.197936 -1.166541 -0.387320  ... -1.550882  1.959050  0.627771  1.020041  1.067103  1195.981881  1275.544734 -16.129295   805.040163
3752 -0.541882  0.375183  1.839446  1.566388 -1.279271 -2.470578 -1.103251 -1.171942 -1.256193  ... -1.552518  2.266604  0.455292  0.347987  0.443354  1241.455641  1371.490754 -16.127079    33.390523
3753 -0.541158  1.939687  0.649432  1.566388 -2.301234 -3.151811 -1.123835 -1.166541 -1.256193  ... -1.551364  1.168195  0.053597 -0.284211 -0.963215  1195.969538  1255.891078 -16.131570   490.898643

[3754 rows x 30 columns]
2024-10-24 17:43:33,445 - INFO - home goal predictions: [211.3265  186.34254 207.97154 ... 265.25403  94.52696 106.43142]
2024-10-24 17:47:47,143 - INFO - Model directory checked/created.
2024-10-24 17:47:51,867 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 17:47:52,864 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 17:47:52,864 - INFO - Data loaded with 3754 rows
2024-10-24 17:47:52,882 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 17:47:53,328 - INFO - new real scores length: 92
2024-10-24 17:47:53,329 - INFO - prediction_df length: 3754
2024-10-24 17:47:53,329 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 17:47:54,889 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 17:47:54,893 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 17:47:54,898 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 17:47:54,907 - INFO - Data scaling completed.
2024-10-24 17:47:54,929 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 17:49:55,412 - INFO - Feature selection using RFE completed.
2024-10-24 17:49:55,632 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 17:51:48,862 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 17:51:51,191 - INFO - match_outcome Stacking Model MSE: 0.006181165003911116, R2: 0.9990593069958832, Stacking Model MAE: 0.04482337573773126, Stacking Model MAPE: 1.9062250551868907%
2024-10-24 17:59:01,996 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpl_iiz1pc\assets
2024-10-24 17:59:02,087 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 17:59:02,623 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 17:59:02,748 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 17:59:02,748 - INFO - Start match_outcome predictions
2024-10-24 17:59:02,748 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 17:59:02,862 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 17:59:02,862 - INFO - [[ 5.43481802e-01  1.93968651e+00  1.91734594e-01 ...  1.31020333e+03
  -1.59391009e+01 -1.16035666e+01]
 [ 9.20760406e-01 -1.46318221e-01  2.48022206e+00 ...  1.29433000e+03
  -1.58936985e+01 -1.15180912e+01]
 [-1.89359447e-01 -1.46318221e-01 -7.23660391e-01 ...  1.20686781e+03
  -1.58924412e+01 -1.36870298e+01]
 ...
 [-5.41013219e-01  3.75182961e-01 -1.08981839e+00 ...  1.27554473e+03
  -1.58363608e+01 -1.20629970e+01]
 [-5.41881858e-01  3.75182961e-01  1.83944557e+00 ...  1.37149075e+03
  -1.58258114e+01 -1.59734972e+01]
 [-5.41157992e-01  1.93968651e+00  6.49432087e-01 ...  1.25589108e+03
  -1.58764600e+01 -1.36549766e+01]]
2024-10-24 17:59:02,892 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8   ...        21        22        23        24        25           26           27         28         29
0     0.543482  1.939687  0.191735 -1.077531 -3.152869 -2.981503 -1.062083 -1.290769 -1.511744  ... -6.643509  1.448900 -1.961229 -1.380818 -0.115472  1168.557181  1310.203326 -15.939101 -11.603567
1     0.920760 -0.146318  2.480222 -0.526715  1.445962 -1.278421 -1.213031 -1.108568 -0.808979  ... -7.007762  2.220837  0.335464 -0.518834  0.209980  1333.900353  1294.329998 -15.893698 -11.518091
2    -0.189359 -0.146318 -0.723660  0.244428 -1.279271 -8.090748 -1.107368 -1.233831  1.861529  ... -7.136906  1.717400 -0.755465 -0.319915 -0.824328  1057.858718  1206.867814 -15.892441 -13.687030
3     1.001544  0.896684 -0.906739 -0.967368 -1.790253 -2.640886 -1.288505 -1.214852 -1.511744  ... -6.958091  4.133900  0.297186 -0.585141  0.178485  1197.487658  1238.472051 -15.899429 -12.928436
4     0.634834 -0.146318 -1.364437 -0.196225 -4.174832 -5.536125 -1.213031 -1.240158 -1.511744  ... -7.007762  0.106399  0.552374 -1.778656 -2.870266  1145.984566  1170.837319 -15.904747 -14.509731
...        ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...          ...          ...        ...        ...
3749 -0.542316 -0.407069  2.388683  1.566388 -0.086982 -2.470578 -1.103251 -1.171942 -1.256193  ... -6.958091  1.497718  0.505220  0.041756  0.485421  1199.034027  1310.451079 -15.853361  -8.953829
3750 -0.542461 -0.407069  2.388683  0.905408  0.423999 -3.151811 -1.226754 -1.166541 -1.511744  ... -6.727799  3.310093 -0.259588  0.439595 -0.339185  1272.737615  1371.247983 -15.817141 -14.466993
3751 -0.541013  0.375183 -1.089818  1.235898 -2.301234 -3.492427 -1.197936 -1.166541 -0.387320  ... -6.719671  1.959050  0.627771 -0.956457  1.020041  1195.981881  1275.544734 -15.836361 -12.062997
3752 -0.541882  0.375183  1.839446  1.566388 -1.279271 -2.470578 -1.103251 -1.171942 -1.256193  ... -6.930998  2.266604  0.455292  0.801266  0.347987  1241.455641  1371.490754 -15.825811 -15.973497
3753 -0.541158  1.939687  0.649432  1.566388 -2.301234 -3.151811 -1.123835 -1.166541 -1.256193  ... -6.849719  1.168195  0.053597 -0.410333 -0.284211  1195.969538  1255.891078 -15.876460 -13.654977

[3754 rows x 30 columns]
2024-10-24 17:59:03,026 - INFO - home goal predictions: [122.00977   99.612656 229.57394  ... 255.12064  109.86136   96.579994]
2024-10-24 18:12:10,363 - INFO - Model directory checked/created.
2024-10-24 18:12:15,181 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:12:16,230 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:12:16,232 - INFO - Data loaded with 3754 rows
2024-10-24 18:12:16,237 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:12:16,664 - INFO - new real scores length: 92
2024-10-24 18:12:16,664 - INFO - prediction_df length: 3754
2024-10-24 18:12:16,664 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:12:18,230 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:12:18,232 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:12:18,237 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:12:18,246 - INFO - Data scaling completed.
2024-10-24 18:12:18,258 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:14:17,063 - INFO - Feature selection using RFE completed.
2024-10-24 18:14:17,063 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_saves_mean', 'Away_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo']
2024-10-24 18:14:17,330 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 18:16:09,214 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 18:16:11,009 - INFO - match_outcome Stacking Model MSE: 0.005787738380259603, R2: 0.9991191814163635, Stacking Model MAE: 0.040113932004061305, Stacking Model MAPE: 1.5814761615404036%
2024-10-24 18:23:39,314 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpadt39e2b\assets
2024-10-24 18:23:39,423 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 18:23:40,147 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 18:23:40,247 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 18:23:40,247 - INFO - Start match_outcome predictions
2024-10-24 18:23:40,263 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:23:40,370 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 18:28:03,289 - INFO - Model directory checked/created.
2024-10-24 18:28:08,252 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:28:09,354 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:28:09,356 - INFO - Data loaded with 3754 rows
2024-10-24 18:28:09,361 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:28:09,865 - INFO - new real scores length: 92
2024-10-24 18:28:09,865 - INFO - prediction_df length: 3754
2024-10-24 18:28:09,865 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:28:11,467 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:28:11,469 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:28:11,473 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:28:11,482 - INFO - Data scaling completed.
2024-10-24 18:28:11,498 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:28:26,479 - INFO - Model directory checked/created.
2024-10-24 18:28:31,431 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:28:32,498 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:28:32,498 - INFO - Data loaded with 3754 rows
2024-10-24 18:28:32,516 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:28:32,981 - INFO - new real scores length: 92
2024-10-24 18:28:32,981 - INFO - prediction_df length: 3754
2024-10-24 18:28:32,998 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:28:34,654 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:28:34,656 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:28:34,661 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:28:34,674 - INFO - Data scaling completed.
2024-10-24 18:28:34,684 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:30:36,335 - INFO - Feature selection using RFE completed.
2024-10-24 18:30:36,335 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:30:36,562 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 18:32:26,789 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 18:32:28,598 - INFO - match_outcome Stacking Model MSE: 0.008133859666082908, R2: 0.9987621322389048, Stacking Model MAE: 0.05512688014716197, Stacking Model MAPE: 2.5726673616210847%
2024-10-24 18:32:29,098 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp3aawlhuk\assets
2024-10-24 18:32:29,169 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 18:32:29,700 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 18:32:29,786 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 18:32:29,788 - INFO - Start match_outcome predictions
2024-10-24 18:32:29,789 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:32:29,924 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 18:32:29,927 - INFO - Prediction data: Empty DataFrame
Columns: []
Index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, ...]

[3754 rows x 0 columns]
2024-10-24 18:34:53,875 - INFO - Model directory checked/created.
2024-10-24 18:34:58,879 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:34:59,932 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:34:59,935 - INFO - Data loaded with 3754 rows
2024-10-24 18:34:59,938 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:35:00,432 - INFO - new real scores length: 92
2024-10-24 18:35:00,433 - INFO - prediction_df length: 3754
2024-10-24 18:35:00,433 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:35:02,119 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:35:02,122 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:35:02,127 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:35:02,139 - INFO - Data scaling completed.
2024-10-24 18:35:02,148 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:37:01,681 - INFO - Feature selection using RFE completed.
2024-10-24 18:37:01,681 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_encoded', 'Home_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:37:01,898 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 18:38:48,982 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 18:38:50,705 - INFO - match_outcome Stacking Model MSE: 0.005783097471599823, R2: 0.9991198877023639, Stacking Model MAE: 0.040289166376924264, Stacking Model MAPE: 1.4672567884511414%
2024-10-24 18:38:51,132 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpj3qcl6ij\assets
2024-10-24 18:38:51,216 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 18:38:51,730 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 18:38:51,814 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 18:38:51,817 - INFO - Start match_outcome predictions
2024-10-24 18:38:51,818 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:38:51,927 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 18:44:01,832 - INFO - Model directory checked/created.
2024-10-24 18:44:06,567 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:44:07,599 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:44:07,599 - INFO - Data loaded with 3754 rows
2024-10-24 18:44:07,616 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:44:08,049 - INFO - new real scores length: 92
2024-10-24 18:44:08,049 - INFO - prediction_df length: 3754
2024-10-24 18:44:08,065 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:44:09,549 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:44:09,549 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:44:09,549 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:44:09,567 - INFO - Data scaling completed.
2024-10-24 18:44:09,582 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:46:07,749 - INFO - Feature selection using RFE completed.
2024-10-24 18:46:07,749 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:46:07,949 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 18:47:56,972 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 18:47:58,674 - INFO - match_outcome Stacking Model MSE: 0.00518184590863295, R2: 0.9992113903784193, Stacking Model MAE: 0.03889264942548142, Stacking Model MAPE: 1.345112050623753%
2024-10-24 18:47:59,116 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpowjj9crk\assets
2024-10-24 18:47:59,184 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 18:47:59,665 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 18:47:59,750 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 18:47:59,752 - INFO - Start match_outcome predictions
2024-10-24 18:47:59,754 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:49:46,780 - INFO - Model directory checked/created.
2024-10-24 18:49:51,674 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:49:52,733 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:49:52,737 - INFO - Data loaded with 3754 rows
2024-10-24 18:49:52,741 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:49:53,190 - INFO - new real scores length: 92
2024-10-24 18:49:53,193 - INFO - prediction_df length: 3754
2024-10-24 18:49:53,196 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:49:54,814 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:49:54,816 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:49:54,820 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:49:54,831 - INFO - Data scaling completed.
2024-10-24 18:49:54,844 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:51:56,849 - INFO - Feature selection using RFE completed.
2024-10-24 18:51:56,849 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:51:57,065 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 18:53:47,499 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 18:53:49,306 - INFO - match_outcome Stacking Model MSE: 0.006079008389955502, R2: 0.999074853905246, Stacking Model MAE: 0.03883362393595278, Stacking Model MAPE: 1.5123714941630335%
2024-10-24 18:53:49,750 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp0qfwocwf\assets
2024-10-24 18:53:49,817 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 18:53:50,299 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 18:53:50,433 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 18:53:50,433 - INFO - Start match_outcome predictions
2024-10-24 18:53:50,443 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:53:50,539 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 18:55:32,332 - INFO - Model directory checked/created.
2024-10-24 18:55:37,470 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:55:38,545 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:55:38,547 - INFO - Data loaded with 3754 rows
2024-10-24 18:55:38,552 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:55:38,983 - INFO - new real scores length: 92
2024-10-24 18:55:39,000 - INFO - prediction_df length: 3754
2024-10-24 18:55:39,000 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:55:40,600 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 18:55:40,600 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:55:40,617 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:55:40,617 - INFO - Data scaling completed.
2024-10-24 18:55:40,634 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 18:57:45,784 - INFO - Feature selection using RFE completed.
2024-10-24 18:57:45,784 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:57:46,000 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 18:59:41,808 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 18:59:43,705 - INFO - match_outcome Stacking Model MSE: 0.005837755068463467, R2: 0.9991115695262662, Stacking Model MAE: 0.042617148682001914, Stacking Model MAPE: 1.6631053893229968%
2024-10-24 18:59:44,219 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpx_s8w_0q\assets
2024-10-24 18:59:44,317 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 18:59:44,904 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 18:59:44,985 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 18:59:44,985 - INFO - Start match_outcome predictions
2024-10-24 18:59:44,985 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:59:45,100 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 18:59:45,117 - INFO - Prediction data:       running_id  home_league_position  Home_points_cum  Away_points_cum  Home_team_matches  ...  Home_possession_mean  Home_shot_on_target_mean  away_shot_on_target_mean  home_team_elo  away_team_elo
0          14792                    14               18                3                 18  ...             49.888889                  3.777778                  1.200000    1423.412500    1480.664800
1          17398                     6               43                8                 24  ...             52.041667                  4.416667                  3.200000    1624.234684    1462.770420
2           9730                     6                8               15                  5  ...             45.200000                  4.000000                  2.250000    1288.960579    1364.172216
3          17956                    10                6                4                  6  ...             51.833333                  6.000000                  3.166667    1458.550822    1399.800425
4          15423                     6                1               11                  6  ...             31.666667                  2.666667                  3.388889    1395.996297    1323.554179
...          ...                   ...              ...              ...                ...  ...                   ...                       ...                       ...            ...            ...
3749        7292                     5               42               27                 22  ...             53.863636                  3.818182                  3.347826    1460.429007    1480.944099
3750        7291                     5               42               21                 22  ...             48.409091                  5.318182                  2.681818    1549.947766    1549.481897
3751        7301                     8                4               24                  5  ...             57.400000                  4.200000                  3.454545    1456.721938    1441.593344
3752        7295                     8               36               27                 22  ...             52.954545                  4.454545                  3.304348    1511.953368    1549.755579
3753        7300                    14               23               27                 22  ...             48.772727                  3.545455                  2.954545    1456.706946    1419.437309

[3754 rows x 30 columns]
2024-10-24 19:00:21,900 - INFO - Model directory checked/created.
2024-10-24 19:00:27,633 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:00:28,861 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:00:28,863 - INFO - Data loaded with 3754 rows
2024-10-24 19:00:28,870 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:00:29,352 - INFO - new real scores length: 92
2024-10-24 19:00:29,355 - INFO - prediction_df length: 3754
2024-10-24 19:00:29,358 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:00:31,059 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 19:00:31,062 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 19:00:31,068 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 19:00:31,070 - INFO - Data scaling completed.
2024-10-24 19:00:31,095 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 19:02:35,583 - INFO - Feature selection using RFE completed.
2024-10-24 19:02:35,583 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:02:35,806 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 19:04:39,100 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 19:04:41,251 - INFO - match_outcome Stacking Model MSE: 0.005124675777243309, R2: 0.9992200909296275, Stacking Model MAE: 0.04082825748268258, Stacking Model MAPE: 1.3939892754965233%
2024-10-24 19:04:41,834 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmphnsxcyi_\assets
2024-10-24 19:04:41,900 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 19:04:42,416 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 19:04:42,505 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 19:04:42,507 - INFO - Start match_outcome predictions
2024-10-24 19:04:42,508 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:04:42,615 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 19:04:42,633 - INFO - Prediction data:       running_id  home_league_position  Home_points_cum  Away_points_cum  Home_team_matches  ...  away_possession_mean  Home_shot_on_target_mean  away_shot_on_target_mean  home_team_elo  away_team_elo
0          14792                    14               18                3                 18  ...             31.000000                  3.777778                  1.200000    1423.412500    1480.664800
1          17398                     6               43                8                 24  ...             43.400000                  4.416667                  3.200000    1624.234684    1462.770420
2           9730                     6                8               15                  5  ...             47.208333                  4.000000                  2.250000    1288.960579    1364.172216
3          17956                    10                6                4                  6  ...             43.500000                  6.000000                  3.166667    1458.550822    1399.800425
4          15423                     6                1               11                  6  ...             40.833333                  2.666667                  3.388889    1395.996297    1323.554179
...          ...                   ...              ...              ...                ...  ...                   ...                       ...                       ...            ...            ...
3749        7292                     5               42               27                 22  ...             53.956522                  3.818182                  3.347826    1460.429007    1480.944099
3750        7291                     5               42               21                 22  ...             53.272727                  5.318182                  2.681818    1549.947766    1549.481897
3751        7301                     8                4               24                  5  ...             56.318182                  4.200000                  3.454545    1456.721938    1441.593344
3752        7295                     8               36               27                 22  ...             52.086957                  4.454545                  3.304348    1511.953368    1549.755579
3753        7300                    14               23               27                 22  ...             42.545455                  3.545455                  2.954545    1456.706946    1419.437309

[3754 rows x 30 columns]
2024-10-24 19:14:03,616 - INFO - Model directory checked/created.
2024-10-24 19:14:09,612 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:14:10,838 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:14:10,838 - INFO - Data loaded with 3754 rows
2024-10-24 19:14:10,851 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:14:11,377 - INFO - new real scores length: 92
2024-10-24 19:14:11,382 - INFO - prediction_df length: 3754
2024-10-24 19:14:11,384 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:14:13,138 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 19:14:13,138 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 19:14:13,151 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 19:14:13,169 - INFO - Data scaling completed.
2024-10-24 19:14:13,169 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 19:16:22,468 - INFO - Model directory checked/created.
2024-10-24 19:16:27,768 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:16:28,868 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:16:28,868 - INFO - Data loaded with 3754 rows
2024-10-24 19:16:28,868 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:16:29,341 - INFO - new real scores length: 92
2024-10-24 19:16:29,344 - INFO - prediction_df length: 3754
2024-10-24 19:16:29,347 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:16:31,167 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 19:16:31,182 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 19:16:31,184 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 19:16:31,200 - INFO - Data scaling completed.
2024-10-24 19:16:31,201 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 19:19:01,927 - INFO - Feature selection using RFE completed.
2024-10-24 19:19:01,929 - INFO - Selected Features: ['running_id', 'away_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-24 19:19:02,132 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 19:21:04,717 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 19:21:06,467 - INFO - match_outcome Stacking Model MSE: 0.004997378098509938, R2: 0.9992394639824014, Stacking Model MAE: 0.03943614152263061, Stacking Model MAPE: 1.5181935712005694%
2024-10-24 19:21:06,901 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpzxq58ec9\assets
2024-10-24 19:21:06,968 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 19:21:07,434 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 19:21:07,517 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 19:21:07,517 - INFO - Start match_outcome predictions
2024-10-24 19:21:07,533 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:21:07,684 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 19:21:07,718 - INFO - Prediction data:       running_id  season_encoded  league_encoded  home_encoded  away_encoded  venue_encoded  ...  Home_shot_on_target_mean  away_shot_on_target_mean  home_team_elo  away_team_elo  home_poisson_xG  away_poisson_xG
0          14792               4               7           150           319             75  ...                  3.777778                  1.200000    1423.412500    1480.664800         0.565185         1.019601
1          17398               4               4           331           423            248  ...                  4.416667                  3.200000    1624.234684    1462.770420         1.690878         1.685882
2           9730               1               4           424           342            591  ...                  4.000000                  2.250000    1288.960579    1364.172216         1.125582         0.522266
3          17956               4               4           115           284             47  ...                  6.000000                  3.166667    1458.550822    1399.800425         1.021643         0.632607
4          15423               0               7            16           482            288  ...                  2.666667                  3.388889    1395.996297    1323.554179         0.828063         0.537481
...          ...             ...             ...           ...           ...            ...  ...                       ...                       ...            ...            ...              ...              ...
3749        7292               3              17           376           437            572  ...                  3.818182                  3.347826    1460.429007    1480.944099         1.165688         0.819417
3750        7291               2              17           377           199            146  ...                  5.318182                  2.681818    1549.947766    1549.481897         1.727408         0.753209
3751        7301               3              17           261           146            148  ...                  4.200000                  3.454545    1456.721938    1441.593344         1.272473         0.805582
3752        7295               3              17           275           144            155  ...                  4.454545                  3.304348    1511.953368    1549.755579         1.479691         0.781745
3753        7300               3              17           227           147            137  ...                  3.545455                  2.954545    1456.706946    1419.437309         1.059705         0.960781

[3754 rows x 50 columns]
2024-10-24 19:21:07,718 - INFO - [[ 0.5434818   0.39561804  0.19173459 ... -0.92405004 -0.33507785
  -0.30146924]
 [ 0.92076041  1.05622083  2.48022206 ...  1.22310171 -0.52626905
   1.10327205]
 [-0.18935945  0.54171289 -0.72366039 ... -2.36158384 -1.57973434
  -1.35001538]
 ...
 [-0.54101322 -0.7032693  -1.08981839 ... -0.567912   -0.75253396
  -0.75269174]
 [-0.54188186 -0.7159732   1.83944557 ...  0.02261171  0.40311751
  -0.80294882]
 [-0.54115799 -0.69691735  0.64943209 ... -0.56807229 -0.98925849
  -0.42548078]]
2024-10-24 19:21:07,735 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     0.543482  0.395618  0.191735 -1.077531  1.275635 -0.937805  2.787087 -1.290769  1.299317 -1.528959  ... -0.405640 -1.160083 -1.873420 -1.380818 -0.115472 -0.272392 -2.165633 -0.924050 -0.335078 -0.301469
1     0.920760  1.056221  2.480222 -0.526715  2.297597 -0.937805  0.522869 -0.379762 -0.574724  0.770614  ...  0.121332  1.173239 -0.607866 -0.518834  0.209980  0.253626 -0.391520  1.223102 -0.526269  1.103272
2    -0.189359  0.541713 -0.723660  0.244428 -0.938617  2.298051 -0.382818  0.075742  0.737104 -0.810342  ... -1.459583  0.395465 -0.572820 -0.319915 -0.824328 -0.089429 -1.234224 -2.361584 -1.579734 -1.350015
3     1.001544  0.173300 -0.906739 -0.967368 -0.768290 -0.767497 -1.288505 -0.835266 -1.511744 -0.570803  ... -0.932611  2.469529 -0.767594 -0.585141  0.178485  1.557233 -0.421089 -0.548358 -1.199067 -1.117381
4     0.634834  1.430986 -1.364437 -0.196225 -0.768290  1.276201 -0.835661 -0.379762 -0.574724 -0.890189  ... -1.459583 -0.641567 -0.915832 -1.778656 -2.870266 -1.187204 -0.223965 -1.217179 -2.013715 -1.317939
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
3749 -0.542316  1.145148  2.388683  1.566388  1.956943  2.127742  2.787087  1.442253  0.788215 -0.029237  ...  0.121332 -0.123051  0.516513  0.041756  0.485421 -0.239126 -0.260390 -0.528277 -0.332094 -0.723524
3750 -0.542461 -0.366616  2.388683  0.905408  1.956943  1.957434  0.070026  1.442253 -0.745091  0.038932  ...  1.175274 -1.160083  1.526110  0.439595 -0.339185  0.995871 -0.851177  0.428840  0.400193 -0.863112
3751 -0.541013 -0.703269 -1.089818  1.235898 -0.938617  1.957434 -0.835661  1.442253 -0.387320  0.038932  ... -0.932611 -0.123051  0.990371 -0.956457  1.020041  0.075237 -0.165724 -0.567912 -0.752534 -0.752692
3752 -0.541882 -0.715973  1.839446  1.566388  1.956943  2.127742  2.787087  1.442253  0.788215 -0.029237  ...  0.121332 -0.123051  1.284429  0.801266  0.347987  0.284812 -0.298958  0.022612  0.403118 -0.802949
3753 -0.541158 -0.696917  0.649432  1.566388  1.956943  1.957434  2.334243  1.442253  0.532664  0.038932  ...  0.648303 -0.123051 -0.127358 -0.410333 -0.284211 -0.463671 -0.609252 -0.568072 -0.989258 -0.425481

[3754 rows x 30 columns]
2024-10-24 19:21:07,870 - INFO - home goal predictions: [6.421818  2.0021055 1.0680734 ... 3.0944657 3.659116  3.8296106]
2024-10-24 19:51:16,700 - INFO - Model directory checked/created.
2024-10-24 19:51:22,565 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:51:24,133 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:51:24,134 - INFO - Data loaded with 3754 rows
2024-10-24 19:51:24,141 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:51:24,602 - INFO - new real scores length: 92
2024-10-24 19:51:24,602 - INFO - prediction_df length: 3754
2024-10-24 19:51:24,602 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:51:26,469 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-24 19:51:26,469 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 19:51:26,469 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 19:51:26,497 - INFO - Data scaling completed.
2024-10-24 19:51:26,508 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-24 19:54:01,763 - INFO - Feature selection using RFE completed.
2024-10-24 19:54:01,765 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-24 19:54:01,996 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-24 19:56:00,293 - INFO - Stacking model for match_outcome trained successfully.
2024-10-24 19:56:02,321 - INFO - match_outcome Stacking Model MSE: 0.005709164203287131, R2: 0.9991311393852149, Stacking Model MAE: 0.03993771825949969, Stacking Model MAPE: 1.6525739643836659%
2024-10-24 19:56:02,784 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpdl4gby13\assets
2024-10-24 19:56:02,852 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-24 19:56:03,334 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-24 19:56:03,416 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-24 19:56:03,418 - INFO - Start match_outcome predictions
2024-10-24 19:56:03,543 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-24 19:56:03,544 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:56:03,549 - INFO - [[ 0.5434818   1.93968651  0.19173459 ... -0.92405004 -0.33507785
  -1.60158079]
 [ 0.92076041 -0.14631822  2.48022206 ...  1.22310171 -0.52626905
   0.465453  ]
 [-0.18935945 -0.14631822 -0.72366039 ... -2.36158384 -1.57973434
  -0.5725624 ]
 ...
 [-0.54101322  0.37518296 -1.08981839 ... -0.567912   -0.75253396
  -0.30283523]
 [-0.54188186  0.37518296  1.83944557 ...  0.02261171  0.40311751
   0.07766439]
 [-0.54115799  1.93968651  0.64943209 ... -0.56807229 -0.98925849
  -0.6935269 ]]
2024-10-24 19:56:03,697 - INFO - home goal predictions: [6.116351  1.8120992 1.1646128 ... 2.9075322 3.8277855 4.359447 ]
2024-10-25 17:13:49,115 - INFO - Model directory checked/created.
2024-10-25 17:13:56,142 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 17:13:56,224 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 17:13:56,227 - INFO - Data loaded with 5111 rows
2024-10-25 17:13:56,237 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 17:13:56,715 - INFO - new real scores length: 26
2024-10-25 17:13:56,737 - INFO - data_with_error length: 0
2024-10-25 17:13:56,744 - INFO - prediction_df length: 5111
2024-10-25 17:13:56,748 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:14:02,479 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 17:14:02,482 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 17:14:02,487 - INFO - Data split into train and test. Train shape: (9466, 50), Test shape: (4058, 50)
2024-10-25 17:14:02,498 - INFO - Data scaling completed.
2024-10-25 17:14:02,513 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 17:16:06,962 - INFO - Feature selection using RFE completed.
2024-10-25 17:16:06,962 - INFO - Selected Features: ['running_id', 'away_encoded', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 17:16:07,179 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 17:17:48,429 - INFO - Stacking model for match_outcome trained successfully.
2024-10-25 17:17:51,061 - INFO - match_outcome Stacking Model MSE: 0.008146102452991395, R2: 0.9987457139983642, Stacking Model MAE: 0.04174485839260923, Stacking Model MAPE: 1.708659970591771%
2024-10-25 17:17:51,617 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmptcvf00mw\assets
2024-10-25 17:17:51,696 - INFO - Stacking model for home goals (without Keras) saved to ./models/match_outcome_stacking_model.pkl
2024-10-25 17:17:52,246 - INFO - Assets written to: ./models/nn_regressor_match_outcome_model\assets
2024-10-25 17:17:52,354 - INFO - Keras neural network model saved to ./models/nn_regressor_match_outcome_model
2024-10-25 17:17:52,356 - INFO - Start match_outcome predictions
2024-10-25 17:17:52,357 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 17:17:52,458 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 17:17:52,459 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:17:52,663 - INFO - home goal predictions: [6.901063  0.9989461 1.0317922 ... 3.7389073 3.5363092 3.8545732]
2024-10-25 20:42:18,932 - INFO - Model directory checked/created.
2024-10-25 20:42:24,647 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 20:42:24,757 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 20:42:24,758 - INFO - Data loaded with 5111 rows
2024-10-25 20:42:24,764 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 20:42:25,067 - INFO - new real scores length: 26
2024-10-25 20:42:25,077 - INFO - data_with_error length: 0
2024-10-25 20:42:25,081 - INFO - prediction_df length: 5111
2024-10-25 20:42:25,084 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:42:28,779 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 20:42:28,781 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 20:42:28,781 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 20:42:28,781 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 20:42:28,781 - INFO - Data scaling started.
2024-10-25 20:42:28,814 - INFO - Data scaling completed.
2024-10-25 20:42:28,830 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 20:42:28,830 - INFO - Feature Selection started.
2024-10-25 20:47:38,675 - INFO - Feature selection using RFE completed.
2024-10-25 20:47:38,678 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Away_saves_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-25 20:47:38,918 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 20:47:38,918 - INFO - First fit started
2024-10-25 20:52:56,533 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 20:52:58,792 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.00015485947052194956, R2: 0.9999764324006156, Stacking Model MAE: 0.006719383985860083, Stacking Model MAPE: 0.38008591048229823%
2024-10-25 20:52:58,797 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 100.0%
2024-10-25 20:52:58,798 - INFO - Second fit started
2024-10-25 20:58:15,898 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-25 20:58:18,080 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.002350779516836754, R2: 0.9996327186687691, Stacking Model MAE: 0.016770843997870356, Stacking Model MAPE: 0.8946353010740624%
2024-10-25 20:58:18,081 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.66728280961183%
2024-10-25 20:58:18,085 - INFO - Start match_outcome predictions
2024-10-25 20:58:18,087 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 20:58:18,208 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 20:58:18,210 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:03:31,933 - INFO - Model directory checked/created.
2024-10-25 21:03:37,167 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:03:37,274 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:03:37,277 - INFO - Data loaded with 5111 rows
2024-10-25 21:03:37,282 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:03:37,595 - INFO - new real scores length: 26
2024-10-25 21:03:37,605 - INFO - data_with_error length: 0
2024-10-25 21:03:37,608 - INFO - prediction_df length: 5111
2024-10-25 21:03:37,611 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:03:39,403 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 21:03:39,405 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:03:39,411 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:03:39,419 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:03:39,420 - INFO - Data scaling started.
2024-10-25 21:03:39,434 - INFO - Data scaling completed.
2024-10-25 21:03:39,450 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 21:03:39,450 - INFO - Feature Selection started.
2024-10-25 21:09:59,962 - INFO - Model directory checked/created.
2024-10-25 21:10:06,784 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:10:06,817 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:10:06,817 - INFO - Data loaded with 5111 rows
2024-10-25 21:10:06,833 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:10:07,135 - INFO - new real scores length: 26
2024-10-25 21:10:07,150 - INFO - data_with_error length: 0
2024-10-25 21:10:07,150 - INFO - prediction_df length: 5111
2024-10-25 21:10:07,150 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:10:09,234 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 21:10:09,234 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:10:09,234 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:10:09,252 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:10:09,252 - INFO - Data scaling started.
2024-10-25 21:10:09,268 - INFO - Data scaling completed.
2024-10-25 21:10:09,285 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 21:10:09,285 - INFO - Feature Selection started.
2024-10-25 21:12:52,507 - INFO - Feature selection using RFE completed.
2024-10-25 21:12:52,517 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 21:12:52,725 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 21:12:52,727 - INFO - First fit started
2024-10-25 21:17:49,971 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 21:17:52,082 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.006075292309233382, R2: 0.9990754194444503, Stacking Model MAE: 0.03447824064665633, Stacking Model MAPE: 1.0687730076302728%
2024-10-25 21:17:52,083 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-25 21:17:52,085 - INFO - Second fit started
2024-10-25 21:23:54,731 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-25 21:23:56,655 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0037641236754288885, R2: 0.9994119004591765, Stacking Model MAE: 0.022790024776796286, Stacking Model MAPE: 0.7070284052565423%
2024-10-25 21:23:56,657 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.70425138632163%
2024-10-25 21:29:34,404 - INFO - Model directory checked/created.
2024-10-25 21:29:40,322 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:29:40,425 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:29:40,425 - INFO - Data loaded with 5111 rows
2024-10-25 21:29:40,436 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:29:40,786 - INFO - new real scores length: 26
2024-10-25 21:29:40,803 - INFO - data_with_error length: 0
2024-10-25 21:29:40,811 - INFO - prediction_df length: 5111
2024-10-25 21:29:40,813 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:29:43,120 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 21:29:43,120 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:29:43,120 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:29:43,138 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:29:43,138 - INFO - Data scaling started.
2024-10-25 21:29:43,154 - INFO - Data scaling completed.
2024-10-25 21:29:43,170 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 21:29:43,170 - INFO - Feature Selection started.
2024-10-25 21:32:24,486 - INFO - Feature selection using RFE completed.
2024-10-25 21:32:24,486 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 21:32:24,702 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 21:32:24,718 - INFO - First fit started
2024-10-25 21:37:40,390 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 21:37:42,618 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.003439580550110212, R2: 0.9994765405294087, Stacking Model MAE: 0.024099290609437593, Stacking Model MAPE: 0.5847433920097093%
2024-10-25 21:37:42,621 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.92606284658041%
2024-10-25 21:37:44,287 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpya4jl1iv\tmpirjzfto9\assets
2024-10-25 21:39:28,299 - INFO - Model directory checked/created.
2024-10-25 21:39:35,998 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:39:36,104 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:39:36,107 - INFO - Data loaded with 5111 rows
2024-10-25 21:39:36,112 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:39:36,544 - INFO - new real scores length: 26
2024-10-25 21:39:36,557 - INFO - data_with_error length: 0
2024-10-25 21:39:36,563 - INFO - prediction_df length: 5111
2024-10-25 21:39:36,567 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:39:39,128 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 21:39:39,131 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:39:39,142 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:39:39,150 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:39:39,152 - INFO - Data scaling started.
2024-10-25 21:39:39,181 - INFO - Data scaling completed.
2024-10-25 21:39:39,194 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 21:39:39,196 - INFO - Feature Selection started.
2024-10-25 21:42:20,008 - INFO - Feature selection using RFE completed.
2024-10-25 21:42:20,008 - INFO - Selected Features: ['running_id', 'away_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 21:42:20,217 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 21:42:20,219 - INFO - First fit started
2024-10-25 21:47:05,306 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 21:47:07,348 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002608751753174218, R2: 0.9996029818776662, Stacking Model MAE: 0.023488944205099456, Stacking Model MAPE: 0.802737135013912%
2024-10-25 21:47:07,348 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-25 21:47:08,524 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpo9n7ryn7\tmpa_sk_jq_\assets
2024-10-25 21:50:12,552 - INFO - Model directory checked/created.
2024-10-25 21:50:18,263 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:50:18,382 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:50:18,384 - INFO - Data loaded with 5111 rows
2024-10-25 21:50:18,392 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:50:18,751 - INFO - new real scores length: 26
2024-10-25 21:50:18,761 - INFO - data_with_error length: 0
2024-10-25 21:50:18,765 - INFO - prediction_df length: 5111
2024-10-25 21:50:18,770 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:50:21,062 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 21:50:21,064 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:50:21,074 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:50:21,081 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:50:21,081 - INFO - Data scaling started.
2024-10-25 21:50:21,111 - INFO - Data scaling completed.
2024-10-25 21:50:21,131 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 21:50:21,133 - INFO - Feature Selection started.
2024-10-25 21:52:56,402 - INFO - Feature selection using RFE completed.
2024-10-25 21:52:56,404 - INFO - Selected Features: ['running_id', 'away_encoded', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_saves_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-25 21:52:56,606 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 21:52:56,607 - INFO - First fit started
2024-10-25 21:58:22,404 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 21:58:24,563 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.001088268607673842, R2: 0.9998343796573638, Stacking Model MAE: 0.01886961313469155, Stacking Model MAPE: 0.5968199796630269%
2024-10-25 21:58:24,565 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-25 21:58:24,568 - INFO - Start match_outcome predictions
2024-10-25 21:58:24,568 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 21:58:24,692 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 21:58:24,693 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:03:17,225 - INFO - Model directory checked/created.
2024-10-25 22:03:22,380 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:03:22,476 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:03:22,478 - INFO - Data loaded with 5111 rows
2024-10-25 22:03:22,482 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:03:22,777 - INFO - new real scores length: 26
2024-10-25 22:03:22,785 - INFO - data_with_error length: 0
2024-10-25 22:03:22,789 - INFO - prediction_df length: 5111
2024-10-25 22:03:22,792 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:03:24,473 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 22:03:24,475 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:03:24,481 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:03:24,490 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:03:24,492 - INFO - Data scaling started.
2024-10-25 22:03:24,513 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 22:03:24,520 - INFO - Data scaling completed.
2024-10-25 22:03:24,522 - INFO - Feature Selection started.
2024-10-25 22:05:58,821 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 22:05:58,826 - INFO - Feature selection using RFE completed.
2024-10-25 22:05:58,827 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 22:05:58,829 - INFO - First fit started
2024-10-25 22:10:59,829 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 22:11:02,095 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.00879751499332346, R2: 0.9986611325207149, Stacking Model MAE: 0.026205656802697208, Stacking Model MAPE: 0.7193660814149915%
2024-10-25 22:11:02,097 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.70425138632163%
2024-10-25 22:11:02,102 - INFO - Start match_outcome predictions
2024-10-25 22:11:02,105 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:11:02,241 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 22:11:02,243 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:15:44,510 - INFO - Model directory checked/created.
2024-10-25 22:15:50,591 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:15:50,712 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:15:50,714 - INFO - Data loaded with 5111 rows
2024-10-25 22:15:50,714 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:15:51,042 - INFO - new real scores length: 26
2024-10-25 22:15:51,062 - INFO - data_with_error length: 0
2024-10-25 22:15:51,065 - INFO - prediction_df length: 5111
2024-10-25 22:15:51,067 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:15:53,063 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 22:15:53,063 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:15:53,063 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:15:53,078 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:15:53,078 - INFO - Data scaling started.
2024-10-25 22:15:53,109 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 22:15:53,109 - INFO - Data scaling completed.
2024-10-25 22:15:53,109 - INFO - Feature Selection started.
2024-10-25 22:16:23,448 - INFO - Model directory checked/created.
2024-10-25 22:16:28,677 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:16:28,776 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:16:28,776 - INFO - Data loaded with 5111 rows
2024-10-25 22:16:28,787 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:16:29,091 - INFO - new real scores length: 26
2024-10-25 22:16:29,091 - INFO - data_with_error length: 0
2024-10-25 22:16:29,111 - INFO - prediction_df length: 5111
2024-10-25 22:16:29,113 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:16:31,122 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 22:16:31,126 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:16:31,126 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:16:31,126 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:16:31,126 - INFO - Data scaling started.
2024-10-25 22:16:31,159 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 22:16:31,159 - INFO - Data scaling completed.
2024-10-25 22:16:31,159 - INFO - Feature Selection started.
2024-10-25 22:19:06,758 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 22:19:06,775 - INFO - Feature selection using RFE completed.
2024-10-25 22:19:06,775 - INFO - Selected Features: ['running_id', 'away_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 22:19:06,775 - INFO - First fit started
2024-10-25 22:23:54,173 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 22:23:56,271 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.004058059292762144, R2: 0.9993824161004313, Stacking Model MAE: 0.03286399275862704, Stacking Model MAPE: 1.0776768171356843%
2024-10-25 22:23:56,273 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.66728280961183%
2024-10-25 22:23:56,276 - INFO - Start match_outcome predictions
2024-10-25 22:23:56,278 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:23:56,375 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 22:23:56,375 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:24:00,014 - INFO - match_outcome predictions: [7.0885853  0.98892521 0.9829078  ... 3.80925772 3.35845405 3.81101986]
2024-10-25 22:24:11,774 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpymht78_u\tmp755asp_1\assets
2024-10-25 22:30:20,496 - INFO - Model directory checked/created.
2024-10-25 22:30:26,596 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:30:26,693 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:30:26,694 - INFO - Data loaded with 5111 rows
2024-10-25 22:30:26,694 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:30:27,143 - INFO - new real scores length: 26
2024-10-25 22:30:27,154 - INFO - data_with_error length: 0
2024-10-25 22:30:27,157 - INFO - prediction_df length: 5111
2024-10-25 22:30:27,162 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:30:29,193 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 22:30:29,196 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:30:29,199 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:30:29,210 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:30:29,210 - INFO - Data scaling started.
2024-10-25 22:30:29,254 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 22:30:29,260 - INFO - Data scaling completed.
2024-10-25 22:30:29,260 - INFO - Feature Selection started.
2024-10-25 22:33:04,624 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 22:33:04,630 - INFO - Feature selection using RFE completed.
2024-10-25 22:33:04,632 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 22:33:04,633 - INFO - First fit started
2024-10-25 22:38:15,566 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 22:38:17,962 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0027503876599424587, R2: 0.9995814267328764, Stacking Model MAE: 0.018298138815390944, Stacking Model MAPE: 0.5780417561798734%
2024-10-25 22:38:17,964 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.77818853974122%
2024-10-25 22:38:17,967 - INFO - Start match_outcome predictions
2024-10-25 22:38:17,970 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:38:18,106 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 22:38:18,108 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:38:22,215 - INFO - match_outcome predictions: [7.04258272 0.99362683 1.01264792 ... 3.92215766 3.68170435 3.92261054]
2024-10-25 22:38:34,474 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-25 22:38:34,600 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-25 22:38:34,618 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x0000015D9EB16AF0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 22:41:53,835 - INFO - Model directory checked/created.
2024-10-25 22:42:00,020 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:42:00,132 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:42:00,134 - INFO - Data loaded with 5111 rows
2024-10-25 22:42:00,141 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:42:00,496 - INFO - new real scores length: 26
2024-10-25 22:42:00,506 - INFO - data_with_error length: 0
2024-10-25 22:42:00,510 - INFO - prediction_df length: 5111
2024-10-25 22:42:00,513 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:42:02,539 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 22:42:02,542 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:42:02,551 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:42:02,557 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:42:02,559 - INFO - Data scaling started.
2024-10-25 22:42:02,582 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 22:42:02,591 - INFO - Data scaling completed.
2024-10-25 22:42:02,593 - INFO - Feature Selection started.
2024-10-25 22:44:38,886 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 22:44:38,889 - INFO - Feature selection using RFE completed.
2024-10-25 22:44:38,891 - INFO - Selected Features: ['running_id', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 22:44:38,893 - INFO - First fit started
2024-10-25 22:49:38,294 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 22:49:41,050 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0014950394303456327, R2: 0.9997724744231686, Stacking Model MAE: 0.013608067815183643, Stacking Model MAPE: 0.5725709689579258%
2024-10-25 22:49:41,052 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.59334565619223%
2024-10-25 22:49:41,056 - INFO - Start match_outcome predictions
2024-10-25 22:49:41,057 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:49:41,190 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 22:49:41,194 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:49:45,433 - INFO - match_outcome predictions: [7.01439196 0.99548112 1.01133591 ... 3.836065   3.30324612 3.8295377 ]
2024-10-25 22:49:58,063 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-25 22:49:58,199 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-25 22:49:58,201 - ERROR - Error occurred while saving models: 'nn'
2024-10-25 22:55:09,897 - INFO - Model directory checked/created.
2024-10-25 22:55:17,424 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:55:17,469 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:55:17,471 - INFO - Data loaded with 5111 rows
2024-10-25 22:55:17,483 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:55:17,838 - INFO - new real scores length: 26
2024-10-25 22:55:17,847 - INFO - data_with_error length: 0
2024-10-25 22:55:17,850 - INFO - prediction_df length: 5111
2024-10-25 22:55:17,854 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:55:19,736 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 22:55:19,739 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:55:19,744 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:55:19,749 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:55:19,751 - INFO - Data scaling started.
2024-10-25 22:55:19,771 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 22:55:19,779 - INFO - Data scaling completed.
2024-10-25 22:55:19,781 - INFO - Feature Selection started.
2024-10-25 22:57:50,314 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 22:57:50,317 - INFO - Feature selection using RFE completed.
2024-10-25 22:57:50,318 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:57:50,320 - INFO - First fit started
2024-10-25 23:02:57,872 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 23:03:00,193 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.001977375188245221, R2: 0.9996990691876176, Stacking Model MAE: 0.026836674998347274, Stacking Model MAPE: 0.8685571259366954%
2024-10-25 23:03:00,195 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.59334565619223%
2024-10-25 23:03:00,199 - INFO - Start match_outcome predictions
2024-10-25 23:03:00,201 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:03:00,320 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 23:03:00,322 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:03:04,253 - INFO - match_outcome predictions: [7.11032325 0.99976683 1.00732698 ... 3.83239611 3.19378491 3.85816888]
2024-10-25 23:03:16,825 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-25 23:03:16,950 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-25 23:03:18,132 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp61emzk3m\tmpav32yozp\assets
2024-10-25 23:03:18,387 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001AA2BC47160>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:17:48,631 - INFO - Model directory checked/created.
2024-10-25 23:17:54,290 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:17:54,398 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:17:54,401 - INFO - Data loaded with 5111 rows
2024-10-25 23:17:54,408 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:17:54,729 - INFO - new real scores length: 26
2024-10-25 23:17:54,738 - INFO - data_with_error length: 0
2024-10-25 23:17:54,741 - INFO - prediction_df length: 5111
2024-10-25 23:17:54,744 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:17:56,649 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 23:17:56,652 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:17:56,658 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:17:56,663 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:17:56,665 - INFO - Data scaling started.
2024-10-25 23:17:56,684 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 23:17:56,692 - INFO - Data scaling completed.
2024-10-25 23:17:56,694 - INFO - Feature Selection started.
2024-10-25 23:20:30,300 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 23:20:30,308 - INFO - Feature selection using RFE completed.
2024-10-25 23:20:30,315 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 23:20:30,318 - INFO - First fit started
2024-10-25 23:25:20,599 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 23:25:22,766 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002206802198634382, R2: 0.9996641533774925, Stacking Model MAE: 0.02321621473961092, Stacking Model MAPE: 1.0087900397007084%
2024-10-25 23:25:22,773 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.74121996303143%
2024-10-25 23:25:22,776 - INFO - Start match_outcome predictions
2024-10-25 23:25:22,778 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:25:22,926 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 23:25:22,928 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:25:26,810 - INFO - match_outcome predictions: [6.98740151 0.98718779 0.9981002  ... 3.83646297 3.42717312 3.83219873]
2024-10-25 23:25:37,968 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-25 23:25:38,096 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-25 23:25:38,108 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001C1BA6B7AF0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:44:06,834 - INFO - Model directory checked/created.
2024-10-25 23:44:12,486 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:44:12,602 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:44:12,602 - INFO - Data loaded with 5111 rows
2024-10-25 23:44:12,602 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:44:12,986 - INFO - new real scores length: 26
2024-10-25 23:44:12,986 - INFO - data_with_error length: 0
2024-10-25 23:44:13,000 - INFO - prediction_df length: 5111
2024-10-25 23:44:13,005 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:44:15,081 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 23:44:15,084 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:44:15,089 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:44:15,093 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:44:15,095 - INFO - Data scaling started.
2024-10-25 23:44:15,118 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 23:44:15,118 - INFO - Data scaling completed.
2024-10-25 23:44:15,118 - INFO - Feature Selection started.
2024-10-25 23:46:44,419 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 23:46:44,436 - INFO - Feature selection using RFE completed.
2024-10-25 23:46:44,436 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-25 23:46:44,436 - INFO - First fit started
2024-10-25 23:51:41,596 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-25 23:51:43,811 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.006005441582490897, R2: 0.9990860498175171, Stacking Model MAE: 0.044724306651273533, Stacking Model MAPE: 0.9854696610728969%
2024-10-25 23:51:43,813 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-25 23:51:43,820 - INFO - Start match_outcome predictions
2024-10-25 23:51:43,820 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:51:43,962 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-25 23:51:43,963 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:51:48,004 - INFO - match_outcome predictions: [6.91409689 0.99473203 1.00168823 ... 3.93749458 3.58547247 3.93664948]
2024-10-25 23:51:59,870 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-25 23:51:59,981 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-25 23:52:01,087 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpsnepuh3i\tmp4c0n4ezy\assets
2024-10-25 23:52:01,352 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001E27BDAD280>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:56:40,737 - INFO - Model directory checked/created.
2024-10-25 23:56:45,737 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:56:45,820 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:56:45,820 - INFO - Data loaded with 5111 rows
2024-10-25 23:56:45,837 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:56:46,137 - INFO - new real scores length: 26
2024-10-25 23:56:46,137 - INFO - data_with_error length: 0
2024-10-25 23:56:46,137 - INFO - prediction_df length: 5111
2024-10-25 23:56:46,155 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:56:47,863 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-25 23:56:47,866 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:56:47,872 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:56:47,877 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:56:47,879 - INFO - Data scaling started.
2024-10-25 23:56:47,899 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-25 23:56:47,906 - INFO - Data scaling completed.
2024-10-25 23:56:47,909 - INFO - Feature Selection started.
2024-10-25 23:59:15,120 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-25 23:59:15,123 - INFO - Feature selection using RFE completed.
2024-10-25 23:59:15,125 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-25 23:59:15,126 - INFO - First fit started
2024-10-26 00:03:38,958 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 00:03:40,963 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0006085528899265997, R2: 0.9999073861568447, Stacking Model MAE: 0.013309925932132293, Stacking Model MAPE: 0.6336826153782374%
2024-10-26 00:03:40,965 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-10-26 00:03:40,968 - INFO - Start match_outcome predictions
2024-10-26 00:03:40,972 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 00:03:41,108 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 00:03:41,110 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:03:44,430 - INFO - match_outcome predictions: [7.01903774 0.99184252 1.0045352  ... 3.82519951 3.49404626 3.82733822]
2024-10-26 00:03:55,014 - ERROR - Error occurred while saving models: 'KerasRegressor' object has no attribute 'save'
2024-10-26 00:11:44,972 - INFO - Model directory checked/created.
2024-10-26 00:11:49,821 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 00:11:49,905 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 00:11:49,921 - INFO - Data loaded with 5111 rows
2024-10-26 00:11:49,922 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 00:11:50,222 - INFO - new real scores length: 26
2024-10-26 00:11:50,222 - INFO - data_with_error length: 0
2024-10-26 00:11:50,239 - INFO - prediction_df length: 5111
2024-10-26 00:11:50,243 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:11:52,055 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 00:11:52,055 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 00:11:52,073 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 00:11:52,073 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 00:11:52,073 - INFO - Data scaling started.
2024-10-26 00:11:52,089 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 00:11:52,106 - INFO - Data scaling completed.
2024-10-26 00:11:52,106 - INFO - Feature Selection started.
2024-10-26 00:14:15,851 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 00:14:15,856 - INFO - Feature selection using RFE completed.
2024-10-26 00:14:15,858 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 00:14:15,860 - INFO - First fit started
2024-10-26 00:18:56,673 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 00:18:58,464 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0013689606780731677, R2: 0.9997916619711722, Stacking Model MAE: 0.014116108296728973, Stacking Model MAPE: 0.6513493287390005%
2024-10-26 00:18:58,466 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.55637707948244%
2024-10-26 00:18:58,470 - INFO - Start match_outcome predictions
2024-10-26 00:18:58,472 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 00:18:58,583 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 00:18:58,585 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:19:01,769 - INFO - match_outcome predictions: [7.07163911 0.99887511 1.01819784 ... 3.81204112 3.20175005 3.80212155]
2024-10-26 00:19:12,655 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-26 00:19:12,671 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x0000015DA8B184C0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-26 00:27:31,164 - INFO - Model directory checked/created.
2024-10-26 00:27:36,089 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 00:27:36,204 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 00:27:36,207 - INFO - Data loaded with 5111 rows
2024-10-26 00:27:36,213 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 00:27:36,525 - INFO - new real scores length: 26
2024-10-26 00:27:36,534 - INFO - data_with_error length: 0
2024-10-26 00:27:36,537 - INFO - prediction_df length: 5111
2024-10-26 00:27:36,541 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:27:38,337 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 00:27:38,340 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 00:27:38,346 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 00:27:38,350 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 00:27:38,352 - INFO - Data scaling started.
2024-10-26 00:27:38,375 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 00:27:38,383 - INFO - Data scaling completed.
2024-10-26 00:27:38,384 - INFO - Feature Selection started.
2024-10-26 00:30:04,374 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 00:30:04,374 - INFO - Feature selection using RFE completed.
2024-10-26 00:30:04,374 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-26 00:30:04,374 - INFO - First fit started
2024-10-26 00:34:31,119 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 00:34:32,927 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002526690688916439, R2: 0.9996154705054586, Stacking Model MAE: 0.0058120781478529235, Stacking Model MAPE: 0.29714197403695797%
2024-10-26 00:34:32,930 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-26 00:34:32,935 - INFO - Start match_outcome predictions
2024-10-26 00:34:32,937 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 00:34:33,054 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 00:34:33,056 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:34:36,297 - INFO - match_outcome predictions: [7.0129614  0.999746   1.01934436 ... 3.95838241 3.62484519 3.95926941]
2024-10-26 00:34:46,395 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-26 00:34:46,408 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000202EE1E94C0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-26 00:42:38,209 - INFO - Model directory checked/created.
2024-10-26 00:42:43,325 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 00:42:43,410 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 00:42:43,410 - INFO - Data loaded with 5111 rows
2024-10-26 00:42:43,424 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 00:42:43,743 - INFO - new real scores length: 26
2024-10-26 00:42:43,743 - INFO - data_with_error length: 0
2024-10-26 00:42:43,758 - INFO - prediction_df length: 5111
2024-10-26 00:42:43,763 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:42:45,692 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 00:42:45,695 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 00:42:45,703 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 00:42:45,713 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 00:42:45,716 - INFO - Data scaling started.
2024-10-26 00:42:45,727 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 00:42:45,742 - INFO - Data scaling completed.
2024-10-26 00:42:45,742 - INFO - Feature Selection started.
2024-10-26 00:45:11,259 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 00:45:11,276 - INFO - Feature selection using RFE completed.
2024-10-26 00:45:11,276 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 00:45:11,276 - INFO - First fit started
2024-10-26 00:49:37,910 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 00:49:39,748 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0007184620431097883, R2: 0.9998906594117373, Stacking Model MAE: 0.006443528542384176, Stacking Model MAPE: 0.39813871658650735%
2024-10-26 00:49:39,749 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.85212569316081%
2024-10-26 00:49:39,752 - INFO - Start match_outcome predictions
2024-10-26 00:49:39,754 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 00:49:39,861 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 00:49:39,861 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:49:43,009 - INFO - match_outcome predictions: [6.99515008 1.00436179 1.00700112 ... 3.93835912 3.77555784 3.93923254]
2024-10-26 00:49:55,825 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-26 00:49:55,925 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-26 00:49:55,934 - ERROR - Error occurred while saving the models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001BD5C6084C0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-26 00:49:56,035 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-26 00:54:21,717 - INFO - Model directory checked/created.
2024-10-26 00:54:26,533 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 00:54:26,619 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 00:54:26,622 - INFO - Data loaded with 5111 rows
2024-10-26 00:54:26,626 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 00:54:26,927 - INFO - new real scores length: 26
2024-10-26 00:54:26,935 - INFO - data_with_error length: 0
2024-10-26 00:54:26,938 - INFO - prediction_df length: 5111
2024-10-26 00:54:26,942 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 00:54:28,663 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 00:54:28,665 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 00:54:28,670 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 00:54:28,675 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 00:54:28,677 - INFO - Data scaling started.
2024-10-26 00:54:28,698 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 00:54:28,705 - INFO - Data scaling completed.
2024-10-26 00:54:28,707 - INFO - Feature Selection started.
2024-10-26 00:56:53,196 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 00:56:53,198 - INFO - Feature selection using RFE completed.
2024-10-26 00:56:53,200 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 00:56:53,201 - INFO - First fit started
2024-10-26 01:00:59,582 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 01:01:01,282 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.001195683992704651, R2: 0.9998180324313685, Stacking Model MAE: 0.01591254953967278, Stacking Model MAPE: 0.49608028105383145%
2024-10-26 01:01:01,284 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-26 01:01:01,287 - INFO - Start match_outcome predictions
2024-10-26 01:01:01,289 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 01:01:01,402 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 01:01:01,404 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:01:04,532 - INFO - match_outcome predictions: [7.02109208 1.00205521 1.01477617 ... 3.85477247 3.58048356 3.84954618]
2024-10-26 01:01:15,240 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-26 01:01:15,357 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-26 01:01:15,366 - ERROR - Error occurred while saving the models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x0000025A2B9E84C0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-26 01:01:15,472 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-26 01:06:45,379 - INFO - Model directory checked/created.
2024-10-26 01:06:50,796 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 01:06:50,895 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 01:06:50,896 - INFO - Data loaded with 5111 rows
2024-10-26 01:06:50,896 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 01:06:51,230 - INFO - new real scores length: 26
2024-10-26 01:06:51,247 - INFO - data_with_error length: 0
2024-10-26 01:06:51,250 - INFO - prediction_df length: 5111
2024-10-26 01:06:51,252 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:06:53,397 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 01:06:53,411 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 01:06:53,413 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 01:06:53,430 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 01:06:53,430 - INFO - Data scaling started.
2024-10-26 01:06:53,447 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 01:06:53,463 - INFO - Data scaling completed.
2024-10-26 01:06:53,463 - INFO - Feature Selection started.
2024-10-26 01:09:15,762 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 01:09:15,779 - INFO - Feature selection using RFE completed.
2024-10-26 01:09:15,779 - INFO - Selected Features: ['running_id', 'away_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 01:09:15,779 - INFO - First fit started
2024-10-26 01:13:16,631 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 01:13:18,365 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0021836110472844518, R2: 0.9996676827694143, Stacking Model MAE: 0.023994046237508577, Stacking Model MAPE: 0.9012162012394253%
2024-10-26 01:13:18,365 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.70425138632163%
2024-10-26 01:13:18,380 - INFO - Start match_outcome predictions
2024-10-26 01:13:18,380 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 01:13:18,495 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 01:13:18,496 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:13:21,781 - INFO - match_outcome predictions: [7.06211509 0.98893711 1.02266036 ... 3.83653484 3.45060133 3.84247152]
2024-10-26 01:13:31,375 - ERROR - Error occurred while saving the models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000232095A84C0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-26 01:24:09,063 - INFO - Model directory checked/created.
2024-10-26 01:24:13,882 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 01:24:13,982 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 01:24:13,982 - INFO - Data loaded with 5111 rows
2024-10-26 01:24:13,982 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 01:24:14,369 - INFO - new real scores length: 26
2024-10-26 01:24:14,378 - INFO - data_with_error length: 0
2024-10-26 01:24:14,381 - INFO - prediction_df length: 5111
2024-10-26 01:24:14,381 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:24:16,182 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 01:24:16,182 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 01:24:16,182 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 01:24:16,196 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 01:24:16,198 - INFO - Data scaling started.
2024-10-26 01:24:16,215 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 01:24:16,215 - INFO - Data scaling completed.
2024-10-26 01:24:16,215 - INFO - Feature Selection started.
2024-10-26 01:26:35,398 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 01:26:35,398 - INFO - Feature selection using RFE completed.
2024-10-26 01:26:35,398 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 01:26:35,398 - INFO - First fit started
2024-10-26 01:30:47,515 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 01:30:49,258 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0010714286596276974, R2: 0.9998369424786615, Stacking Model MAE: 0.01746827681733543, Stacking Model MAPE: 0.5275667380773748%
2024-10-26 01:30:49,260 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.92606284658041%
2024-10-26 01:30:49,263 - INFO - Start match_outcome predictions
2024-10-26 01:30:49,265 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 01:30:49,386 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 01:30:49,387 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:30:52,586 - INFO - match_outcome predictions: [7.00519726 0.99357394 0.99785853 ... 3.94024552 3.69076112 3.943474  ]
2024-10-26 01:31:01,937 - ERROR - Error occurred while saving the models: 'KerasRegressor' object has no attribute 'save'
2024-10-26 01:31:02,078 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-26 01:33:59,065 - INFO - Model directory checked/created.
2024-10-26 01:34:04,134 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 01:34:04,216 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 01:34:04,218 - INFO - Data loaded with 5111 rows
2024-10-26 01:34:04,218 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 01:34:04,611 - INFO - new real scores length: 26
2024-10-26 01:34:04,617 - INFO - data_with_error length: 0
2024-10-26 01:34:04,640 - INFO - prediction_df length: 5111
2024-10-26 01:34:04,643 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:34:06,614 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 01:34:06,617 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 01:34:06,618 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 01:34:06,618 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 01:34:06,618 - INFO - Data scaling started.
2024-10-26 01:34:06,650 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 01:34:06,650 - INFO - Data scaling completed.
2024-10-26 01:34:06,650 - INFO - Feature Selection started.
2024-10-26 01:36:30,119 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 01:36:30,121 - INFO - Feature selection using RFE completed.
2024-10-26 01:36:30,123 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 01:36:30,124 - INFO - First fit started
2024-10-26 01:40:39,616 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 01:40:41,350 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002520849794052929, R2: 0.9996163594137684, Stacking Model MAE: 0.01846797267790506, Stacking Model MAPE: 0.8074954977887088%
2024-10-26 01:40:41,353 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.51940850277265%
2024-10-26 01:40:41,358 - INFO - Start match_outcome predictions
2024-10-26 01:40:41,359 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 01:40:41,466 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 01:40:41,466 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:40:44,519 - INFO - match_outcome predictions: [7.03969159 0.99326403 1.08464963 ... 3.71621986 2.88069663 3.70212063]
2024-10-26 01:40:56,183 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-26 01:40:56,295 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-26 01:40:56,297 - ERROR - Error occurred while saving the models: 'nn'
2024-10-26 01:40:56,417 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-26 01:46:06,067 - INFO - Model directory checked/created.
2024-10-26 01:46:11,240 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 01:46:11,338 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 01:46:11,341 - INFO - Data loaded with 5111 rows
2024-10-26 01:46:11,345 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 01:46:11,618 - INFO - new real scores length: 26
2024-10-26 01:46:11,635 - INFO - data_with_error length: 0
2024-10-26 01:46:11,635 - INFO - prediction_df length: 5111
2024-10-26 01:46:11,635 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:46:13,332 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 01:46:13,335 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 01:46:13,337 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 01:46:13,337 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 01:46:13,337 - INFO - Data scaling started.
2024-10-26 01:46:13,368 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 01:46:13,368 - INFO - Data scaling completed.
2024-10-26 01:46:13,368 - INFO - Feature Selection started.
2024-10-26 01:48:33,618 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 01:48:33,618 - INFO - Feature selection using RFE completed.
2024-10-26 01:48:33,618 - INFO - Selected Features: ['running_id', 'away_encoded', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 01:48:33,633 - INFO - First fit started
2024-10-26 01:52:33,238 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 01:52:35,169 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.001444316980411005, R2: 0.9997801937210316, Stacking Model MAE: 0.02112326182115881, Stacking Model MAPE: 1.39485110035462%
2024-10-26 01:52:35,169 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.74121996303143%
2024-10-26 01:52:35,169 - INFO - Start match_outcome predictions
2024-10-26 01:52:35,185 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 01:52:35,301 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 01:52:35,301 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:52:38,803 - INFO - match_outcome predictions: [7.0394292  0.97386725 0.93787142 ... 3.78652069 3.31982451 3.79839076]
2024-10-26 01:52:49,653 - ERROR - Error occurred while saving the models: 'Sequential' object has no attribute 'model_'
2024-10-26 01:52:49,785 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-26 01:54:21,141 - INFO - Model directory checked/created.
2024-10-26 01:54:26,197 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-26 01:54:26,286 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-26 01:54:26,286 - INFO - Data loaded with 5111 rows
2024-10-26 01:54:26,286 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-26 01:54:26,585 - INFO - new real scores length: 26
2024-10-26 01:54:26,602 - INFO - data_with_error length: 0
2024-10-26 01:54:26,609 - INFO - prediction_df length: 5111
2024-10-26 01:54:26,611 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 01:54:28,269 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-26 01:54:28,269 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-26 01:54:28,285 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-26 01:54:28,287 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-26 01:54:28,287 - INFO - Data scaling started.
2024-10-26 01:54:28,320 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-26 01:54:28,337 - INFO - Data scaling completed.
2024-10-26 01:54:28,337 - INFO - Feature Selection started.
2024-10-26 01:56:46,333 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-26 01:56:46,335 - INFO - Feature selection using RFE completed.
2024-10-26 01:56:46,335 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-26 01:56:46,335 - INFO - First fit started
2024-10-26 02:00:43,152 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-26 02:00:44,859 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.001009515378359634, R2: 0.9998463648756553, Stacking Model MAE: 0.016375398920541233, Stacking Model MAPE: 0.7728403661615908%
2024-10-26 02:00:44,861 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-26 02:00:44,863 - INFO - Start match_outcome predictions
2024-10-26 02:00:44,863 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-26 02:00:44,969 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-26 02:00:44,969 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-26 02:00:47,967 - INFO - match_outcome predictions: [6.9927153  0.98954763 1.01327646 ... 3.7714779  3.36043132 3.7752685 ]
2024-10-26 02:00:58,586 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-26 02:00:58,703 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-26 02:00:59,467 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpeb5fwnp1\tmp6pgso12_\assets
2024-10-26 02:00:59,702 - INFO - Error with joblib: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000002055B7AF280>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-26 02:01:00,454 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpeb5fwnp1\tmpy386de5z\assets
2024-10-26 02:01:00,687 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-26 02:01:00,787 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-28 13:26:32,176 - INFO - Model directory checked/created.
2024-10-28 13:26:39,080 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 13:26:39,134 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 13:26:39,134 - INFO - Data loaded with 5111 rows
2024-10-28 13:26:39,144 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 13:26:39,560 - INFO - new real scores length: 26
2024-10-28 13:26:39,581 - INFO - data_with_error length: 0
2024-10-28 13:26:39,583 - INFO - prediction_df length: 5111
2024-10-28 13:26:39,585 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 13:26:53,209 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 13:26:53,210 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 13:26:53,216 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 13:26:53,220 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 13:26:53,220 - INFO - Data scaling started.
2024-10-28 13:26:53,231 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 13:26:53,238 - INFO - Data scaling completed.
2024-10-28 13:26:53,238 - INFO - Feature Selection started.
2024-10-28 13:29:57,702 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 13:29:57,705 - INFO - Feature selection using RFE completed.
2024-10-28 13:29:57,705 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-28 13:29:57,706 - INFO - First fit started
2024-10-28 13:52:48,131 - INFO - Model directory checked/created.
2024-10-28 13:52:54,826 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 13:52:54,865 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 13:52:54,865 - INFO - Data loaded with 5111 rows
2024-10-28 13:52:54,869 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 13:52:55,239 - INFO - new real scores length: 26
2024-10-28 13:52:55,252 - INFO - data_with_error length: 0
2024-10-28 13:52:55,254 - INFO - prediction_df length: 5111
2024-10-28 13:52:55,256 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 13:52:59,063 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 13:52:59,065 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 13:52:59,069 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 13:52:59,073 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 13:52:59,073 - INFO - Data scaling started.
2024-10-28 13:52:59,083 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 13:52:59,091 - INFO - Data scaling completed.
2024-10-28 13:52:59,091 - INFO - Feature Selection started.
2024-10-28 13:56:07,809 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 13:56:07,812 - INFO - Feature selection using RFE completed.
2024-10-28 13:56:07,812 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-28 13:56:07,812 - INFO - First fit started
2024-10-28 18:23:54,783 - INFO - Model directory checked/created.
2024-10-28 18:23:59,712 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 18:23:59,812 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 18:23:59,812 - INFO - Data loaded with 5111 rows
2024-10-28 18:23:59,829 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 18:24:00,145 - INFO - new real scores length: 26
2024-10-28 18:24:00,162 - INFO - data_with_error length: 0
2024-10-28 18:24:00,162 - INFO - prediction_df length: 5111
2024-10-28 18:24:00,162 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 18:24:01,862 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 18:24:01,862 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 18:24:01,879 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 18:24:01,879 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 18:24:01,879 - INFO - Data scaling started.
2024-10-28 18:24:01,912 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 18:24:01,929 - INFO - Data scaling completed.
2024-10-28 18:24:01,929 - INFO - Feature Selection started.
2024-10-28 18:26:22,578 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 18:26:22,578 - INFO - Feature selection using RFE completed.
2024-10-28 18:26:22,578 - INFO - Selected Features: ['running_id', 'away_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-28 18:26:22,578 - INFO - First fit started
2024-10-28 18:30:24,746 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 18:30:26,499 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0017664192431559738, R2: 0.9997311739415915, Stacking Model MAE: 0.015237098385634446, Stacking Model MAPE: 0.6018563049252185%
2024-10-28 18:30:26,500 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.48243992606285%
2024-10-28 18:30:26,503 - INFO - Start match_outcome predictions
2024-10-28 18:30:26,504 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 18:30:26,636 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 18:30:26,639 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 18:30:29,830 - INFO - match_outcome predictions: [7.05347251 0.99627836 1.04198863 ... 3.72934185 3.08801318 3.73890986]
2024-10-28 18:30:41,961 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-28 18:30:42,122 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-28 18:30:43,028 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpbtme7uo2\tmpnqn8lfss\assets
2024-10-28 18:30:43,329 - INFO - Error with joblib: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001B5E88291F0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 18:30:44,083 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpbtme7uo2\tmps0g2x9ih\assets
2024-10-28 18:30:44,411 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-28 18:30:44,529 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-28 19:00:54,526 - INFO - Model directory checked/created.
2024-10-28 19:01:00,041 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 19:01:00,158 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 19:01:00,158 - INFO - Data loaded with 5111 rows
2024-10-28 19:01:00,158 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 19:01:00,475 - INFO - new real scores length: 26
2024-10-28 19:01:00,492 - INFO - data_with_error length: 0
2024-10-28 19:01:00,497 - INFO - prediction_df length: 5111
2024-10-28 19:01:00,500 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:01:02,600 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 19:01:02,605 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 19:01:02,618 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 19:01:02,641 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 19:01:02,644 - INFO - Data scaling started.
2024-10-28 19:01:02,684 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 19:01:02,695 - INFO - Data scaling completed.
2024-10-28 19:01:02,696 - INFO - Feature Selection started.
2024-10-28 19:03:33,089 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 19:03:33,095 - INFO - Feature selection using RFE completed.
2024-10-28 19:03:33,096 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-28 19:03:33,098 - INFO - First fit started
2024-10-28 19:08:08,902 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 19:08:10,949 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002865940270391461, R2: 0.9995638411268963, Stacking Model MAE: 0.03039780619949642, Stacking Model MAPE: 1.1574353153579704%
2024-10-28 19:08:10,951 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.48243992606285%
2024-10-28 19:08:10,953 - INFO - Second fit started
2024-10-28 19:12:57,224 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 19:12:59,344 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.004565192404360892, R2: 0.9992867430009537, Stacking Model MAE: 0.01721410597679749, Stacking Model MAPE: 0.9307098578209744%
2024-10-28 19:12:59,346 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 98.9648798521257%
2024-10-28 19:12:59,348 - INFO - Start match_outcome predictions
2024-10-28 19:12:59,348 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 19:12:59,463 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 19:12:59,473 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:13:03,060 - INFO - match_outcome predictions: [6.99417074 0.99836782 1.4951647  ... 3.91449603 2.64488327 3.916257  ]
2024-10-28 19:13:16,791 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-28 19:13:17,013 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-28 19:13:17,775 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp8ky6qsfc\tmp9hcsmcyk\assets
2024-10-28 19:13:18,041 - INFO - Error with joblib: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000002B1746AD820>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 19:13:19,110 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp8ky6qsfc\tmpzt4kmhau\assets
2024-10-28 19:13:19,409 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-28 19:13:19,542 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-28 19:20:06,574 - INFO - Model directory checked/created.
2024-10-28 19:20:11,593 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 19:20:11,692 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 19:20:11,692 - INFO - Data loaded with 5111 rows
2024-10-28 19:20:11,707 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 19:20:12,008 - INFO - new real scores length: 26
2024-10-28 19:20:12,008 - INFO - data_with_error length: 0
2024-10-28 19:20:12,025 - INFO - prediction_df length: 5111
2024-10-28 19:20:12,027 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:20:13,841 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 19:20:13,857 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 19:20:13,860 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 19:20:13,860 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 19:20:13,873 - INFO - Data scaling started.
2024-10-28 19:20:13,892 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 19:20:13,908 - INFO - Data scaling completed.
2024-10-28 19:20:13,909 - INFO - Feature Selection started.
2024-10-28 19:22:38,691 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 19:22:38,708 - INFO - Feature selection using RFE completed.
2024-10-28 19:22:38,708 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-28 19:22:38,708 - INFO - First fit started
2024-10-28 19:26:42,339 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 19:26:44,134 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.004718491770633093, R2: 0.9992819068580423, Stacking Model MAE: 0.023795127081952912, Stacking Model MAPE: 0.8397045012894427%
2024-10-28 19:26:44,135 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-28 19:26:44,135 - INFO - Second fit started
2024-10-28 19:30:45,874 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 19:30:47,629 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0014508592936477256, R2: 0.9997733204968893, Stacking Model MAE: 0.017654195796835234, Stacking Model MAPE: 0.7545611808434642%
2024-10-28 19:30:47,629 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.74121996303143%
2024-10-28 19:30:47,629 - INFO - Start match_outcome predictions
2024-10-28 19:30:47,629 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 19:30:47,757 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 19:30:47,757 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:30:50,972 - INFO - match_outcome predictions: [7.03296466 0.99139834 1.18620268 ... 3.89373901 3.28151705 3.89489318]
2024-10-28 19:31:02,422 - INFO - Assets written to: ./models/nn_regressor_match_outcome_stacked_2fit\assets
2024-10-28 19:31:02,540 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit
2024-10-28 19:31:03,396 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpimdioclf\tmp7h3qtn34\assets
2024-10-28 19:31:03,655 - INFO - Error with joblib: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001FE91F40EE0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 19:31:04,641 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpimdioclf\tmp7bm5bt54\assets
2024-10-28 19:31:05,409 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-28 19:31:05,542 - INFO - Keras model zipped successfully at ./models/nn_regressor_match_outcome_stacked_2fit.zip
2024-10-28 19:39:22,800 - INFO - Model directory checked/created.
2024-10-28 19:39:27,541 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 19:39:27,640 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 19:39:27,640 - INFO - Data loaded with 5111 rows
2024-10-28 19:39:27,657 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 19:39:27,940 - INFO - new real scores length: 26
2024-10-28 19:39:27,958 - INFO - data_with_error length: 0
2024-10-28 19:39:27,958 - INFO - prediction_df length: 5111
2024-10-28 19:39:27,958 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:39:29,673 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 19:39:29,688 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 19:39:29,690 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 19:39:29,690 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 19:39:29,690 - INFO - Data scaling started.
2024-10-28 19:39:29,723 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 19:39:29,723 - INFO - Data scaling completed.
2024-10-28 19:39:29,723 - INFO - Feature Selection started.
2024-10-28 19:41:51,473 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 19:41:51,473 - INFO - Feature selection using RFE completed.
2024-10-28 19:41:51,473 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-28 19:41:51,473 - INFO - First fit started
2024-10-28 19:42:06,873 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0003s vs `on_train_batch_end` time: 0.0025s). Check your callbacks.
2024-10-28 19:44:29,022 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0025s). Check your callbacks.
2024-10-28 19:44:55,524 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0001s). Check your callbacks.
2024-10-28 19:45:47,601 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 19:45:49,423 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.00749955162317991, R2: 0.9988586656817162, Stacking Model MAE: 0.010344298238185024, Stacking Model MAPE: 0.5979610122410853%
2024-10-28 19:45:49,426 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-28 19:45:49,427 - INFO - Second fit started
2024-10-28 19:49:51,073 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 19:49:52,824 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.010611179756103477, R2: 0.9983421294090585, Stacking Model MAE: 0.06327178291998795, Stacking Model MAPE: 1.2389501665481193%
2024-10-28 19:49:52,838 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-28 19:49:52,839 - INFO - Start match_outcome predictions
2024-10-28 19:49:52,839 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 19:49:52,956 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 19:49:52,956 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:49:56,247 - INFO - match_outcome predictions: [6.87869005 1.0026523  1.20126902 ... 3.88885624 3.46481921 3.88463763]
2024-10-28 19:50:06,919 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit.h5
2024-10-28 19:50:08,045 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpyn5ktrau\tmpdm_p8bi7\assets
2024-10-28 19:50:08,293 - INFO - Error with joblib: Can't pickle <function CustomReduceLROnPlateau.__init__.<locals>.<lambda> at 0x000002A8943124C0>: it's not found as __main__.CustomReduceLROnPlateau.__init__.<locals>.<lambda>
2024-10-28 19:50:09,005 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpyn5ktrau\tmpevq_fq1u\assets
2024-10-28 19:50:09,732 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-28 20:15:39,669 - INFO - Model directory checked/created.
2024-10-28 20:15:45,057 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 20:15:45,148 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 20:15:45,150 - INFO - Data loaded with 5111 rows
2024-10-28 20:15:45,156 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 20:15:45,478 - INFO - new real scores length: 26
2024-10-28 20:15:45,487 - INFO - data_with_error length: 0
2024-10-28 20:15:45,490 - INFO - prediction_df length: 5111
2024-10-28 20:15:45,495 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 20:15:47,704 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 20:15:47,704 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 20:15:47,722 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 20:15:47,722 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 20:15:47,722 - INFO - Data scaling started.
2024-10-28 20:15:47,755 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 20:15:47,755 - INFO - Data scaling completed.
2024-10-28 20:15:47,755 - INFO - Feature Selection started.
2024-10-28 20:18:08,336 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 20:18:08,338 - INFO - Feature selection using RFE completed.
2024-10-28 20:18:08,338 - INFO - Selected Features: ['running_id', 'away_encoded', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_saves_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_poisson_xG']
2024-10-28 20:18:08,338 - INFO - First fit started
2024-10-28 20:22:01,286 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 20:22:02,938 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0005s vs `on_predict_batch_end` time: 0.0024s). Check your callbacks.
2024-10-28 20:22:03,009 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.005324688796589102, R2: 0.9991896515467745, Stacking Model MAE: 0.006361657057283898, Stacking Model MAPE: 0.33848041208103596%
2024-10-28 20:22:03,009 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.85212569316081%
2024-10-28 20:22:03,009 - INFO - Second fit started
2024-10-28 20:24:11,604 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0001s vs `on_train_batch_end` time: 0.0002s). Check your callbacks.
2024-10-28 20:25:57,254 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 20:25:58,921 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0026s). Check your callbacks.
2024-10-28 20:25:58,988 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0022765732226091577, R2: 0.9996443125193768, Stacking Model MAE: 0.024539661851411432, Stacking Model MAPE: 1.0971249193081556%
2024-10-28 20:25:58,990 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.70425138632163%
2024-10-28 20:25:58,994 - INFO - Start match_outcome predictions
2024-10-28 20:25:58,994 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 20:25:59,137 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 20:25:59,137 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 20:26:02,171 - INFO - match_outcome predictions: [7.05456366 0.98252221 1.08679855 ... 3.89876897 3.40502082 3.89872412]
2024-10-28 20:26:13,187 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-10-28 20:26:13,188 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-10-28 20:26:13,188 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-10-28 20:26:13,188 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-10-28 20:26:13,188 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-10-28 20:26:13,188 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-10-28 20:26:13,188 - INFO - Metrics used in the model:
2024-10-28 20:26:13,188 - ERROR - Error occurred while saving the models: name 'model' is not defined
2024-10-28 20:28:14,754 - INFO - Model directory checked/created.
2024-10-28 20:28:19,621 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 20:28:19,744 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 20:28:19,747 - INFO - Data loaded with 5111 rows
2024-10-28 20:28:19,752 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 20:28:20,073 - INFO - new real scores length: 26
2024-10-28 20:28:20,082 - INFO - data_with_error length: 0
2024-10-28 20:28:20,086 - INFO - prediction_df length: 5111
2024-10-28 20:28:20,091 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 20:28:21,923 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 20:28:21,925 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 20:28:21,930 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 20:28:21,933 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 20:28:21,935 - INFO - Data scaling started.
2024-10-28 20:28:21,988 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 20:28:22,005 - INFO - Data scaling completed.
2024-10-28 20:28:22,005 - INFO - Feature Selection started.
2024-10-28 20:30:40,710 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 20:30:40,714 - INFO - Feature selection using RFE completed.
2024-10-28 20:30:40,715 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-28 20:30:40,717 - INFO - First fit started
2024-10-28 20:34:39,970 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 20:34:41,891 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0005584174622264338, R2: 0.9999150161175505, Stacking Model MAE: 0.009280848699475182, Stacking Model MAPE: 0.496684295807275%
2024-10-28 20:34:41,902 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.9630314232902%
2024-10-28 20:34:41,904 - INFO - Second fit started
2024-10-28 20:38:49,421 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0001s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-10-28 20:38:50,332 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 20:38:52,126 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.003122548760095676, R2: 0.9995121389065937, Stacking Model MAE: 0.021678966788702268, Stacking Model MAPE: 0.6181495315827571%
2024-10-28 20:38:52,126 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-10-28 20:38:52,135 - INFO - Start match_outcome predictions
2024-10-28 20:38:52,137 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 20:38:52,271 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 20:38:52,273 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 20:38:55,351 - INFO - match_outcome predictions: [6.98708743 0.99763164 1.10616539 ... 3.93104812 3.51950059 3.92808323]
2024-10-28 20:39:06,237 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-10-28 20:39:06,237 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-10-28 20:39:06,237 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-10-28 20:39:06,259 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-10-28 20:39:06,260 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-10-28 20:39:06,260 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-10-28 20:39:06,260 - INFO - Metrics used in the model:
2024-10-28 20:39:06,260 - INFO - Metric: loss, Metric Type: Mean
2024-10-28 20:39:06,260 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-10-28 20:39:06,260 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-10-28 20:39:06,403 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit.h5
2024-10-28 20:39:07,437 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpc448rw6m\tmpwtu35y56\assets
2024-10-28 20:39:07,719 - INFO - Error with joblib: Can't pickle <function CustomReduceLROnPlateau.__init__.<locals>.<lambda> at 0x00000217FAE234C0>: it's not found as __main__.CustomReduceLROnPlateau.__init__.<locals>.<lambda>
2024-10-28 20:39:08,436 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpc448rw6m\tmpsus2l6fp\assets
2024-10-28 20:39:09,133 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-28 20:50:40,303 - INFO - Model directory checked/created.
2024-10-28 20:51:12,769 - INFO - Model directory checked/created.
2024-10-28 20:51:17,779 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 20:51:17,898 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 20:51:17,901 - INFO - Data loaded with 5111 rows
2024-10-28 20:51:17,905 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 20:51:18,202 - INFO - new real scores length: 26
2024-10-28 20:51:18,370 - INFO - data_with_error length: 0
2024-10-28 20:51:18,374 - INFO - prediction_df length: 5111
2024-10-28 20:51:18,377 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 20:51:20,248 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 20:51:20,249 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 20:51:20,254 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 20:51:20,259 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 20:51:20,262 - INFO - Data scaling started.
2024-10-28 20:51:20,284 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 20:51:20,289 - INFO - Data scaling completed.
2024-10-28 20:51:20,289 - INFO - Feature Selection started.
2024-10-28 20:53:42,120 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 20:53:42,123 - INFO - Feature selection using RFE completed.
2024-10-28 20:53:42,125 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-28 20:53:42,127 - INFO - First fit started
2024-10-28 20:57:35,535 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 20:57:37,539 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002256599253307221, R2: 0.9996565749127652, Stacking Model MAE: 0.027383326653997883, Stacking Model MAPE: 0.874883064820606%
2024-10-28 20:57:37,550 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.55637707948244%
2024-10-28 20:57:37,552 - INFO - Second fit started
2024-10-28 21:01:45,069 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 21:01:46,784 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0026235280312037388, R2: 0.9995901049584104, Stacking Model MAE: 0.02071744423706522, Stacking Model MAPE: 1.0769864297974885%
2024-10-28 21:01:46,786 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.48243992606285%
2024-10-28 21:01:46,790 - INFO - Start match_outcome predictions
2024-10-28 21:01:46,792 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 21:01:46,934 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 21:01:46,934 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 21:01:50,035 - INFO - match_outcome predictions: [7.02267455 0.98739705 1.20318687 ... 3.7977768  3.05261884 3.78891555]
2024-10-28 21:02:01,133 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-10-28 21:02:01,135 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-10-28 21:02:01,135 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-10-28 21:02:01,135 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-10-28 21:02:01,135 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-10-28 21:02:01,135 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-10-28 21:02:01,135 - INFO - Metrics used in the model:
2024-10-28 21:02:01,135 - INFO - Metric: loss, Metric Type: Mean
2024-10-28 21:02:01,135 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-10-28 21:02:01,135 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-10-28 21:02:01,300 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit.h5
2024-10-28 21:02:02,401 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp06j4ey0e\tmpv8visy2y\assets
2024-10-28 21:02:02,751 - INFO - Error with joblib: Can't pickle <function CustomReduceLROnPlateau.__init__.<locals>.<lambda> at 0x000002668CC73CA0>: it's not found as __main__.CustomReduceLROnPlateau.__init__.<locals>.<lambda>
2024-10-28 21:02:03,468 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp06j4ey0e\tmpnkb6ubfn\assets
2024-10-28 21:02:04,296 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-28 21:24:52,728 - INFO - Model directory checked/created.
2024-10-28 21:24:57,808 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 21:24:57,974 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 21:24:57,974 - INFO - Data loaded with 5111 rows
2024-10-28 21:24:57,974 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 21:24:58,306 - INFO - new real scores length: 26
2024-10-28 21:24:58,500 - INFO - data_with_error length: 0
2024-10-28 21:24:58,508 - INFO - prediction_df length: 5111
2024-10-28 21:24:58,512 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 21:25:00,411 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-28 21:25:00,412 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 21:25:00,418 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 21:25:00,425 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 21:25:00,427 - INFO - Data scaling started.
2024-10-28 21:25:00,446 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-28 21:25:00,454 - INFO - Data scaling completed.
2024-10-28 21:25:00,456 - INFO - Feature Selection started.
2024-10-28 21:27:23,758 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-28 21:27:23,762 - INFO - Feature selection using RFE completed.
2024-10-28 21:27:23,763 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-28 21:27:23,765 - INFO - First fit started
2024-10-28 21:29:38,090 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0000s). Check your callbacks.
2024-10-28 21:30:05,630 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0001s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-10-28 21:31:24,224 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-28 21:31:26,010 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0030522979515420546, R2: 0.9995354799090982, Stacking Model MAE: 0.023621610411457303, Stacking Model MAPE: 0.6943181670624075%
2024-10-28 21:31:26,012 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.70425138632163%
2024-10-28 21:31:26,014 - INFO - Second fit started
2024-10-28 21:34:30,013 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-10-28 21:35:28,277 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-28 21:35:30,059 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0013666771306249294, R2: 0.9997864729583087, Stacking Model MAE: 0.012347531934859326, Stacking Model MAPE: 0.6700514239465369%
2024-10-28 21:35:30,061 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.77818853974122%
2024-10-28 21:35:30,064 - INFO - Start match_outcome predictions
2024-10-28 21:35:30,066 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 21:35:30,194 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-28 21:35:30,196 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 21:35:33,379 - INFO - match_outcome predictions: [7.04538059 0.99903146 1.18826435 ... 3.83302769 3.27012215 3.83318025]
2024-10-28 21:35:44,065 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-10-28 21:35:44,067 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-10-28 21:35:44,068 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-10-28 21:35:44,070 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-10-28 21:35:44,073 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-10-28 21:35:44,075 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-10-28 21:35:44,076 - INFO - Metrics used in the model:
2024-10-28 21:35:44,078 - INFO - Metric: loss, Metric Type: Mean
2024-10-28 21:35:44,080 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-10-28 21:35:44,081 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-10-28 21:35:44,245 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit.h5
2024-10-28 21:35:45,396 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpmifvt55u\tmpip6aw6zr\assets
2024-10-28 21:35:45,650 - INFO - Error with joblib: Can't pickle <function CustomReduceLROnPlateau.__init__.<locals>.<lambda> at 0x00000225E03F2CA0>: it's not found as __main__.CustomReduceLROnPlateau.__init__.<locals>.<lambda>
2024-10-28 21:35:46,381 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpmifvt55u\tmpgqfyolel\assets
2024-10-28 21:35:47,074 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-10-30 17:03:31,510 - INFO - Model directory checked/created.
2024-10-30 17:03:36,412 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-30 17:03:36,511 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-30 17:03:36,511 - INFO - Data loaded with 5111 rows
2024-10-30 17:03:36,528 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-30 17:03:36,831 - INFO - new real scores length: 26
2024-10-30 17:03:38,381 - INFO - data_with_error length: 0
2024-10-30 17:03:38,381 - INFO - prediction_df length: 5111
2024-10-30 17:03:38,381 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-30 17:03:40,119 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-10-30 17:03:40,131 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-30 17:03:40,137 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-30 17:03:40,142 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-30 17:03:40,144 - INFO - Data scaling started.
2024-10-30 17:03:40,164 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-10-30 17:03:40,178 - INFO - Data scaling completed.
2024-10-30 17:03:40,180 - INFO - Feature Selection started.
2024-10-30 17:06:19,235 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-10-30 17:06:19,239 - INFO - Feature selection using RFE completed.
2024-10-30 17:06:19,240 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-10-30 17:06:19,241 - INFO - First fit started
2024-10-30 17:10:45,634 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-10-30 17:10:47,663 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0005763284816046671, R2: 0.9999122902931121, Stacking Model MAE: 0.01484275849854137, Stacking Model MAPE: 0.480717766838829%
2024-10-30 17:10:47,665 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.92606284658041%
2024-10-30 17:10:47,666 - INFO - Second fit started
2024-10-30 17:15:00,411 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-10-30 17:15:01,267 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-10-30 17:15:03,000 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0006825154659480153, R2: 0.9998933650786372, Stacking Model MAE: 0.007983097101972871, Stacking Model MAPE: 0.4749326086610611%
2024-10-30 17:15:03,002 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-10-30 17:15:03,005 - INFO - Start match_outcome predictions
2024-10-30 17:15:03,007 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-30 17:15:03,149 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-10-30 17:15:03,150 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-30 17:15:06,283 - INFO - match_outcome predictions: [7.0093962  1.00209977 1.0947842  ... 3.91729231 3.46615195 3.91886998]
2024-10-30 17:15:16,414 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-10-30 17:15:16,416 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-10-30 17:15:16,417 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-10-30 17:15:16,419 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-10-30 17:15:16,420 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-10-30 17:15:16,421 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-10-30 17:15:16,422 - INFO - Metrics used in the model:
2024-10-30 17:15:16,423 - INFO - Metric: loss, Metric Type: Mean
2024-10-30 17:15:16,426 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-10-30 17:15:16,429 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-10-30 17:15:16,563 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit.h5
2024-10-30 17:15:17,767 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpvw_mf3jq\tmp01htuwg8\assets
2024-10-30 17:15:18,025 - INFO - Error with joblib: Can't pickle <function CustomReduceLROnPlateau.__init__.<locals>.<lambda> at 0x0000029F3F982D30>: it's not found as __main__.CustomReduceLROnPlateau.__init__.<locals>.<lambda>
2024-10-30 17:15:18,823 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpvw_mf3jq\tmpbq_p_e9r\assets
2024-10-30 17:15:19,608 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-11-02 15:48:31,032 - INFO - Model directory checked/created.
2024-11-02 15:48:37,527 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 15:48:37,583 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 15:48:37,583 - INFO - Data loaded with 5111 rows
2024-11-02 15:48:37,592 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 15:48:37,972 - INFO - new real scores length: 26
2024-11-02 15:48:38,011 - INFO - data_with_error length: 0
2024-11-02 15:48:38,013 - INFO - prediction_df length: 5111
2024-11-02 15:48:38,016 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 15:48:40,556 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 15:48:40,557 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 15:48:40,563 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 15:48:40,568 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 15:48:40,568 - INFO - Data scaling started.
2024-11-02 15:48:40,580 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 15:48:40,588 - INFO - Data scaling completed.
2024-11-02 15:48:40,588 - INFO - Feature Selection started.
2024-11-02 15:51:42,016 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 15:51:42,020 - INFO - Feature selection using RFE completed.
2024-11-02 15:51:42,020 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_saves_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo']
2024-11-02 15:51:42,020 - INFO - First fit started
2024-11-02 15:59:55,730 - INFO - Model directory checked/created.
2024-11-02 16:00:02,126 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 16:00:02,177 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 16:00:02,178 - INFO - Data loaded with 5111 rows
2024-11-02 16:00:02,182 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 16:00:02,576 - INFO - new real scores length: 26
2024-11-02 16:00:02,606 - INFO - data_with_error length: 0
2024-11-02 16:00:02,611 - INFO - prediction_df length: 5111
2024-11-02 16:00:02,623 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 16:00:08,445 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 16:00:08,446 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 16:00:08,452 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 16:00:08,459 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 16:00:08,459 - INFO - Data scaling started.
2024-11-02 16:00:08,476 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 16:00:08,491 - INFO - Data scaling completed.
2024-11-02 16:00:08,491 - INFO - Feature Selection started.
2024-11-02 16:03:13,386 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 16:03:13,389 - INFO - Feature selection using RFE completed.
2024-11-02 16:03:13,389 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 16:03:13,389 - INFO - First fit started
2024-11-02 16:08:18,958 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 16:19:47,441 - INFO - Model directory checked/created.
2024-11-02 16:19:53,647 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 16:19:53,685 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 16:19:53,685 - INFO - Data loaded with 5111 rows
2024-11-02 16:19:53,689 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 16:19:54,056 - INFO - new real scores length: 26
2024-11-02 16:19:54,079 - INFO - data_with_error length: 0
2024-11-02 16:19:54,082 - INFO - prediction_df length: 5111
2024-11-02 16:19:54,085 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 16:19:56,266 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 16:19:56,267 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 16:19:56,272 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 16:19:56,277 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 16:19:56,277 - INFO - Data scaling started.
2024-11-02 16:19:56,288 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 16:19:56,296 - INFO - Data scaling completed.
2024-11-02 16:19:56,296 - INFO - Feature Selection started.
2024-11-02 16:22:58,105 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 16:22:58,108 - INFO - Feature selection using RFE completed.
2024-11-02 16:22:58,108 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 16:22:58,109 - INFO - First fit started
2024-11-02 16:29:45,701 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 16:29:48,153 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 16:29:48,257 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0018629305648043104, R2: 0.9997164861723707, Stacking Model MAE: 0.0127421448643357, Stacking Model MAPE: 0.4372052047908255%
2024-11-02 16:29:48,257 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-11-02 16:29:48,257 - INFO - Second fit started
2024-11-02 16:35:42,295 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 16:36:31,462 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 16:36:34,057 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0022492859919839583, R2: 0.9996485758245136, Stacking Model MAE: 0.018967433614473162, Stacking Model MAPE: 0.764955016530432%
2024-11-02 16:36:34,057 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.51940850277265%
2024-11-02 16:36:34,063 - INFO - Start match_outcome predictions
2024-11-02 16:36:34,064 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 16:36:34,169 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 16:36:34,169 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 16:36:38,871 - INFO - match_outcome predictions: [6.98707821 0.998906   1.19097262 ... 3.96274914 3.1887775  3.96665481]
2024-11-02 16:36:42,633 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-11-02 16:36:42,633 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-11-02 16:36:42,634 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-11-02 16:36:42,634 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-11-02 16:36:42,634 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-11-02 16:36:42,634 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-11-02 16:36:42,634 - INFO - Metrics used in the model:
2024-11-02 16:36:42,634 - INFO - Metric: loss, Metric Type: Mean
2024-11-02 16:36:42,634 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-11-02 16:36:42,634 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-11-02 16:36:42,634 - ERROR - Error occurred while saving the models: Can't set the attribute "metrics", likely because it conflicts with an existing read-only @property of the object. Please choose a different name.
2024-11-02 17:18:27,677 - INFO - Model directory checked/created.
2024-11-02 17:18:34,146 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 17:18:34,186 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 17:18:34,186 - INFO - Data loaded with 5111 rows
2024-11-02 17:18:34,190 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 17:18:34,559 - INFO - new real scores length: 26
2024-11-02 17:18:34,582 - INFO - data_with_error length: 0
2024-11-02 17:18:34,584 - INFO - prediction_df length: 5111
2024-11-02 17:18:34,587 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 17:18:38,253 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 17:18:38,253 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 17:18:38,260 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 17:18:38,264 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 17:18:38,264 - INFO - Data scaling started.
2024-11-02 17:18:38,274 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 17:18:38,281 - INFO - Data scaling completed.
2024-11-02 17:18:38,282 - INFO - Feature Selection started.
2024-11-02 17:21:55,663 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 17:21:55,667 - INFO - Feature selection using RFE completed.
2024-11-02 17:21:55,667 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 17:21:55,668 - INFO - First fit started
2024-11-02 17:29:08,778 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 17:29:11,559 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.00327866905030714, R2: 0.9995010291690181, Stacking Model MAE: 0.024363056958505203, Stacking Model MAPE: 0.8638515624319002%
2024-11-02 17:29:11,560 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.51940850277265%
2024-11-02 17:29:11,560 - INFO - Second fit started
2024-11-02 17:35:58,846 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 17:36:01,625 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0013268654344266216, R2: 0.9997926930621821, Stacking Model MAE: 0.01164227335392367, Stacking Model MAPE: 0.5788314340589853%
2024-11-02 17:36:01,625 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.74121996303143%
2024-11-02 17:36:01,633 - INFO - Start match_outcome predictions
2024-11-02 17:36:01,634 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 17:36:01,748 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 17:36:01,748 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 17:36:06,841 - INFO - match_outcome predictions: [6.99194597 0.99478518 1.10622145 ... 3.78275068 3.25514774 3.81654698]
2024-11-02 17:36:11,105 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-11-02 17:36:11,105 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-11-02 17:36:11,105 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-11-02 17:36:11,105 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-11-02 17:36:11,105 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-11-02 17:36:11,105 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-11-02 17:36:11,105 - INFO - Metrics used in the model:
2024-11-02 17:36:11,105 - INFO - Metric: loss, Metric Type: Mean
2024-11-02 17:36:11,106 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-11-02 17:36:11,106 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-11-02 17:36:11,106 - INFO - Error saving keras model(H5): Can't set the attribute "metrics", likely because it conflicts with an existing read-only @property of the object. Please choose a different name.
2024-11-02 17:36:11,106 - ERROR - Error occurred while saving the models: 'nn'
2024-11-02 17:36:39,017 - INFO - Model directory checked/created.
2024-11-02 17:36:47,162 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 17:36:47,235 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 17:36:47,235 - INFO - Data loaded with 5111 rows
2024-11-02 17:36:47,242 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 17:36:47,705 - INFO - new real scores length: 26
2024-11-02 17:36:47,733 - INFO - data_with_error length: 0
2024-11-02 17:36:47,737 - INFO - prediction_df length: 5111
2024-11-02 17:36:47,740 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 17:37:43,080 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 17:37:43,082 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 17:37:43,087 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 17:37:43,092 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 17:37:43,093 - INFO - Data scaling started.
2024-11-02 17:37:43,105 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 17:37:43,114 - INFO - Data scaling completed.
2024-11-02 17:37:43,115 - INFO - Feature Selection started.
2024-11-02 17:40:50,522 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 17:40:50,525 - INFO - Feature selection using RFE completed.
2024-11-02 17:40:50,526 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 17:40:50,526 - INFO - First fit started
2024-11-02 17:47:23,046 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 17:47:25,597 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0035034448613863877, R2: 0.9994668212109966, Stacking Model MAE: 0.01367444420717994, Stacking Model MAPE: 0.847965887581479%
2024-11-02 17:47:25,597 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.77818853974122%
2024-11-02 17:47:25,597 - INFO - Second fit started
2024-11-02 17:54:00,141 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 17:54:02,698 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0005418761941785845, R2: 0.999915338291603, Stacking Model MAE: 0.01268623715805262, Stacking Model MAPE: 0.47045178415995625%
2024-11-02 17:54:02,698 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.92606284658041%
2024-11-02 17:54:02,702 - INFO - Start match_outcome predictions
2024-11-02 17:54:02,703 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 17:54:02,808 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 17:54:02,808 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 17:54:07,459 - INFO - match_outcome predictions: [7.04572638 0.99965497 1.09365479 ... 3.92547943 3.6511153  3.92575674]
2024-11-02 17:54:11,270 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-11-02 17:54:11,270 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-11-02 17:54:11,270 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-11-02 17:54:11,270 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-11-02 17:54:11,270 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-11-02 17:54:11,270 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-11-02 17:54:11,270 - INFO - Metrics used in the model:
2024-11-02 17:54:11,270 - INFO - Metric: loss, Metric Type: Mean
2024-11-02 17:54:11,270 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-11-02 17:54:11,270 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-11-02 17:54:11,271 - ERROR - Error saving Keras model: Can't set the attribute "metrics", likely because it conflicts with an existing read-only @property of the object. Please choose a different name.
2024-11-02 17:54:12,195 - INFO - Assets written to: C:\Users\T480\Documents\Betting\Chatgpt\tempdir\tmp5dd4f6o2\tmpg92i1fzw\assets
2024-11-02 17:54:12,276 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-11-02 18:03:26,126 - INFO - Model directory checked/created.
2024-11-02 18:03:32,564 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 18:03:32,613 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 18:03:32,613 - INFO - Data loaded with 5111 rows
2024-11-02 18:03:32,618 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 18:03:32,989 - INFO - new real scores length: 26
2024-11-02 18:03:33,012 - INFO - data_with_error length: 0
2024-11-02 18:03:33,014 - INFO - prediction_df length: 5111
2024-11-02 18:03:33,016 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 18:03:35,043 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 18:03:35,044 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 18:03:35,048 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 18:03:35,053 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 18:03:35,053 - INFO - Data scaling started.
2024-11-02 18:03:35,063 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 18:03:35,071 - INFO - Data scaling completed.
2024-11-02 18:03:35,071 - INFO - Feature Selection started.
2024-11-02 18:06:34,992 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 18:06:34,996 - INFO - Feature selection using RFE completed.
2024-11-02 18:06:34,997 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 18:06:34,997 - INFO - First fit started
2024-11-02 18:10:13,630 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0004s vs `on_predict_batch_end` time: 0.0005s). Check your callbacks.
2024-11-02 18:13:13,393 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 18:13:15,888 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0016739741968406672, R2: 0.9997452428765381, Stacking Model MAE: 0.014596002475095998, Stacking Model MAPE: 0.6581552520363297%
2024-11-02 18:13:15,888 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.63031423290202%
2024-11-02 18:13:15,888 - INFO - Second fit started
2024-11-02 18:17:16,681 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0004s vs `on_predict_batch_end` time: 0.0005s). Check your callbacks.
2024-11-02 18:19:33,565 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 18:19:36,154 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0018839817848278827, R2: 0.9997056502606942, Stacking Model MAE: 0.010727678256228975, Stacking Model MAPE: 0.5838115833200689%
2024-11-02 18:19:36,154 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.51940850277265%
2024-11-02 18:19:36,157 - INFO - Start match_outcome predictions
2024-11-02 18:19:36,158 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 18:19:36,260 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 18:19:36,260 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 18:19:40,807 - INFO - match_outcome predictions: [6.94535704 1.04902814 1.30955213 ... 3.77519052 3.11951786 3.77476644]
2024-11-02 18:19:44,695 - INFO - Layer Name: dense_24, Layer Type: Dense
2024-11-02 18:19:44,695 - INFO - Layer Name: dropout_12, Layer Type: Dropout
2024-11-02 18:19:44,695 - INFO - Layer Name: dense_25, Layer Type: Dense
2024-11-02 18:19:44,695 - INFO - Layer Name: dropout_13, Layer Type: Dropout
2024-11-02 18:19:44,695 - INFO - Layer Name: dense_26, Layer Type: Dense
2024-11-02 18:19:44,695 - INFO - Layer Name: dense_27, Layer Type: Dense
2024-11-02 18:19:44,695 - INFO - Metrics used in the model:
2024-11-02 18:19:44,696 - INFO - Metric: loss, Metric Type: Mean
2024-11-02 18:19:44,696 - INFO - Metric: mae, Metric Type: MeanMetricWrapper
2024-11-02 18:19:44,696 - INFO - Metric: within_range_metric, Metric Type: MeanMetricWrapper
2024-11-02 18:19:44,696 - ERROR - Error saving Keras model: Can't set the attribute "metrics", likely because it conflicts with an existing read-only @property of the object. Please choose a different name.
2024-11-02 18:19:44,746 - INFO - Keras model saved successfully at ./models/nn_regressor_match_outcome_stacked_2fit.h5
2024-11-02 18:19:45,573 - INFO - Assets written to: C:\Users\T480\Documents\Betting\Chatgpt\tempdir\tmp9ifn09m5\tmp_yg7lvvb\assets
2024-11-02 18:19:45,639 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_match_outcome.pkl
2024-11-02 18:41:32,211 - INFO - Model directory checked/created.
2024-11-02 18:41:38,476 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 18:41:38,518 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 18:41:38,518 - INFO - Data loaded with 5111 rows
2024-11-02 18:41:38,522 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 18:41:38,897 - INFO - new real scores length: 26
2024-11-02 18:41:38,920 - INFO - data_with_error length: 0
2024-11-02 18:41:38,922 - INFO - prediction_df length: 5111
2024-11-02 18:41:38,925 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 18:41:40,930 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 18:41:40,931 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 18:41:40,936 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 18:41:40,940 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 18:41:40,940 - INFO - Data scaling started.
2024-11-02 18:41:40,951 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 18:41:40,958 - INFO - Data scaling completed.
2024-11-02 18:41:40,958 - INFO - Feature Selection started.
2024-11-02 18:44:42,710 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 18:44:42,714 - INFO - Feature selection using RFE completed.
2024-11-02 18:44:42,714 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 18:44:42,715 - INFO - First fit started
2024-11-02 18:51:21,923 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0005s vs `on_predict_batch_end` time: 0.0005s). Check your callbacks.
2024-11-02 18:51:23,519 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 18:51:26,127 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0025883835047240174, R2: 0.9996060816604435, Stacking Model MAE: 0.010279161672068793, Stacking Model MAPE: 0.3712009665673482%
2024-11-02 18:51:26,127 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.85212569316081%
2024-11-02 18:51:26,127 - INFO - Second fit started
2024-11-02 18:57:38,664 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 18:57:41,196 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0012164130075193863, R2: 0.9998099499397844, Stacking Model MAE: 0.010779929916632635, Stacking Model MAPE: 0.46328771416015924%
2024-11-02 18:57:41,197 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-11-02 18:57:41,201 - INFO - Start match_outcome predictions
2024-11-02 18:57:41,201 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 18:57:41,307 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 18:57:41,307 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 18:57:45,960 - INFO - match_outcome predictions: [6.98930598 1.03536154 1.1876403  ... 3.86725942 3.46270126 3.8663561 ]
2024-11-02 18:57:50,569 - INFO - Assets written to: C:\Users\T480\Documents\Betting\Chatgpt\tempdir\tmp0_rip8ku\tmp8yiu6716\assets
2024-11-02 19:21:13,111 - INFO - Model directory checked/created.
2024-11-02 19:21:18,945 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:21:19,065 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:21:19,065 - INFO - Data loaded with 5111 rows
2024-11-02 19:21:19,080 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:21:19,456 - INFO - new real scores length: 26
2024-11-02 19:21:19,597 - INFO - data_with_error length: 0
2024-11-02 19:21:19,607 - INFO - prediction_df length: 5111
2024-11-02 19:21:19,612 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:21:21,611 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 19:21:21,611 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:21:21,611 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:21:21,628 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:21:21,628 - INFO - Data scaling started.
2024-11-02 19:21:21,659 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 19:21:21,671 - INFO - Data scaling completed.
2024-11-02 19:21:21,672 - INFO - Feature Selection started.
2024-11-02 19:23:59,962 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 19:23:59,962 - INFO - Feature selection using RFE completed.
2024-11-02 19:23:59,962 - INFO - Selected Features: ['running_id', 'away_encoded', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_poisson_xG']
2024-11-02 19:23:59,962 - INFO - First fit started
2024-11-02 19:24:18,078 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_train_batch_end` time: 0.0005s). Check your callbacks.
2024-11-02 19:28:01,368 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0012s vs `on_predict_batch_end` time: 0.0014s). Check your callbacks.
2024-11-02 19:29:36,957 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 19:29:39,744 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0025287854813991367, R2: 0.9996151517052596, Stacking Model MAE: 0.022295127615215335, Stacking Model MAPE: 0.743804730389985%
2024-11-02 19:29:39,746 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.77818853974122%
2024-11-02 19:29:39,746 - INFO - Second fit started
2024-11-02 19:36:35,084 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 19:36:37,969 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0011534037146850623, R2: 0.9998197943921401, Stacking Model MAE: 0.0209846658571263, Stacking Model MAPE: 0.9523405742942384%
2024-11-02 19:36:37,971 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-11-02 19:36:37,974 - INFO - Start match_outcome predictions
2024-11-02 19:36:37,976 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 19:36:38,098 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 19:36:38,098 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:36:43,399 - INFO - match_outcome predictions: [7.05148141 0.98540438 1.09851176 ... 3.85059079 3.4610572  3.85055443]
2024-11-02 19:36:57,604 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpei7kniv2\tmpoq5a89nn\assets
2024-11-02 19:45:10,965 - INFO - Model directory checked/created.
2024-11-02 19:45:17,050 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:45:17,149 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:45:17,165 - INFO - Data loaded with 5111 rows
2024-11-02 19:45:17,165 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:45:17,661 - INFO - new real scores length: 274
2024-11-02 19:46:29,803 - INFO - Model directory checked/created.
2024-11-02 19:46:34,720 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:46:34,821 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:46:34,821 - INFO - Data loaded with 5111 rows
2024-11-02 19:46:34,834 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:46:35,347 - INFO - new real scores length: 274
2024-11-02 19:48:09,166 - INFO - Model directory checked/created.
2024-11-02 19:48:14,016 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:48:14,116 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:48:14,116 - INFO - Data loaded with 5111 rows
2024-11-02 19:48:14,133 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:48:14,565 - INFO - new real scores length: 274
2024-11-02 19:48:14,731 - INFO - new_scores_df:      Unnamed: 0  running_id        Date            league         Home  ... home_goals_prediction away_goals_prediction match_outcome_prediction  real_home_goals  real_away_goals
0             0        6952  2024-10-23  Segunda-Division      Eldense  ...              0.896240              0.135258                 0.996787                2                3
1             1        6953  2024-10-23  Segunda-Division        Eibar  ...              0.967459              0.114418                 0.999543                1                0
2             2        6954  2024-10-23  Segunda-Division    Cartagena  ...             -0.037521              0.113598                 7.022575                0                0
3             3        6955  2024-10-23  Segunda-Division  Racing Sant  ...              0.976169             -0.012663                 0.997435                2                0
4             4       14056  2024-10-23         J1-League   Urawa Reds  ...             -0.126782             -0.008816                 7.029361                1                0
..          ...         ...         ...               ...          ...  ...                   ...                   ...                      ...              ...              ...
269         269       27400  2024-10-29           Ligue 2     Guingamp  ...              2.785097              0.729451                 0.990412                1                0
270         270       27401  2024-10-29           Ligue 2       Troyes  ...              2.099814              0.510333                 0.993265                3                0
271         271       27402  2024-10-29           Ligue 2    Martigues  ...              0.877894              1.189081                 3.993308                0                3
272         272       27403  2024-10-29           Ligue 2  Stade Laval  ...              0.941936              0.072347                 0.991473                1                2
273         273       27404  2024-10-29           Ligue 2       Bastia  ...              2.018050              0.991169                 3.870336                2                2

[274 rows x 17 columns]
2024-11-02 19:50:15,255 - INFO - Model directory checked/created.
2024-11-02 19:50:20,117 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:50:20,225 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:50:20,225 - INFO - Data loaded with 5111 rows
2024-11-02 19:50:20,235 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:50:20,645 - INFO - new real scores length: 274
2024-11-02 19:50:20,803 - INFO - new_scores_df:      Unnamed: 0  running_id        Date            league         Home  ... home_goals_prediction away_goals_prediction match_outcome_prediction  real_home_goals  real_away_goals
0             0        6952  2024-10-23  Segunda-Division      Eldense  ...              0.896240              0.135258                 0.996787                2                3
1             1        6953  2024-10-23  Segunda-Division        Eibar  ...              0.967459              0.114418                 0.999543                1                0
2             2        6954  2024-10-23  Segunda-Division    Cartagena  ...             -0.037521              0.113598                 7.022575                0                0
3             3        6955  2024-10-23  Segunda-Division  Racing Sant  ...              0.976169             -0.012663                 0.997435                2                0
4             4       14056  2024-10-23         J1-League   Urawa Reds  ...             -0.126782             -0.008816                 7.029361                1                0
..          ...         ...         ...               ...          ...  ...                   ...                   ...                      ...              ...              ...
269         269       27400  2024-10-29           Ligue 2     Guingamp  ...              2.785097              0.729451                 0.990412                1                0
270         270       27401  2024-10-29           Ligue 2       Troyes  ...              2.099814              0.510333                 0.993265                3                0
271         271       27402  2024-10-29           Ligue 2    Martigues  ...              0.877894              1.189081                 3.993308                0                3
272         272       27403  2024-10-29           Ligue 2  Stade Laval  ...              0.941936              0.072347                 0.991473                1                2
273         273       27404  2024-10-29           Ligue 2       Bastia  ...              2.018050              0.991169                 3.870336                2                2

[274 rows x 17 columns]
2024-11-02 19:50:56,654 - INFO - Model directory checked/created.
2024-11-02 19:51:01,621 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:51:01,699 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:51:01,716 - INFO - Data loaded with 5111 rows
2024-11-02 19:51:01,716 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:51:02,119 - INFO - new real scores length: 274
2024-11-02 19:51:02,266 - INFO - new_scores_df:      Unnamed: 0  running_id        Date            league         Home  ... home_goals_prediction away_goals_prediction match_outcome_prediction  real_home_goals  real_away_goals
0             0        6952  2024-10-23  Segunda-Division      Eldense  ...              0.896240              0.135258                 0.996787                2                3
1             1        6953  2024-10-23  Segunda-Division        Eibar  ...              0.967459              0.114418                 0.999543                1                0
2             2        6954  2024-10-23  Segunda-Division    Cartagena  ...             -0.037521              0.113598                 7.022575                0                0
3             3        6955  2024-10-23  Segunda-Division  Racing Sant  ...              0.976169             -0.012663                 0.997435                2                0
4             4       14056  2024-10-23         J1-League   Urawa Reds  ...             -0.126782             -0.008816                 7.029361                1                0
..          ...         ...         ...               ...          ...  ...                   ...                   ...                      ...              ...              ...
269         269       27400  2024-10-29           Ligue 2     Guingamp  ...              2.785097              0.729451                 0.990412                1                0
270         270       27401  2024-10-29           Ligue 2       Troyes  ...              2.099814              0.510333                 0.993265                3                0
271         271       27402  2024-10-29           Ligue 2    Martigues  ...              0.877894              1.189081                 3.993308                0                3
272         272       27403  2024-10-29           Ligue 2  Stade Laval  ...              0.941936              0.072347                 0.991473                1                2
273         273       27404  2024-10-29           Ligue 2       Bastia  ...              2.018050              0.991169                 3.870336                2                2

[274 rows x 17 columns]
2024-11-02 19:51:36,612 - INFO - Model directory checked/created.
2024-11-02 19:51:41,433 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:51:41,532 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:51:41,532 - INFO - Data loaded with 5111 rows
2024-11-02 19:51:41,550 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:51:41,949 - INFO - new real scores length: 274
2024-11-02 19:51:42,108 - INFO - new_scores_df:      Unnamed: 0  running_id        Date            league         Home  ... home_goals_prediction away_goals_prediction match_outcome_prediction  real_home_goals  real_away_goals
0             0        6952  2024-10-23  Segunda-Division      Eldense  ...              0.896240              0.135258                 0.996787                2                3
1             1        6953  2024-10-23  Segunda-Division        Eibar  ...              0.967459              0.114418                 0.999543                1                0
2             2        6954  2024-10-23  Segunda-Division    Cartagena  ...             -0.037521              0.113598                 7.022575                0                0
3             3        6955  2024-10-23  Segunda-Division  Racing Sant  ...              0.976169             -0.012663                 0.997435                2                0
4             4       14056  2024-10-23         J1-League   Urawa Reds  ...             -0.126782             -0.008816                 7.029361                1                0
..          ...         ...         ...               ...          ...  ...                   ...                   ...                      ...              ...              ...
269         269       27400  2024-10-29           Ligue 2     Guingamp  ...              2.785097              0.729451                 0.990412                1                0
270         270       27401  2024-10-29           Ligue 2       Troyes  ...              2.099814              0.510333                 0.993265                3                0
271         271       27402  2024-10-29           Ligue 2    Martigues  ...              0.877894              1.189081                 3.993308                0                3
272         272       27403  2024-10-29           Ligue 2  Stade Laval  ...              0.941936              0.072347                 0.991473                1                2
273         273       27404  2024-10-29           Ligue 2       Bastia  ...              2.018050              0.991169                 3.870336                2                2

[274 rows x 17 columns]
2024-11-02 19:52:05,687 - INFO - Model directory checked/created.
2024-11-02 19:52:10,450 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:52:10,549 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:52:10,549 - INFO - Data loaded with 5111 rows
2024-11-02 19:52:10,566 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:52:10,985 - INFO - new real scores length: 274
2024-11-02 19:52:11,133 - INFO - new_scores_df:      Unnamed: 0  running_id        Date            league         Home  ... home_goals_prediction away_goals_prediction match_outcome_prediction  real_home_goals  real_away_goals
0             0        6952  2024-10-23  Segunda-Division      Eldense  ...              0.896240              0.135258                 0.996787                2                3
1             1        6953  2024-10-23  Segunda-Division        Eibar  ...              0.967459              0.114418                 0.999543                1                0
2             2        6954  2024-10-23  Segunda-Division    Cartagena  ...             -0.037521              0.113598                 7.022575                0                0
3             3        6955  2024-10-23  Segunda-Division  Racing Sant  ...              0.976169             -0.012663                 0.997435                2                0
4             4       14056  2024-10-23         J1-League   Urawa Reds  ...             -0.126782             -0.008816                 7.029361                1                0
..          ...         ...         ...               ...          ...  ...                   ...                   ...                      ...              ...              ...
269         269       27400  2024-10-29           Ligue 2     Guingamp  ...              2.785097              0.729451                 0.990412                1                0
270         270       27401  2024-10-29           Ligue 2       Troyes  ...              2.099814              0.510333                 0.993265                3                0
271         271       27402  2024-10-29           Ligue 2    Martigues  ...              0.877894              1.189081                 3.993308                0                3
272         272       27403  2024-10-29           Ligue 2  Stade Laval  ...              0.941936              0.072347                 0.991473                1                2
273         273       27404  2024-10-29           Ligue 2       Bastia  ...              2.018050              0.991169                 3.870336                2                2

[274 rows x 17 columns]
2024-11-02 19:52:11,150 - INFO - data_with_error length: 0
2024-11-02 19:52:11,150 - INFO - prediction_df length: 5111
2024-11-02 19:52:11,150 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:52:12,983 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 19:52:12,983 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:52:12,983 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:52:12,998 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:52:13,015 - INFO - Data scaling started.
2024-11-02 19:52:13,033 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 19:52:13,033 - INFO - Data scaling completed.
2024-11-02 19:52:13,033 - INFO - Feature Selection started.
2024-11-02 19:54:45,400 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 19:54:45,400 - INFO - Feature selection using RFE completed.
2024-11-02 19:54:45,400 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 19:54:45,400 - INFO - First fit started
2024-11-02 19:56:53,284 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 19:58:44,168 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0004s vs `on_predict_batch_end` time: 0.0025s). Check your callbacks.
2024-11-02 19:59:11,967 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 19:59:13,834 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0032138101442474383, R2: 0.9995108998518337, Stacking Model MAE: 0.011277928413933679, Stacking Model MAPE: 0.4482883247071544%
2024-11-02 19:59:13,834 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.77818853974122%
2024-11-02 19:59:13,849 - INFO - Second fit started
2024-11-02 20:01:08,053 - WARNING - Callback method `on_train_batch_begin` is slow compared to the batch time (batch time: 0.0004s vs `on_train_batch_begin` time: 0.0024s). Check your callbacks.
2024-11-02 20:03:45,835 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 20:03:47,842 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0005112310945360495, R2: 0.9999201262238236, Stacking Model MAE: 0.013648503186812742, Stacking Model MAPE: 0.42665775553617175%
2024-11-02 20:03:47,842 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-11-02 20:03:47,851 - INFO - Start match_outcome predictions
2024-11-02 20:03:47,853 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:03:47,984 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 20:03:47,986 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:03:51,604 - INFO - match_outcome predictions: [6.98473675 1.00706437 1.07885389 ... 3.92624424 3.66400457 3.92534899]
2024-11-02 20:04:07,495 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpmppe7tcy\tmp2nm22376\assets
2024-11-02 20:27:11,406 - INFO - Model directory checked/created.
2024-11-02 20:27:18,264 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:27:18,393 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:27:18,396 - INFO - Data loaded with 5111 rows
2024-11-02 20:27:18,404 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:27:19,073 - INFO - new real scores length: 274
2024-11-02 20:27:19,291 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:27:19,291 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:27:19,291 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:27:19,307 - INFO - data_with_error length: 267
2024-11-02 20:27:19,307 - INFO - prediction_df length: 5111
2024-11-02 20:27:19,307 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:27:21,606 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 20:27:21,608 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:27:21,615 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:27:21,624 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:27:21,626 - INFO - Data scaling started.
2024-11-02 20:27:21,673 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 20:27:21,682 - INFO - Data scaling completed.
2024-11-02 20:27:21,684 - INFO - Feature Selection started.
2024-11-02 20:27:56,653 - INFO - Model directory checked/created.
2024-11-02 20:28:03,760 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:28:03,865 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:28:03,868 - INFO - Data loaded with 5111 rows
2024-11-02 20:28:03,881 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:28:04,425 - INFO - new real scores length: 274
2024-11-02 20:28:04,617 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:28:04,620 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:28:04,622 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:28:04,623 - INFO - data_with_error length: 267
2024-11-02 20:28:04,631 - INFO - prediction_df length: 5111
2024-11-02 20:28:04,635 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:28:06,996 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 20:28:06,996 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:28:07,008 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:28:07,008 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:28:07,008 - INFO - Data scaling started.
2024-11-02 20:28:07,041 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 20:28:07,062 - INFO - Data scaling completed.
2024-11-02 20:28:07,062 - INFO - Feature Selection started.
2024-11-02 20:30:44,356 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 20:30:44,358 - INFO - Feature selection using RFE completed.
2024-11-02 20:30:44,358 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 20:30:44,358 - INFO - First fit started
2024-11-02 20:31:38,094 - INFO - Model directory checked/created.
2024-11-02 20:31:43,808 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:31:43,908 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:31:43,908 - INFO - Data loaded with 5111 rows
2024-11-02 20:31:43,922 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:31:44,423 - INFO - new real scores length: 274
2024-11-02 20:31:44,595 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:31:44,597 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:31:44,599 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:31:44,603 - INFO - data_with error columns: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'home_goals_prediction_rounded', 'away_goals_prediction_rounded',
       'real_home_goals', 'real_away_goals', 'home_error', 'away_error'],
      dtype='object')
2024-11-02 20:31:44,607 - INFO - data_with_error length: 0
2024-11-02 20:31:44,612 - INFO - prediction_df length: 5111
2024-11-02 20:31:44,643 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:31:46,592 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 20:31:46,595 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:31:46,600 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:31:46,607 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:31:46,609 - INFO - Data scaling started.
2024-11-02 20:31:46,640 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 20:31:46,653 - INFO - Data scaling completed.
2024-11-02 20:31:46,655 - INFO - Feature Selection started.
2024-11-02 20:34:19,641 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 20:34:19,659 - INFO - Feature selection using RFE completed.
2024-11-02 20:34:19,660 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 20:34:19,661 - INFO - First fit started
2024-11-02 20:38:43,342 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 20:38:45,397 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.00038693241831258405, R2: 0.9999411139131956, Stacking Model MAE: 0.00800866135797323, Stacking Model MAPE: 0.42307650815894615%
2024-11-02 20:38:45,397 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-11-02 20:38:45,397 - INFO - Second fit started
2024-11-02 20:43:39,355 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 20:43:41,214 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.002805505822931528, R2: 0.9995616730935241, Stacking Model MAE: 0.015711923742455308, Stacking Model MAPE: 0.8905687192134973%
2024-11-02 20:43:41,214 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.33456561922365%
2024-11-02 20:43:41,225 - INFO - Start match_outcome predictions
2024-11-02 20:43:41,227 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:43:41,342 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 20:43:41,342 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:43:44,599 - INFO - match_outcome predictions: [7.05674072 1.04256239 1.35024154 ... 3.71406661 2.89674553 3.7857992 ]
2024-11-02 20:43:55,775 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp2azbwmfo\tmpx8gr3l80\assets
2024-11-02 20:53:00,908 - INFO - Model directory checked/created.
2024-11-02 20:53:05,815 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:53:05,903 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:53:05,906 - INFO - Data loaded with 5111 rows
2024-11-02 20:53:05,910 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:53:06,367 - INFO - new real scores length: 274
2024-11-02 20:53:06,532 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:53:06,532 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:53:06,546 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:53:06,548 - INFO - running_id                                     0
season_encoded                               267
league_encoded                               267
home_encoded                                 267
away_encoded                                 267
venue_encoded                                267
home_league_position                         267
away_league_position                         267
Home_points_cum                              267
Away_points_cum                              267
Home_team_matches                            267
Away_team_matches                            267
Home_goal_difference_cum                     267
Away_goal_difference_cum                     267
Home_draws                                   267
Away_draws                                   267
home_draw_rate                               267
away_draw_rate                               267
home_average_points                          267
away_average_points                          267
home_win_rate                                267
away_win_rate                                267
Home_wins                                    267
Away_wins                                    267
home_xG_rolling_avg                          267
away_xG_rolling_avg                          267
home_shots_on_target_accuracy_rolling_avg    267
away_shots_on_target_accuracy_rolling_avg    267
home_shots_on_target_rolling_avg             267
away_shots_on_target_rolling_avg             267
home_saves_accuracy_rolling_avg              267
away_saves_accuracy_rolling_avg              267
home_goals_rolling_avg                       267
away_goals_rolling_avg                       267
away_goal_difference_rolling_avg             267
home_goal_difference_rolling_avg             267
referee_foul_rate                            267
referee_encoded                              267
Home_saves_mean                              267
Away_saves_mean                              267
Home_fouls_mean                              267
Away_fouls_mean                              267
Home_possession_mean                         267
away_possession_mean                         267
Home_shot_on_target_mean                     267
away_shot_on_target_mean                     267
home_team_elo                                267
away_team_elo                                267
home_poisson_xG                              267
away_poisson_xG                              267
home_goals_prediction_rounded                  0
away_goals_prediction_rounded                  0
real_home_goals                                0
real_away_goals                                0
home_error                                     0
away_error                                     0
dtype: int64
2024-11-02 20:53:06,548 - INFO - data_with_error length: 0
2024-11-02 20:53:06,548 - INFO - prediction_df length: 5111
2024-11-02 20:53:06,548 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:53:08,349 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 20:53:08,349 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:53:08,349 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:53:08,364 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:53:08,365 - INFO - Data scaling started.
2024-11-02 20:53:08,382 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 20:53:08,382 - INFO - Data scaling completed.
2024-11-02 20:53:08,397 - INFO - Feature Selection started.
2024-11-02 20:55:26,198 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 20:55:26,198 - INFO - Feature selection using RFE completed.
2024-11-02 20:55:26,198 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 20:55:26,198 - INFO - First fit started
2024-11-02 20:59:30,899 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 20:59:32,599 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0022267278365631906, R2: 0.9996611209542858, Stacking Model MAE: 0.011275581757261973, Stacking Model MAPE: 0.44502359186744617%
2024-11-02 20:59:32,616 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.92606284658041%
2024-11-02 20:59:32,618 - INFO - Second fit started
2024-11-02 21:03:43,795 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 21:03:45,473 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0031379544093999403, R2: 0.9995097319571778, Stacking Model MAE: 0.0369528102417653, Stacking Model MAPE: 0.9029548443113454%
2024-11-02 21:03:45,482 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.85212569316081%
2024-11-02 21:03:45,486 - INFO - Start match_outcome predictions
2024-11-02 21:03:45,488 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 21:03:45,623 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 21:03:45,626 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:03:48,718 - INFO - match_outcome predictions: [6.92203501 0.99186772 1.09422534 ... 3.93143866 3.52737986 3.92783761]
2024-11-02 21:04:01,533 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpt7a3qbm_\tmp3n977tws\assets
2024-11-02 21:04:38,566 - INFO - Model directory checked/created.
2024-11-02 21:04:43,746 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:04:43,851 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:04:43,851 - INFO - Data loaded with 5111 rows
2024-11-02 21:04:43,851 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:04:44,301 - INFO - new real scores length: 274
2024-11-02 21:04:44,483 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:04:44,483 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:04:44,499 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:05:09,584 - INFO - Model directory checked/created.
2024-11-02 21:05:14,756 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:05:14,837 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:05:14,840 - INFO - Data loaded with 5111 rows
2024-11-02 21:05:14,844 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:05:15,288 - INFO - new real scores length: 274
2024-11-02 21:05:15,482 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:05:15,484 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:05:15,486 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:05:15,489 - INFO - running_id                                    0
Date                                          0
season_encoded                                0
league_encoded                                0
home_encoded                                  0
away_encoded                                  0
venue_encoded                                 0
home_league_position                          0
away_league_position                          0
Home_points_cum                               0
Away_points_cum                               0
Home_team_matches                             0
Away_team_matches                             0
Home_goal_difference_cum                      0
Away_goal_difference_cum                      0
Home_draws                                    0
Away_draws                                    0
home_draw_rate                                0
away_draw_rate                                0
home_average_points                           0
away_average_points                           0
home_win_rate                                 0
away_win_rate                                 0
Home_wins                                     0
Away_wins                                     0
home_xG_rolling_avg                           0
away_xG_rolling_avg                           0
home_shots_on_target_accuracy_rolling_avg     0
away_shots_on_target_accuracy_rolling_avg     0
home_shots_on_target_rolling_avg              0
away_shots_on_target_rolling_avg              0
home_saves_accuracy_rolling_avg               0
away_saves_accuracy_rolling_avg               0
home_goals_rolling_avg                        0
away_goals_rolling_avg                        0
home_goal_difference_rolling_avg              0
away_goal_difference_rolling_avg              0
referee_foul_rate                            30
referee_encoded                               0
Home_saves_mean                              29
Away_saves_mean                              22
Home_fouls_mean                              33
Away_fouls_mean                              31
Home_possession_mean                         31
away_possession_mean                         30
Home_shot_on_target_mean                     29
away_shot_on_target_mean                     22
home_team_elo                                 0
away_team_elo                                 0
home_poisson_xG                               0
away_poisson_xG                               0
home_goals_prediction_rounded                 0
away_goals_prediction_rounded                 0
real_home_goals                               0
real_away_goals                               0
home_error                                    0
away_error                                    0
dtype: int64
2024-11-02 21:05:15,492 - INFO - data_with_error length: 234
2024-11-02 21:05:15,494 - INFO - prediction_df length: 5111
2024-11-02 21:05:15,498 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:05:17,416 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:05:17,418 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:05:17,424 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:05:17,430 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:05:17,432 - INFO - Data scaling started.
2024-11-02 21:05:17,457 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:05:17,466 - INFO - Data scaling completed.
2024-11-02 21:05:17,468 - INFO - Feature Selection started.
2024-11-02 21:07:42,851 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 21:07:42,851 - INFO - Feature selection using RFE completed.
2024-11-02 21:07:42,851 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_saves_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 21:07:42,851 - INFO - First fit started
2024-11-02 21:12:05,433 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 21:12:07,202 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 21:12:07,285 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.006422520208550362, R2: 0.9990225758695717, Stacking Model MAE: 0.021964940228617804, Stacking Model MAPE: 0.9345407836636251%
2024-11-02 21:12:07,288 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.51940850277265%
2024-11-02 21:12:07,289 - INFO - Second fit started
2024-11-02 21:16:48,637 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 21:16:50,630 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0017842798475680428, R2: 0.9997212275021926, Stacking Model MAE: 0.020102605830473838, Stacking Model MAPE: 0.7561946985716836%
2024-11-02 21:16:50,631 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.66728280961183%
2024-11-02 21:16:50,635 - INFO - Start match_outcome predictions
2024-11-02 21:16:50,636 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 21:16:50,636 - ERROR - Error occurred while making prediction: 'outcome_error'
2024-11-02 21:16:52,194 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpsb86ftcz\tmp7q0meruw\assets
2024-11-02 21:22:23,373 - INFO - Model directory checked/created.
2024-11-02 21:22:32,464 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:22:32,572 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:22:32,588 - INFO - Data loaded with 5111 rows
2024-11-02 21:22:32,601 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:22:33,390 - INFO - new real scores length: 274
2024-11-02 21:22:33,622 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:22:33,635 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:22:33,638 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:22:33,649 - INFO - running_id                                    0
Date                                          0
season_encoded                                0
league_encoded                                0
home_encoded                                  0
away_encoded                                  0
venue_encoded                                 0
home_league_position                          0
away_league_position                          0
Home_points_cum                               0
Away_points_cum                               0
Home_team_matches                             0
Away_team_matches                             0
Home_goal_difference_cum                      0
Away_goal_difference_cum                      0
Home_draws                                    0
Away_draws                                    0
home_draw_rate                                0
away_draw_rate                                0
home_average_points                           0
away_average_points                           0
home_win_rate                                 0
away_win_rate                                 0
Home_wins                                     0
Away_wins                                     0
home_xG_rolling_avg                           0
away_xG_rolling_avg                           0
home_shots_on_target_accuracy_rolling_avg     0
away_shots_on_target_accuracy_rolling_avg     0
home_shots_on_target_rolling_avg              0
away_shots_on_target_rolling_avg              0
home_saves_accuracy_rolling_avg               0
away_saves_accuracy_rolling_avg               0
home_goals_rolling_avg                        0
away_goals_rolling_avg                        0
home_goal_difference_rolling_avg              0
away_goal_difference_rolling_avg              0
referee_foul_rate                            30
referee_encoded                               0
Home_saves_mean                              29
Away_saves_mean                              22
Home_fouls_mean                              33
Away_fouls_mean                              31
Home_possession_mean                         31
away_possession_mean                         30
Home_shot_on_target_mean                     29
away_shot_on_target_mean                     22
home_team_elo                                 0
away_team_elo                                 0
home_poisson_xG                               0
away_poisson_xG                               0
home_goals_prediction_rounded                 0
away_goals_prediction_rounded                 0
real_home_goals                               0
real_away_goals                               0
home_error                                    0
away_error                                    0
dtype: int64
2024-11-02 21:22:33,655 - INFO - data_with_error length: 234
2024-11-02 21:22:33,659 - INFO - prediction_df length: 5111
2024-11-02 21:22:33,659 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:22:36,993 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:22:36,993 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:22:37,009 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:22:37,017 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:22:37,019 - INFO - Data scaling started.
2024-11-02 21:22:37,048 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:22:37,061 - INFO - Data scaling completed.
2024-11-02 21:22:37,064 - INFO - Feature Selection started.
2024-11-02 21:23:19,047 - INFO - Model directory checked/created.
2024-11-02 21:23:25,853 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:23:25,979 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:23:25,981 - INFO - Data loaded with 5111 rows
2024-11-02 21:23:25,987 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:23:26,562 - INFO - new real scores length: 274
2024-11-02 21:23:26,743 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:23:26,745 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:23:26,747 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:23:26,753 - INFO - running_id                                    0
Date                                          0
season_encoded                                0
league_encoded                                0
home_encoded                                  0
away_encoded                                  0
venue_encoded                                 0
home_league_position                          0
away_league_position                          0
Home_points_cum                               0
Away_points_cum                               0
Home_team_matches                             0
Away_team_matches                             0
Home_goal_difference_cum                      0
Away_goal_difference_cum                      0
Home_draws                                    0
Away_draws                                    0
home_draw_rate                                0
away_draw_rate                                0
home_average_points                           0
away_average_points                           0
home_win_rate                                 0
away_win_rate                                 0
Home_wins                                     0
Away_wins                                     0
home_xG_rolling_avg                           0
away_xG_rolling_avg                           0
home_shots_on_target_accuracy_rolling_avg     0
away_shots_on_target_accuracy_rolling_avg     0
home_shots_on_target_rolling_avg              0
away_shots_on_target_rolling_avg              0
home_saves_accuracy_rolling_avg               0
away_saves_accuracy_rolling_avg               0
home_goals_rolling_avg                        0
away_goals_rolling_avg                        0
home_goal_difference_rolling_avg              0
away_goal_difference_rolling_avg              0
referee_foul_rate                            30
referee_encoded                               0
Home_saves_mean                              29
Away_saves_mean                              22
Home_fouls_mean                              33
Away_fouls_mean                              31
Home_possession_mean                         31
away_possession_mean                         30
Home_shot_on_target_mean                     29
away_shot_on_target_mean                     22
home_team_elo                                 0
away_team_elo                                 0
home_poisson_xG                               0
away_poisson_xG                               0
home_goals_prediction_rounded                 0
away_goals_prediction_rounded                 0
real_home_goals                               0
real_away_goals                               0
home_error                                    0
away_error                                    0
dtype: int64
2024-11-02 21:23:26,754 - INFO - data_with_error length: 234
2024-11-02 21:23:26,754 - INFO - prediction_df length: 5111
2024-11-02 21:23:26,754 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:23:29,009 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:23:29,009 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:23:29,020 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:23:29,020 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:23:29,020 - INFO - Data scaling started.
2024-11-02 21:23:29,057 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:23:29,059 - INFO - Data scaling completed.
2024-11-02 21:23:29,068 - INFO - Feature Selection started.
2024-11-02 21:25:55,153 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 21:25:55,153 - INFO - Feature selection using RFE completed.
2024-11-02 21:25:55,153 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 21:25:55,153 - INFO - First fit started
2024-11-02 21:29:00,804 - WARNING - Callback method `on_train_batch_begin` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_begin` time: 0.0002s). Check your callbacks.
2024-11-02 21:29:55,489 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 21:29:57,315 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.004394537364935097, R2: 0.9993312085095757, Stacking Model MAE: 0.01991470232427927, Stacking Model MAPE: 0.7937082341627612%
2024-11-02 21:29:57,317 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.37153419593345%
2024-11-02 21:29:57,318 - INFO - Second fit started
2024-11-02 21:34:11,473 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 21:34:13,188 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0014174760639523078, R2: 0.9997785362293539, Stacking Model MAE: 0.019191863514151752, Stacking Model MAPE: 0.7302532954682767%
2024-11-02 21:34:13,190 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.74121996303143%
2024-11-02 21:34:13,197 - INFO - Start match_outcome predictions
2024-11-02 21:34:13,199 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 21:34:13,199 - ERROR - Error occurred while making prediction: 'outcome_error'
2024-11-02 21:34:13,337 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 21:34:13,339 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:34:16,357 - INFO - match_outcome predictions: [7.05715121 0.99340125 1.15334708 ... 3.87378686 3.40803633 3.87443623]
2024-11-02 21:34:28,206 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp13xwk0pt\tmprlw3ar7m\assets
2024-11-02 21:36:37,339 - INFO - Model directory checked/created.
2024-11-02 21:36:42,174 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:36:42,272 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:36:42,290 - INFO - Data loaded with 5111 rows
2024-11-02 21:36:42,290 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:36:42,756 - INFO - new real scores length: 274
2024-11-02 21:36:42,939 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:36:42,939 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:36:42,955 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:36:42,956 - INFO - data_with_error length: 234
2024-11-02 21:36:42,956 - INFO - prediction_df length: 5111
2024-11-02 21:36:42,956 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:36:44,807 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:36:44,807 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:36:44,807 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:36:44,807 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:36:44,822 - INFO - Data scaling started.
2024-11-02 21:36:44,840 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:36:44,857 - INFO - Data scaling completed.
2024-11-02 21:36:44,857 - INFO - Feature Selection started.
2024-11-02 21:39:04,974 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 21:39:04,974 - INFO - Feature selection using RFE completed.
2024-11-02 21:39:04,974 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:39:04,974 - INFO - First fit started
2024-11-02 21:42:10,589 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0024s). Check your callbacks.
2024-11-02 21:43:04,422 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 21:43:06,123 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.002696261089668009, R2: 0.9995896640936267, Stacking Model MAE: 0.00802900790125267, Stacking Model MAPE: 0.4207376330043564%
2024-11-02 21:43:06,125 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-11-02 21:43:06,126 - INFO - Second fit started
2024-11-02 21:47:26,975 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 21:47:28,665 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0006387837931135319, R2: 0.9999001976322224, Stacking Model MAE: 0.01903525097524681, Stacking Model MAPE: 0.5621596836988814%
2024-11-02 21:47:28,667 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 100.0%
2024-11-02 21:47:28,671 - INFO - Start match_outcome predictions
2024-11-02 21:47:28,674 - ERROR - Error occurred while making prediction: 'outcome_error'
2024-11-02 21:47:28,825 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 21:47:28,825 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:47:31,908 - INFO - match_outcome predictions: [7.04796675 0.99480789 1.04086052 ... 3.94660609 3.76916241 3.94536856]
2024-11-02 21:47:44,108 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpvkzz6u6s\tmpggzoqjry\assets
2024-11-02 21:50:25,592 - INFO - Model directory checked/created.
2024-11-02 21:50:30,695 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:50:30,815 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:50:30,818 - INFO - Data loaded with 5111 rows
2024-11-02 21:50:30,822 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:50:31,285 - INFO - new real scores length: 274
2024-11-02 21:50:31,474 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:50:31,476 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:50:31,478 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:50:31,486 - INFO - data_with_error length: 234
2024-11-02 21:50:31,489 - INFO - prediction_df length: 5111
2024-11-02 21:50:31,493 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:50:33,274 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:50:33,282 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:50:33,296 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:50:33,313 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:50:33,313 - INFO - Data scaling started.
2024-11-02 21:50:33,343 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:50:33,360 - INFO - Data scaling completed.
2024-11-02 21:50:33,360 - INFO - Feature Selection started.
2024-11-02 21:51:38,625 - INFO - Model directory checked/created.
2024-11-02 21:51:43,545 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:51:43,642 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:51:43,646 - INFO - Data loaded with 5111 rows
2024-11-02 21:51:43,649 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:51:44,109 - INFO - new real scores length: 274
2024-11-02 21:51:44,260 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:51:44,271 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:51:44,273 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:51:44,280 - INFO - data_with_error length: 234
2024-11-02 21:51:44,284 - INFO - prediction_df length: 5111
2024-11-02 21:51:44,286 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:51:46,039 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:51:46,041 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:51:46,042 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:51:46,042 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:51:46,042 - INFO - Data scaling started.
2024-11-02 21:51:46,079 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:51:46,086 - INFO - Data scaling completed.
2024-11-02 21:51:46,088 - INFO - Feature Selection started.
2024-11-02 21:55:20,727 - INFO - Model directory checked/created.
2024-11-02 21:55:25,500 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:55:25,594 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:55:25,594 - INFO - Data loaded with 5111 rows
2024-11-02 21:55:25,594 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:55:26,043 - INFO - new real scores length: 274
2024-11-02 21:55:26,211 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:55:26,211 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:55:26,211 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:55:26,228 - INFO - data_with_error length: 234
2024-11-02 21:55:26,233 - INFO - prediction_df length: 5111
2024-11-02 21:55:26,233 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:55:27,876 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 21:55:27,891 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:55:27,893 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:55:27,893 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:55:27,893 - INFO - Data scaling started.
2024-11-02 21:55:27,928 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 21:55:27,928 - INFO - Data scaling completed.
2024-11-02 21:55:27,928 - INFO - Feature Selection started.
2024-11-02 21:57:45,759 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 21:57:45,777 - INFO - Feature selection using RFE completed.
2024-11-02 21:57:45,777 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 21:57:45,777 - INFO - First fit started
2024-11-02 21:59:56,195 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 22:01:39,776 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 22:01:41,633 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0017133711816520196, R2: 0.9997392471673195, Stacking Model MAE: 0.02861776644659947, Stacking Model MAPE: 0.9665210714482783%
2024-11-02 22:01:41,637 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.85212569316081%
2024-11-02 22:01:41,637 - INFO - Second fit started
2024-11-02 22:03:51,176 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0025s). Check your callbacks.
2024-11-02 22:05:45,995 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 22:05:47,720 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.002087565367262469, R2: 0.9996738427480637, Stacking Model MAE: 0.02053913341486921, Stacking Model MAPE: 0.7325739113823776%
2024-11-02 22:05:47,720 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.66728280961183%
2024-11-02 22:05:47,728 - INFO - Start match_outcome predictions
2024-11-02 22:05:47,730 - INFO - Train a residual model for error
2024-11-02 22:05:47,733 - INFO - Residual model train data selected
2024-11-02 22:05:47,743 - INFO - Residual model scaler loaded
2024-11-02 22:05:47,745 - ERROR - Error occurred while making prediction: could not convert string to float: '2024-10-23 00:00:00'
2024-11-02 22:05:47,862 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 22:05:47,862 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:05:50,862 - INFO - match_outcome predictions: [7.00188617 1.05802166 1.2293108  ... 3.74454898 3.18645672 3.79429264]
2024-11-02 22:06:00,875 - INFO - Predictions saved to ./Model_build1/predictions_hybrid_2fit_match_outcome.xlsx
2024-11-02 22:06:02,130 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpy54t9man\tmpd2yyrdfo\assets
2024-11-02 22:06:34,416 - INFO - Model directory checked/created.
2024-11-02 22:06:39,880 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 22:06:39,983 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 22:06:39,984 - INFO - Data loaded with 5111 rows
2024-11-02 22:06:39,984 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 22:06:40,447 - INFO - new real scores length: 274
2024-11-02 22:06:40,657 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 22:06:40,659 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 22:06:40,662 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 22:06:40,678 - INFO - data_with_error length: 234
2024-11-02 22:06:40,682 - INFO - prediction_df length: 5111
2024-11-02 22:06:40,686 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:06:42,411 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 22:06:42,411 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 22:06:42,430 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 22:06:42,435 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 22:06:42,437 - INFO - Data scaling started.
2024-11-02 22:06:42,461 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 22:06:42,470 - INFO - Data scaling completed.
2024-11-02 22:06:42,471 - INFO - Feature Selection started.
2024-11-02 22:09:08,977 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 22:09:08,980 - INFO - Feature selection using RFE completed.
2024-11-02 22:09:08,980 - INFO - Selected Features: ['running_id', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 22:09:08,980 - INFO - First fit started
2024-11-02 22:13:12,646 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 22:13:14,424 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0041896456740954475, R2: 0.9993623903628432, Stacking Model MAE: 0.021185515099747924, Stacking Model MAPE: 0.6182933559787515%
2024-11-02 22:13:14,424 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-11-02 22:13:14,429 - INFO - Second fit started
2024-11-02 22:16:08,160 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 22:17:35,631 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 22:17:37,402 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0029804000301728653, R2: 0.9995343479544372, Stacking Model MAE: 0.026215975485263977, Stacking Model MAPE: 0.9989117730530621%
2024-11-02 22:17:37,402 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.48243992606285%
2024-11-02 22:17:37,412 - INFO - Start match_outcome predictions
2024-11-02 22:17:37,413 - INFO - Train a residual model for error
2024-11-02 22:17:37,416 - INFO - Residual model train data selected
2024-11-02 22:17:37,427 - INFO - Residual model scaler loaded
2024-11-02 22:17:37,664 - INFO - Residual model successfully fitted
2024-11-02 22:17:37,797 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 22:17:37,797 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:17:41,064 - INFO - match_outcome predictions: [7.07643796 0.99432641 1.24631024 ... 3.82672958 3.15209126 3.82860168]
2024-11-02 22:17:41,064 - INFO - residual model prediction error: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2024-11-02 22:17:51,864 - INFO - Predictions saved to ./Model_build1/predictions_hybrid_2fit_match_outcome.xlsx
2024-11-02 22:17:53,115 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp2zn2i2kp\tmpjesah007\assets
2024-11-02 22:24:24,652 - INFO - Model directory checked/created.
2024-11-02 22:24:30,967 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 22:24:31,000 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 22:24:31,000 - INFO - Data loaded with 5111 rows
2024-11-02 22:24:31,000 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 22:24:31,516 - INFO - new real scores length: 274
2024-11-02 22:24:31,697 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 22:24:31,699 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 22:24:31,701 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 22:24:31,709 - INFO - data_with_error length: 234
2024-11-02 22:24:31,713 - INFO - prediction_df length: 5111
2024-11-02 22:24:31,716 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:24:33,549 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 22:24:33,549 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 22:24:33,565 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 22:24:33,565 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 22:24:33,565 - INFO - Data scaling started.
2024-11-02 22:24:33,599 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 22:24:33,620 - INFO - Data scaling completed.
2024-11-02 22:24:33,620 - INFO - Feature Selection started.
2024-11-02 22:27:09,635 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 22:27:09,635 - INFO - Feature selection using RFE completed.
2024-11-02 22:27:09,635 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Away_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 22:27:09,648 - INFO - First fit started
2024-11-02 22:32:13,867 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 22:32:16,183 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.0011113842406140673, R2: 0.9998308617583628, Stacking Model MAE: 0.013782341587479796, Stacking Model MAPE: 0.5095940941652276%
2024-11-02 22:32:16,186 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.63031423290202%
2024-11-02 22:32:16,187 - INFO - Second fit started
2024-11-02 22:37:17,055 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 22:37:19,117 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0015106809312332376, R2: 0.9997639740777412, Stacking Model MAE: 0.027993527539424697, Stacking Model MAPE: 1.007280708610516%
2024-11-02 22:37:19,120 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.88909426987061%
2024-11-02 22:37:19,123 - INFO - Start match_outcome predictions
2024-11-02 22:37:19,124 - INFO - Train a residual model for error
2024-11-02 22:37:19,127 - INFO - Residual model train data selected
2024-11-02 22:37:19,139 - INFO - Residual model scaler loaded
2024-11-02 22:37:19,436 - INFO - Residual model successfully fitted
2024-11-02 22:37:19,541 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 22:37:19,542 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:37:23,062 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 22:37:23,214 - INFO - match_outcome predictions: [6.99365605 0.98641968 1.07815582 ... 3.88376785 3.43186667 3.88226142]
2024-11-02 22:37:23,218 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-02 22:37:33,688 - INFO - Predictions saved to ./Model_build1/predictions_hybrid_2fit_match_outcome.xlsx
2024-11-02 22:37:35,267 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpze38ewfk\tmpidfei39s\assets
2024-11-02 23:38:24,370 - INFO - Model directory checked/created.
2024-11-02 23:38:30,110 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 23:38:30,210 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5282, 51)
2024-11-02 23:38:30,212 - INFO - Data loaded with 5282 rows
2024-11-02 23:38:30,215 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 23:38:30,772 - INFO - new real scores length: 274
2024-11-02 23:38:32,061 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 23:38:32,063 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 23:38:32,065 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 23:38:32,076 - INFO - data_with_error length: 239
2024-11-02 23:38:32,079 - INFO - prediction_df length: 5282
2024-11-02 23:38:32,083 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:38:35,559 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-02 23:38:35,561 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 23:38:35,573 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 23:38:35,587 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 23:38:35,590 - INFO - Data scaling started.
2024-11-02 23:38:35,622 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-02 23:38:35,642 - INFO - Data scaling completed.
2024-11-02 23:38:35,643 - INFO - Feature Selection started.
2024-11-02 23:41:13,927 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-02 23:41:13,930 - INFO - Feature selection using RFE completed.
2024-11-02 23:41:13,933 - INFO - Selected Features: ['running_id', 'home_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'away_poisson_xG']
2024-11-02 23:41:13,934 - INFO - First fit started
2024-11-02 23:43:09,789 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0000s). Check your callbacks.
2024-11-02 23:45:36,239 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-02 23:45:38,290 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.00763955084971524, R2: 0.9988373596183933, Stacking Model MAE: 0.03173956739807259, Stacking Model MAPE: 0.8174893604869915%
2024-11-02 23:45:38,306 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 99.81515711645102%
2024-11-02 23:45:38,306 - INFO - Second fit started
2024-11-02 23:50:19,230 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-02 23:50:21,040 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.0038226374308701827, R2: 0.9994027583810531, Stacking Model MAE: 0.01803731906241693, Stacking Model MAPE: 1.0460269120851449%
2024-11-02 23:50:21,040 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 99.18669131238448%
2024-11-02 23:50:21,040 - INFO - Start match_outcome predictions
2024-11-02 23:50:21,040 - INFO - Train a residual model for error
2024-11-02 23:50:21,040 - INFO - Residual model train data selected
2024-11-02 23:50:21,056 - INFO - Residual model scaler loaded
2024-11-02 23:50:21,223 - INFO - Residual model successfully fitted
2024-11-02 23:50:21,340 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-02 23:50:21,340 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:50:24,690 - INFO - match_outcome predictions: [0.79524335 0.79749985 0.79749967 ... 0.7820383  0.75333665 0.75113118]
2024-11-02 23:50:24,707 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-02 23:50:33,888 - INFO - Predictions saved to ./Model_build1/predictions_hybrid_2fit_match_outcome.xlsx
2024-11-02 23:50:35,573 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpz0ge0xi4\tmph8n32ndx\assets
2024-11-03 01:59:56,823 - INFO - Model directory checked/created.
2024-11-03 02:00:02,540 - INFO - Data loaded from ./Model_build1/model_data_training_newPoisson.xlsx with shape: (13917, 65)
2024-11-03 02:00:02,672 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5282, 51)
2024-11-03 02:00:02,672 - INFO - Data loaded with 5282 rows
2024-11-03 02:00:02,672 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 65)
2024-11-03 02:00:03,159 - INFO - new real scores length: 274
2024-11-03 02:00:03,325 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 02:00:03,327 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 02:00:03,329 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 02:00:03,338 - INFO - data_with_error length: 234
2024-11-03 02:00:03,342 - INFO - prediction_df length: 5282
2024-11-03 02:00:03,343 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:00:05,284 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-03 02:00:05,287 - INFO - Data prepared for modeling. Feature shape: (13883, 50), Target shape: (13883,)
2024-11-03 02:00:05,289 - INFO - Data split into train and test. Train shape: (11106, 50), Test shape: (2777, 50)
2024-11-03 02:00:05,289 - INFO - Data split into train2 and test2. Train2 shape: (11106, 50), Test2 shape: (2777, 50)
2024-11-03 02:00:05,289 - INFO - Data scaling started.
2024-11-03 02:00:05,354 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-03 02:00:05,355 - INFO - Data scaling completed.
2024-11-03 02:00:05,355 - INFO - Feature Selection started.
2024-11-03 02:05:47,372 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-03 02:05:47,372 - INFO - Feature selection using RFE completed.
2024-11-03 02:05:47,372 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Away_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_win_rate', 'away_win_rate', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:05:47,389 - INFO - First fit started
2024-11-03 02:12:24,555 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-03 02:12:27,227 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.5215047372700369, R2: 0.9185475291195293, Stacking Model MAE: 0.31502587912024105, Stacking Model MAPE: 14.10610470473775%
2024-11-03 02:12:27,227 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 80.33849477853799%
2024-11-03 02:12:27,227 - INFO - Second fit started
2024-11-03 02:13:41,627 - INFO - Model directory checked/created.
2024-11-03 02:13:48,212 - INFO - Data loaded from ./Model_build1/model_data_training_newPoisson.xlsx with shape: (13917, 65)
2024-11-03 02:13:48,333 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (3760, 51)
2024-11-03 02:13:48,335 - INFO - Data loaded with 3760 rows
2024-11-03 02:13:48,341 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 65)
2024-11-03 02:13:48,827 - INFO - new real scores length: 274
2024-11-03 02:13:48,996 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 02:13:48,998 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 02:13:48,999 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 02:13:49,007 - INFO - data_with_error length: 173
2024-11-03 02:13:49,010 - INFO - prediction_df length: 3760
2024-11-03 02:13:49,013 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:13:51,125 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-03 02:13:51,125 - INFO - Data prepared for modeling. Feature shape: (13883, 50), Target shape: (13883,)
2024-11-03 02:13:51,142 - INFO - Data split into train and test. Train shape: (11106, 50), Test shape: (2777, 50)
2024-11-03 02:13:51,142 - INFO - Data split into train2 and test2. Train2 shape: (11106, 50), Test2 shape: (2777, 50)
2024-11-03 02:13:51,156 - INFO - Data scaling started.
2024-11-03 02:13:51,175 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-03 02:13:51,193 - INFO - Data scaling completed.
2024-11-03 02:13:51,193 - INFO - Feature Selection started.
2024-11-03 02:19:27,493 - INFO - RFE selector saved to ./models/rfe_match_outcome_selector.pkl
2024-11-03 02:19:27,510 - INFO - Feature selection using RFE completed.
2024-11-03 02:19:27,511 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_team_matches', 'home_draw_rate', 'away_draw_rate', 'home_win_rate', 'away_win_rate', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:19:27,513 - INFO - First fit started
2024-11-03 02:22:54,910 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0001s vs `on_train_batch_end` time: 0.0002s). Check your callbacks.
2024-11-03 02:23:34,865 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-03 02:25:44,477 - INFO - Stacking model for match_outcome trained successfully on first split.
2024-11-03 02:25:46,814 - INFO - match_outcome (1st fit) Stacking Model MSE: 0.5244055617799926, R2: 0.9180944568710137, Stacking Model MAE: 0.3016833958209687, Stacking Model MAPE: 13.012653512646954%
2024-11-03 02:25:46,816 - INFO - match_outcome (1st fit) Stacking Model Within Range (0.3): 80.44652502700757%
2024-11-03 02:25:46,817 - INFO - Second fit started
2024-11-03 02:31:26,944 - INFO - Stacking model for match_outcome trained successfully on second split.
2024-11-03 02:31:29,099 - INFO - match_outcome (2nd fit) Stacking Model MSE: 0.5754192830496792, R2: 0.9101246920172131, Stacking Model MAE: 0.3196747926578234, Stacking Model MAPE: 13.800549383637826%
2024-11-03 02:31:29,110 - INFO - match_outcome (2nd fit) Stacking Model Within Range (0.3): 79.25819229384228%
2024-11-03 02:31:29,115 - INFO - Start match_outcome predictions
2024-11-03 02:31:29,116 - INFO - Train a residual model for error
2024-11-03 02:31:29,119 - INFO - Residual model train data selected
2024-11-03 02:31:29,129 - INFO - Residual model scaler loaded
2024-11-03 02:31:29,327 - INFO - Residual model successfully fitted
2024-11-03 02:31:29,628 - INFO - Imputer loaded from ./models/imputer_match_outcome.pkl
2024-11-03 02:31:29,643 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:31:32,497 - INFO - match_outcome predictions: [4.38024353 5.73294712 1.11540369 ... 2.78576653 2.24611633 6.41305357]
2024-11-03 02:31:32,501 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-03 02:31:40,911 - INFO - Predictions saved to ./Model_build1/predictions_hybrid_2fit_match_outcome.xlsx
2024-11-03 02:31:42,494 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp8gg01fxc\tmprn_88l6v\assets
2024-11-03 17:52:29,182 - INFO - Model directory checked/created.
2024-11-03 17:52:49,224 - INFO - Data loaded from ./Model_build1/data/model_data_training_newPoisson.xlsx with shape: (13917, 69)
2024-11-03 17:52:49,420 - INFO - Data loaded from ./Model_build1/data/merged_data_prediction.csv with shape: (3760, 55)
2024-11-03 17:52:49,421 - INFO - Data loaded with 3760 rows
2024-11-03 17:52:49,436 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 69)
2024-11-03 17:52:51,223 - INFO - new real scores length: 274
2024-11-03 17:52:51,267 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 17:52:51,268 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 17:52:51,268 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 17:52:51,284 - INFO - data_with_error length: 173
2024-11-03 17:52:51,289 - INFO - prediction_df length: 3760
2024-11-03 17:52:51,294 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'Home_offsides_mean', 'Away_offsides_mean', 'Home_passes_mean', 'Away_passes_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 18:38:18,796 - INFO - Model directory checked/created.
2024-11-03 18:38:55,063 - INFO - Data loaded from ./Model_build1/data/model_data_training_newPoisson.xlsx with shape: (13917, 69)
2024-11-03 18:38:55,380 - INFO - Data loaded from ./Model_build1/data/merged_data_prediction.csv with shape: (3760, 55)
2024-11-03 18:38:55,380 - INFO - Data loaded with 3760 rows
2024-11-03 18:38:55,467 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13403 Filtered data shape: (13403, 69)
2024-11-03 18:38:58,729 - INFO - new real scores length: 274
2024-11-03 18:38:58,802 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 18:38:58,802 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 18:38:58,802 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 18:38:58,902 - INFO - data_with_error length: 173
2024-11-03 18:38:58,955 - INFO - prediction_df length: 3760
2024-11-03 18:38:58,963 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'Home_offsides_mean', 'Away_offsides_mean', 'Home_passes_mean', 'Away_passes_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 18:42:32,134 - INFO - Imputer saved to ./models/imputer_match_outcome.pkl
2024-11-03 18:42:32,135 - INFO - Data prepared for modeling. Feature shape: (13403, 54), Target shape: (13403,)
2024-11-03 18:42:32,146 - INFO - Data split into train and test. Train shape: (10722, 54), Test shape: (2681, 54)
2024-11-03 18:42:32,156 - INFO - Data split into train2 and test2. Train2 shape: (10722, 54), Test2 shape: (2681, 54)
2024-11-03 18:42:32,156 - INFO - Data scaling started.
2024-11-03 18:42:32,182 - INFO - Scaler saved to ./models/scaler_match_outcome.pkl
2024-11-03 18:42:32,196 - INFO - Data scaling completed.
2024-11-03 18:42:32,196 - INFO - Feature Selection started.
