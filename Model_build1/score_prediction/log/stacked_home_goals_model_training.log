2024-10-22 23:17:53,130 - INFO - Model directory checked/created.
2024-10-22 23:17:53,328 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-22 23:17:54,799 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-22 23:17:54,815 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (13447, 56)
2024-10-22 23:17:55,415 - INFO - New score dataframe created with errors:    running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
0        7971         2.122105         1.201717              3.0              0.0                 1.0    0.877895   -1.201717       0.006483
1        7972         0.935789        -0.003282              1.0              1.0                 0.0    0.064211    1.003282      -1.024491
2       14408         2.325106         0.318673              3.0              2.0                 1.0    0.674894    1.681327       0.010585
3       14410         1.086156         0.081375              1.0              2.0                -1.0   -0.086156    1.918625      -1.992787
4        6411         0.816743         2.678010              0.0              2.0                -1.0   -0.816743   -0.678010       0.039193
2024-10-22 23:17:55,431 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-22 23:17:57,279 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-22 23:17:57,279 - INFO - Data prepared for modeling. Feature shape: (13447, 44), Target shape: (13447,)
2024-10-22 23:17:57,279 - INFO - Data split into train and test. Train shape: (10757, 44), Test shape: (2690, 44)
2024-10-22 23:17:57,296 - INFO - Data scaling completed.
2024-10-22 23:17:57,312 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-22 23:20:29,464 - INFO - Feature selection using RFE completed.
2024-10-22 23:20:30,680 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-22 23:23:18,040 - INFO - Stacking model for home_goals trained successfully.
2024-10-22 23:23:19,658 - INFO - home_goals Stacking Model MSE: 0.08886055816747038, R2: 0.9329408238200647, Stacking Model MAE: 0.14777974275074576, Stacking Model MAPE: inf%
2024-10-22 23:33:51,973 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp7w632doc\assets
2024-10-22 23:33:52,043 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-22 23:33:52,541 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-22 23:33:52,622 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-22 23:33:52,682 - INFO - Start home_goals predictions
2024-10-22 23:33:52,684 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-22 23:33:53,097 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-22 23:33:53,106 - INFO - [[-1.54187569 -0.00929519 -0.98628877 ... -0.81743435  0.30176534
  -1.40133035]
 [-1.54173038 -0.30816653 -0.01372492 ... -1.13245679  1.59659553
  -0.06148439]
 [-1.54158506 -1.28108812 -0.45868878 ... -0.34881889  0.52218069
   0.11457045]
 ...
 [ 1.20369695 -1.5354467   0.4248823  ...  0.17852332  0.68708253
   1.03600035]
 [ 1.20384227 -1.54816463 -1.29776347 ... -0.32335066  0.10798555
   0.06069653]
 [ 1.20398758 -0.60703787 -0.61760444 ...  0.9245927  -0.12914709
  -1.17468832]]
2024-10-22 23:33:53,239 - INFO - home goal predictions: [4.233598  1.0164232 1.8188558 ... 2.0775166 1.1399314 1.6956624]
2024-10-22 23:33:53,248 - INFO - home goal error predictions: [1.42191907 1.38401838 1.49434318 ... 1.48620635 1.42370508 1.63959512]
2024-10-23 00:34:23,433 - INFO - Model directory checked/created.
2024-10-23 00:34:23,680 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 00:34:25,165 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 00:34:25,167 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (13447, 56)
2024-10-23 00:34:25,834 - INFO - New score dataframe created with errors:    running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
0        7971         2.122105         1.201717              3.0              0.0                 1.0    0.877895   -1.201717       0.006483
1        7972         0.935789        -0.003282              1.0              1.0                 0.0    0.064211    1.003282      -1.024491
2       14408         2.325106         0.318673              3.0              2.0                 1.0    0.674894    1.681327       0.010585
3       14410         1.086156         0.081375              1.0              2.0                -1.0   -0.086156    1.918625      -1.992787
4        6411         0.816743         2.678010              0.0              2.0                -1.0   -0.816743   -0.678010       0.039193
2024-10-23 00:34:25,855 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 00:34:27,547 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 00:34:27,549 - INFO - Data prepared for modeling. Feature shape: (13447, 44), Target shape: (13447,)
2024-10-23 00:34:27,554 - INFO - Data split into train and test. Train shape: (10757, 44), Test shape: (2690, 44)
2024-10-23 00:34:27,570 - INFO - Data scaling completed.
2024-10-23 00:34:27,583 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 00:37:00,100 - INFO - Feature selection using RFE completed.
2024-10-23 00:37:01,350 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 00:39:51,931 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 00:39:54,116 - INFO - home_goals Stacking Model MSE: 0.08975525670316717, R2: 0.9322656339723918, Stacking Model MAE: 0.14683943631931806, Stacking Model MAPE: inf%
2024-10-23 00:50:54,089 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpoa5bsnkm\assets
2024-10-23 00:50:54,216 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 00:50:54,833 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 00:50:54,943 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 00:50:55,005 - INFO - Start home_goals predictions
2024-10-23 00:50:55,008 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-23 00:50:55,345 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 00:50:55,356 - INFO - [[-1.54187569 -0.00929519 -0.98628877 ... -0.81743435  0.30176534
  -1.40133035]
 [-1.54173038 -0.30816653 -0.01372492 ... -1.13245679  1.59659553
  -0.06148439]
 [-1.54158506 -1.28108812 -0.45868878 ... -0.34881889  0.52218069
   0.11457045]
 ...
 [ 1.20369695 -1.5354467   0.4248823  ...  0.17852332  0.68708253
   1.03600035]
 [ 1.20384227 -1.54816463 -1.29776347 ... -0.32335066  0.10798555
   0.06069653]
 [ 1.20398758 -0.60703787 -0.61760444 ...  0.9245927  -0.12914709
  -1.17468832]]
2024-10-23 00:50:55,497 - INFO - home goal predictions: [3.6322415 0.8363137 1.8378505 ... 2.0349004 1.0862414 1.5005925]
2024-10-23 00:50:55,506 - INFO - home goal error predictions: [1.51696767 1.31754138 1.48204054 ... 1.31813515 1.46219954 1.62729247]
2024-10-23 01:41:20,090 - INFO - Model directory checked/created.
2024-10-23 01:41:20,282 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 01:41:21,563 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 01:41:21,570 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (738, 56)
2024-10-23 01:41:22,096 - INFO - New score dataframe created with errors:     running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
21       18174         1.008341         0.017432              2.0              0.0                 1.0    0.991659   -0.017432       0.142420
30         452         2.888793         1.192497              2.0              3.0                -1.0   -0.888793    1.807503      -1.957210
34         456         0.851993         0.901770              2.0              1.0                 1.0    1.148007    0.098230       1.049131
54        6413         1.199111        -0.109894              3.0              1.0                 1.0    1.800889    1.109894      -0.037635
57        6416         1.709130         0.226556              1.0              2.0                -1.0   -0.709130    1.773444      -0.700378
2024-10-23 01:41:22,105 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 01:41:22,595 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 01:41:22,597 - INFO - Data prepared for modeling. Feature shape: (738, 44), Target shape: (738,)
2024-10-23 01:41:22,599 - INFO - Data split into train and test. Train shape: (590, 44), Test shape: (148, 44)
2024-10-23 01:41:22,604 - INFO - Data scaling completed.
2024-10-23 01:41:22,625 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 01:41:27,814 - INFO - Feature selection using RFE completed.
2024-10-23 01:41:28,021 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 01:41:36,829 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 01:41:36,950 - INFO - home_goals Stacking Model MSE: 0.19261528637781328, R2: 0.8891242186266262, Stacking Model MAE: 0.24129766052923882, Stacking Model MAPE: inf%
2024-10-23 01:41:43,317 - WARNING - 5 out of the last 15 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001153CE661F0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:41:43,960 - WARNING - 5 out of the last 13 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001153FE20A60> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:42:14,587 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpax_d_phm\assets
2024-10-23 01:42:14,651 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 01:42:15,158 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 01:42:15,247 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 01:44:42,641 - INFO - Model directory checked/created.
2024-10-23 01:44:42,881 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 01:44:44,211 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 01:44:44,215 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 738 Filtered data shape: (738, 56)
2024-10-23 01:44:44,776 - INFO - new real scores length: 18
2024-10-23 01:44:44,793 - INFO - New score dataframe created with errors:     running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
21       18174         1.008341         0.017432              2.0              0.0                 1.0    0.991659   -0.017432       0.142420
30         452         2.888793         1.192497              2.0              3.0                -1.0   -0.888793    1.807503      -1.957210
34         456         0.851993         0.901770              2.0              1.0                 1.0    1.148007    0.098230       1.049131
54        6413         1.199111        -0.109894              3.0              1.0                 1.0    1.800889    1.109894      -0.037635
57        6416         1.709130         0.226556              1.0              2.0                -1.0   -0.709130    1.773444      -0.700378
2024-10-23 01:44:44,798 - INFO - data_with_error length: 0
2024-10-23 01:44:44,802 - INFO - prediction_df length: 712
2024-10-23 01:44:44,804 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 01:44:45,286 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 01:44:45,288 - INFO - Data prepared for modeling. Feature shape: (738, 44), Target shape: (738,)
2024-10-23 01:44:45,291 - INFO - Data split into train and test. Train shape: (590, 44), Test shape: (148, 44)
2024-10-23 01:44:45,295 - INFO - Data scaling completed.
2024-10-23 01:44:45,306 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 01:44:50,615 - INFO - Feature selection using RFE completed.
2024-10-23 01:44:50,812 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 01:44:59,645 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 01:44:59,764 - INFO - home_goals Stacking Model MSE: 0.18226863637275176, R2: 0.8950800953666364, Stacking Model MAE: 0.24006466345319127, Stacking Model MAPE: inf%
2024-10-23 01:45:05,917 - WARNING - 5 out of the last 15 calls to <function Model.make_predict_function.<locals>.predict_function at 0x0000022D1043B1F0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:45:06,650 - WARNING - 5 out of the last 13 calls to <function Model.make_predict_function.<locals>.predict_function at 0x0000022D1087AA60> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:45:37,513 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpljfbgd32\assets
2024-10-23 01:45:37,584 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 01:45:38,043 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 01:45:38,132 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 01:47:47,711 - INFO - Model directory checked/created.
2024-10-23 01:47:47,944 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 01:47:49,206 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 01:47:49,210 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 738 Filtered data shape: (738, 56)
2024-10-23 01:47:49,690 - INFO - new real scores length: 18
2024-10-23 01:47:49,703 - INFO - New score dataframe created with errors:     running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
21       18174         1.008341         0.017432              2.0              0.0                 1.0    0.991659   -0.017432       0.142420
30         452         2.888793         1.192497              2.0              3.0                -1.0   -0.888793    1.807503      -1.957210
34         456         0.851993         0.901770              2.0              1.0                 1.0    1.148007    0.098230       1.049131
54        6413         1.199111        -0.109894              3.0              1.0                 1.0    1.800889    1.109894      -0.037635
57        6416         1.709130         0.226556              1.0              2.0                -1.0   -0.709130    1.773444      -0.700378
2024-10-23 01:47:49,708 - INFO - data_with_error length: 0
2024-10-23 01:47:49,712 - INFO - prediction_df length: 712
2024-10-23 01:47:49,714 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 01:47:50,200 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 01:47:50,202 - INFO - Data prepared for modeling. Feature shape: (738, 44), Target shape: (738,)
2024-10-23 01:47:50,203 - INFO - Data split into train and test. Train shape: (590, 44), Test shape: (148, 44)
2024-10-23 01:47:50,208 - INFO - Data scaling completed.
2024-10-23 01:47:50,218 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 01:47:55,408 - INFO - Feature selection using RFE completed.
2024-10-23 01:47:55,607 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 01:48:04,499 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 01:48:04,625 - INFO - home_goals Stacking Model MSE: 0.19545422148840166, R2: 0.8874900329159584, Stacking Model MAE: 0.24525535476529364, Stacking Model MAPE: inf%
2024-10-23 01:48:11,260 - WARNING - 5 out of the last 15 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001A75BD43160> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:48:11,972 - WARNING - 5 out of the last 13 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001A767D079D0> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:49:29,063 - INFO - Model directory checked/created.
2024-10-23 01:49:29,266 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 01:49:30,577 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 01:49:30,581 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 738 Filtered data shape: (738, 56)
2024-10-23 01:49:31,081 - INFO - new real scores length: 18
2024-10-23 01:49:31,097 - INFO - New score dataframe created with errors:     running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
21       18174         1.008341         0.017432              2.0              0.0                 1.0    0.991659   -0.017432       0.142420
30         452         2.888793         1.192497              2.0              3.0                -1.0   -0.888793    1.807503      -1.957210
34         456         0.851993         0.901770              2.0              1.0                 1.0    1.148007    0.098230       1.049131
54        6413         1.199111        -0.109894              3.0              1.0                 1.0    1.800889    1.109894      -0.037635
57        6416         1.709130         0.226556              1.0              2.0                -1.0   -0.709130    1.773444      -0.700378
2024-10-23 01:49:31,104 - INFO - data_with_error length: 0
2024-10-23 01:49:31,109 - INFO - prediction_df length: 712
2024-10-23 01:49:31,112 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 01:49:31,617 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 01:49:31,620 - INFO - Data prepared for modeling. Feature shape: (738, 44), Target shape: (738,)
2024-10-23 01:49:31,622 - INFO - Data split into train and test. Train shape: (590, 44), Test shape: (148, 44)
2024-10-23 01:49:31,627 - INFO - Data scaling completed.
2024-10-23 01:49:31,639 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 01:49:36,948 - INFO - Feature selection using RFE completed.
2024-10-23 01:49:37,144 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 01:54:22,048 - INFO - Model directory checked/created.
2024-10-23 01:54:22,274 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 01:54:23,537 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 01:54:23,541 - INFO - Data loaded with 434 rows
2024-10-23 01:54:23,544 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 738 Filtered data shape: (738, 56)
2024-10-23 01:54:24,031 - INFO - new real scores length: 18
2024-10-23 01:54:24,035 - INFO - prediction_df length: 55
2024-10-23 01:54:24,038 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 01:54:24,510 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 01:54:24,511 - INFO - Data prepared for modeling. Feature shape: (738, 44), Target shape: (738,)
2024-10-23 01:54:24,513 - INFO - Data split into train and test. Train shape: (590, 44), Test shape: (148, 44)
2024-10-23 01:54:24,522 - INFO - Data scaling completed.
2024-10-23 01:54:24,534 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 01:54:29,674 - INFO - Feature selection using RFE completed.
2024-10-23 01:54:29,866 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 01:54:38,656 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 01:54:38,804 - INFO - home_goals Stacking Model MSE: 0.19351757876131392, R2: 0.8886048290447855, Stacking Model MAE: 0.24477656521480198, Stacking Model MAPE: inf%
2024-10-23 01:54:44,929 - WARNING - 5 out of the last 15 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001D4AD4F1040> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:54:45,592 - WARNING - 5 out of the last 13 calls to <function Model.make_predict_function.<locals>.predict_function at 0x000001D4AA923670> triggered tf.function retracing. Tracing is expensive and the excessive number of tracings could be due to (1) creating @tf.function repeatedly in a loop, (2) passing tensors with different shapes, (3) passing Python objects instead of tensors. For (1), please define your @tf.function outside of the loop. For (2), @tf.function has reduce_retracing=True option that can avoid unnecessary retracing. For (3), please refer to https://www.tensorflow.org/guide/function#controlling_retracing and https://www.tensorflow.org/api_docs/python/tf/function for  more details.
2024-10-23 01:55:15,085 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmptb14h5_m\assets
2024-10-23 01:55:15,151 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 01:55:15,646 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 01:55:15,737 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 01:55:15,739 - INFO - Start home_goals predictions
2024-10-23 01:55:15,740 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-23 01:55:15,856 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 01:55:15,859 - INFO - [[ 3.77839693e+00  2.46955776e-01 -1.47999541e-01 ... -1.43647054e+00
  -7.51957500e-01 -3.25208301e-01]
 [ 9.91580351e+00 -7.01990405e-01 -3.27483457e-02 ... -2.25939546e-02
   6.93674525e-01 -1.77185844e+00]
 [ 9.91652675e+00  2.94104385e-03 -1.51745492e+00 ... -1.27003303e-01
  -5.85153804e-01  2.31195600e-01]
 ...
 [ 9.95268870e+00 -3.83714315e-03 -3.24266076e-01 ...  6.44138355e-02
   3.55433699e-01 -1.25254814e+00]
 [ 9.95341194e+00 -3.08855558e-01 -1.61914716e+00 ...  1.19551511e+00
   2.48864671e-01  9.20946247e-02]
 [ 9.95413518e+00 -1.15612893e+00  3.33343687e-01 ... -1.90196222e+00
  -1.59060941e+00  1.37182360e+00]]
2024-10-23 01:55:15,908 - INFO - home goal predictions: [3.8149583 6.869107  5.325445  4.7180076 4.386909  3.5706508 4.447925
 5.0133376 2.333976  4.1282744 3.4135878 3.6401386 5.4492116 6.202498
 5.2600145 4.3232074 3.7373974 5.139277  2.6468897 4.792194  5.7250896
 6.740229  4.154989  4.218903  4.9402637 4.831727  6.322746  6.03989
 3.5623915 5.548636  3.7051961 4.929959  4.283538  4.6665483 2.765307
 4.4797196 5.4586577 2.7071264 4.8199925 5.928447  3.4822848 4.178384
 3.9232206 5.443181  5.37555   4.4083667 7.275804  4.365976  4.6026044
 5.582388  3.7616436 5.0188556 3.723004  5.7760367 4.4557004]
2024-10-23 01:58:48,091 - INFO - Model directory checked/created.
2024-10-23 01:58:48,343 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 01:58:49,640 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 01:58:49,643 - INFO - Data loaded with 1496 rows
2024-10-23 01:58:49,646 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 1440 Filtered data shape: (1440, 56)
2024-10-23 01:58:50,136 - INFO - new real scores length: 92
2024-10-23 01:58:50,140 - INFO - prediction_df length: 1496
2024-10-23 01:58:50,145 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 01:58:50,657 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 01:58:50,659 - INFO - Data prepared for modeling. Feature shape: (1440, 44), Target shape: (1440,)
2024-10-23 01:58:50,662 - INFO - Data split into train and test. Train shape: (1152, 44), Test shape: (288, 44)
2024-10-23 01:58:50,667 - INFO - Data scaling completed.
2024-10-23 01:58:50,693 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 01:59:00,289 - INFO - Feature selection using RFE completed.
2024-10-23 01:59:00,584 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 01:59:14,332 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 01:59:14,468 - INFO - home_goals Stacking Model MSE: 0.1340784160516664, R2: 0.9056382831361468, Stacking Model MAE: 0.17826032291428798, Stacking Model MAPE: inf%
2024-10-23 02:00:11,041 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp4h9xghm_\assets
2024-10-23 02:00:11,105 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 02:00:11,612 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 02:00:11,704 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 02:00:11,706 - INFO - Start home_goals predictions
2024-10-23 02:00:11,707 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-23 02:00:11,822 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 02:00:11,828 - INFO - [[-0.99914474  0.38281662 -0.27213968 ... -0.17400478  1.58852468
  -0.24243511]
 [-0.99863295 -0.1289903  -1.43063995 ... -0.01785054  0.90916403
   0.45527069]
 [-0.99671377 -0.04258134 -1.43063995 ... -0.01785054  0.62304539
   0.45527069]
 ...
 [ 0.98081144 -1.4849463   0.53144433 ...  0.25312299  0.64714362
   0.86427065]
 [ 0.98093938 -1.49823999 -1.28331622 ... -0.2276828   0.15322558
   0.07484059]
 [ 0.98106733 -0.5145072  -0.56678715 ...  0.96787309 -0.0490274
  -0.92510415]]
2024-10-23 02:00:11,943 - INFO - home goal predictions: [1.9036014 2.3425326 2.2868276 ... 1.7729119 1.0578861 1.8748925]
2024-10-23 18:31:19,331 - INFO - Model directory checked/created.
2024-10-23 18:31:23,966 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 62)
2024-10-23 18:31:25,248 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 18:31:25,248 - INFO - Data loaded with 5174 rows
2024-10-23 18:31:25,248 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 62)
2024-10-23 18:31:25,764 - INFO - new real scores length: 92
2024-10-23 18:31:25,764 - INFO - prediction_df length: 3754
2024-10-23 18:31:25,781 - INFO - Numeric features selected: ['Unnamed: 0.1', 'Unnamed: 0', 'running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 18:31:27,431 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 18:31:27,448 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 18:31:27,448 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 18:31:27,466 - INFO - Data scaling completed.
2024-10-23 18:31:27,481 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 18:35:13,165 - INFO - Model directory checked/created.
2024-10-23 18:35:17,816 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 62)
2024-10-23 18:35:19,097 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 18:35:19,097 - INFO - Data loaded with 5174 rows
2024-10-23 18:35:19,097 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 62)
2024-10-23 18:35:19,581 - INFO - new real scores length: 92
2024-10-23 18:35:19,581 - INFO - prediction_df length: 3754
2024-10-23 18:35:19,599 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 18:35:21,114 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 18:35:21,114 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-23 18:35:21,114 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-23 18:35:21,132 - INFO - Data scaling completed.
2024-10-23 18:35:21,148 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 18:38:29,014 - INFO - Feature selection using RFE completed.
2024-10-23 18:38:30,265 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 18:40:48,331 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 18:40:49,723 - INFO - home_goals Stacking Model MSE: 0.09706106563107718, R2: 0.9342003878546297, Stacking Model MAE: 0.1617388067303303, Stacking Model MAPE: inf%
2024-10-23 18:49:43,881 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpk0c7pbcf\assets
2024-10-23 18:49:43,947 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 18:49:44,414 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 18:49:44,529 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 18:49:44,532 - INFO - Start home_goals predictions
2024-10-23 18:49:44,534 - INFO - columns of Prediction_df: Index([
'running_id', 'season_encoded',
'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded',
        'home_league_position','away_league_position', 
        'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum',
        'Home_draws','Away_draws',
         'home_draw_rate', 'away_draw_rate',
          'home_average_points','away_average_points', 
          'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 
       'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg','away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean',
        'Home_shot_on_target_mean', 'away_shot_on_target_mean', 
        'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
        'home_team_elo','away_team_elo', 
        'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 18:49:44,881 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 18:53:20,973 - INFO - Model directory checked/created.
2024-10-23 18:53:25,643 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 62)
2024-10-23 18:53:26,925 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 18:53:26,925 - INFO - Data loaded with 5174 rows
2024-10-23 18:53:26,925 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 62)
2024-10-23 18:53:27,425 - INFO - new real scores length: 92
2024-10-23 18:53:27,442 - INFO - prediction_df length: 3754
2024-10-23 18:53:27,442 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 18:53:28,940 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 18:53:28,940 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-23 18:53:28,957 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-23 18:53:28,957 - INFO - Data scaling completed.
2024-10-23 18:53:28,974 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 18:56:38,408 - INFO - Feature selection using RFE completed.
2024-10-23 18:56:39,742 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 18:58:53,240 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 18:58:54,607 - INFO - home_goals Stacking Model MSE: 0.09403707396553121, R2: 0.9362504114910902, Stacking Model MAE: 0.15207890948721825, Stacking Model MAPE: inf%
2024-10-23 19:08:02,692 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp3eouvgw2\assets
2024-10-23 19:08:02,775 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 19:08:03,257 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 19:08:03,364 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 19:08:03,366 - INFO - Start home_goals predictions
2024-10-23 19:08:03,368 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'away_shot_on_target_mean',
       'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean',
       'away_possession_mean', 'home_team_elo', 'away_team_elo',
       'home_poisson_xG', 'away_poisson_xG', 'referee_foul_rate',
       'referee_encoded'],
      dtype='object')
2024-10-23 19:08:03,674 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 19:11:51,974 - INFO - Model directory checked/created.
2024-10-23 19:11:56,890 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 64)
2024-10-23 19:11:58,224 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 19:11:58,225 - INFO - Data loaded with 5174 rows
2024-10-23 19:11:58,225 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 64)
2024-10-23 19:11:58,725 - INFO - new real scores length: 92
2024-10-23 19:11:58,725 - INFO - prediction_df length: 3754
2024-10-23 19:11:58,725 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 19:12:00,440 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 19:12:00,440 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 19:12:00,457 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 19:12:00,457 - INFO - Data scaling completed.
2024-10-23 19:12:00,474 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 19:15:42,857 - INFO - Feature selection using RFE completed.
2024-10-23 19:15:44,090 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 19:18:02,491 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 19:18:03,863 - INFO - home_goals Stacking Model MSE: 0.09375506546539521, R2: 0.9364415906195079, Stacking Model MAE: 0.15728926448776281, Stacking Model MAPE: inf%
2024-10-23 19:27:30,175 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp1j56ieca\assets
2024-10-23 19:27:30,252 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 19:27:30,724 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 19:27:30,807 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 19:27:30,807 - INFO - Start home_goals predictions
2024-10-23 19:27:30,807 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 19:27:31,156 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 19:27:31,172 - INFO - [[ -1.53341891   0.48031961   1.86403553 ... -15.98830556 -16.20428816
   32.33591896]
 [ -1.53327399  -0.11199913   1.67182833 ... -15.99106351 -16.19335345
   40.1458725 ]
 [ -1.53312906   1.67132611  -0.15139429 ... -15.99808138 -16.20765789
   39.92090491]
 ...
 [  2.40468564  -0.35402184   0.85906644 ... -15.99568487 -16.20690169
   44.390742  ]
 [  2.40483057   0.30835611   0.90299951 ... -15.98262906 -16.20737095
   44.390742  ]
 [  2.40497549  -1.57687343   0.88652461 ... -15.98483461 -16.21177063
   45.30373   ]]
2024-10-23 19:27:31,307 - INFO - home goal predictions: [41.506927 51.26641  38.121002 ... 36.98903  46.124382 44.541626]
2024-10-23 19:40:56,708 - INFO - Model directory checked/created.
2024-10-23 19:41:02,590 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 64)
2024-10-23 19:41:04,210 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 19:41:04,210 - INFO - Data loaded with 5174 rows
2024-10-23 19:41:04,224 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 64)
2024-10-23 19:41:04,807 - INFO - new real scores length: 92
2024-10-23 19:41:04,824 - INFO - prediction_df length: 3754
2024-10-23 19:41:04,824 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 19:41:07,174 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 19:41:07,174 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 19:41:07,174 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 19:41:07,191 - INFO - Data scaling completed.
2024-10-23 19:41:07,208 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 19:45:19,502 - INFO - Feature selection using RFE completed.
2024-10-23 19:45:20,724 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 19:48:13,007 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 19:48:14,593 - INFO - home_goals Stacking Model MSE: 0.09190724499203896, R2: 0.9376942645899675, Stacking Model MAE: 0.15022988877893784, Stacking Model MAPE: inf%
2024-10-23 19:58:06,858 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpb07l4qe0\assets
2024-10-23 19:58:06,925 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 19:58:07,423 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 19:58:07,508 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 19:58:07,511 - INFO - Start home_goals predictions
2024-10-23 19:58:07,513 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 19:58:07,823 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 19:58:07,838 - INFO - [[ -1.53341891   0.48031961   1.86403553 ... -15.98830556 -16.20428816
   32.33591896]
 [ -1.53327399  -0.11199913   1.67182833 ... -15.99106351 -16.19335345
   40.1458725 ]
 [ -1.53312906   1.67132611  -0.15139429 ... -15.99808138 -16.20765789
   39.92090491]
 ...
 [  2.40468564  -0.35402184   0.85906644 ... -15.99568487 -16.20690169
   44.390742  ]
 [  2.40483057   0.30835611   0.90299951 ... -15.98262906 -16.20737095
   44.390742  ]
 [  2.40497549  -1.57687343   0.88652461 ... -15.98483461 -16.21177063
   45.30373   ]]
2024-10-23 19:58:07,858 - INFO - X_new_prepared:             0         1         2         3           4         5         6          7          8   ...        21        22        23        24           25           26         27         28         29
0    -1.533419  0.480320  1.864036  1.358762   -7.217877 -1.080177  0.965258   9.786866  18.261087  ... -0.556488 -1.066638  1.742432 -0.019144  1267.355217  1440.853740 -15.988306 -16.204288  32.335919
1    -1.533274 -0.111999  1.671828  6.394762  123.837806 -1.185144 -1.083457  58.548118   3.386261  ...  0.060501 -0.276982  0.519073  0.090890  1343.191127  1392.303205 -15.991064 -16.193353  40.145873
2    -1.533129  1.671326 -0.151394  3.157333   15.574416 -1.099858 -0.937121  44.616332  13.798639  ... -0.260151 -1.160769  0.419661 -0.444292  1186.435893  1294.698117 -15.998081 -16.207658  39.920905
3    -1.532984  1.110852  0.513093  5.555428  158.026245 -1.151030 -0.937121  44.616332   2.642519  ... -1.307209 -0.834447  2.335398  1.472005  1363.104130  1241.295161 -15.990103 -16.205959  40.066245
4    -1.532839 -1.201101 -0.261227  3.636952   26.970562 -1.099858 -0.937121  44.616332  16.773604  ... -0.200884 -0.616900 -0.363359  0.941756  1211.912790  1387.740068 -15.993970 -16.203318  38.323176
...        ...       ...       ...       ...         ...       ...       ...        ...        ...  ...       ...       ...       ...       ...          ...          ...        ...        ...        ...
3749  2.404396 -0.315808  0.804150  1.358762    9.876342 -1.355716 -0.725745   9.786866   2.642519  ... -0.477465  0.062936 -0.325348  0.850503  1252.617493  1357.491550 -15.987757 -16.203461  41.195284
3750  2.404541  0.582224  0.771200  1.358762   21.272489 -1.355716  1.599385   7.464902   2.642519  ...  1.063488 -0.916028  0.647725  1.679172  1230.235129  1361.064027 -15.980566 -16.197998  39.452307
3751  2.404686 -0.354022  0.859066  0.639333  -41.406316 -1.355716 -1.571247   7.464902   2.642519  ...  0.273256 -0.426546  0.229607  0.998480  1211.467146  1358.520546 -15.995685 -16.206902  44.390742
3752  2.404831  0.308356  0.903000  1.718476   26.970562 -1.355716  0.965258   9.786866   1.898778  ...  0.865930  0.470837 -1.450464  1.250040  1254.760753  1337.650704 -15.982629 -16.207371  44.390742
3753  2.404975 -1.576873  0.886525  1.478667   26.970562 -1.151030  1.599385   7.464902   2.642519  ...  0.174477  0.226096 -0.910713 -0.214928  1239.397282  1342.397509 -15.984835 -16.211771  45.303730

[3754 rows x 30 columns]
2024-10-23 19:58:07,992 - INFO - home goal predictions: [65.762    60.23429  63.55169  ... 61.96163  61.251472 59.329826]
2024-10-23 21:52:19,410 - INFO - Model directory checked/created.
2024-10-23 21:52:24,899 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-23 21:52:26,439 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 53)
2024-10-23 21:52:26,441 - INFO - Data loaded with 5174 rows
2024-10-23 21:52:26,447 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-23 21:52:26,961 - INFO - new real scores length: 92
2024-10-23 21:52:26,978 - INFO - prediction_df length: 3754
2024-10-23 21:52:26,982 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 21:52:29,780 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-23 21:52:29,782 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 21:52:29,789 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 21:52:29,803 - INFO - Data scaling completed.
2024-10-23 21:52:29,827 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-23 21:56:26,824 - INFO - Feature selection using RFE completed.
2024-10-23 21:56:28,092 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-23 21:59:05,878 - INFO - Stacking model for home_goals trained successfully.
2024-10-23 21:59:07,576 - INFO - home_goals Stacking Model MSE: 0.10630281051303188, R2: 0.9304138645728762, Stacking Model MAE: 0.1626328465671037, Stacking Model MAPE: inf%
2024-10-23 22:09:36,743 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpn5vefuld\assets
2024-10-23 22:09:36,810 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-23 22:09:37,307 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-23 22:09:37,390 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-23 22:09:37,394 - INFO - Start home_goals predictions
2024-10-23 22:09:37,395 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 22:09:37,759 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-23 22:09:37,768 - INFO - [[ 5.43481802e-01  3.95618041e-01 -1.18634233e+00 ...  1.31020333e+03
  -1.61442386e+01  3.23614200e+01]
 [ 9.20760406e-01  1.05622083e+00 -2.34179626e-01 ...  1.29433000e+03
  -1.61371197e+01  4.01589156e+01]
 [-1.89359447e-01  5.41712889e-01  1.65363429e+00 ...  1.20686781e+03
  -1.61495523e+01  4.03748473e+01]
 ...
 [-5.41013219e-01 -7.03269296e-01 -7.84562693e-01 ...  1.27554473e+03
  -1.61465252e+01  5.00061855e+01]
 [-5.41881858e-01 -7.15973196e-01 -7.46035878e-01 ...  1.37149075e+03
  -1.61467799e+01  5.18179731e+01]
 [-5.41157992e-01 -6.96917346e-01 -8.45104830e-01 ...  1.25589108e+03
  -1.61448670e+01  4.31194849e+01]]
2024-10-23 22:09:37,788 - INFO - X_new_prepared:             0         1         2         3         4         5         6          7         8   ...        21        22        23        24        25           26           27         28         29
0     0.543482  0.395618 -1.186342  0.191735  0.276582 -1.511744  1.920401  49.082223 -0.824750  ...  1.448900 -1.961229 -1.380818 -1.809635 -2.665198  1168.557181  1310.203326 -16.144239  32.361420
1     0.920760  1.056221 -0.234180  2.480222  0.517444 -0.808979  7.669334  65.666988  0.183946  ...  2.220837  0.335464 -0.518834  0.307852 -0.837241  1333.900353  1294.329998 -16.137120  40.158916
2    -0.189359  0.541713  1.653634 -0.723660  0.637875  1.861529  2.064124  13.148564  0.275646  ...  1.717400 -0.755465 -0.319915 -1.073265 -0.275833  1057.858718  1206.867814 -16.149552  40.374847
3     1.001544  0.173300 -1.340450 -0.906739  0.397013 -1.511744  2.303663  15.912691  1.926239  ...  4.133900  0.297186 -0.585141 -0.411550 -0.822500  1197.487658  1238.472051 -16.148373  39.174782
4     0.634834  1.430986 -0.014026 -1.364437  0.517444 -1.511744  1.984278  15.912691  0.734144  ...  0.106399  0.552374 -1.778656 -0.615155 -1.215609  1145.984566  1170.837319 -16.149390  38.261435
...        ...       ...       ...       ...       ...       ...       ...        ...       ...  ...       ...       ...       ...       ...       ...          ...          ...        ...        ...
3749 -0.542316  1.145148  1.549062  2.388683  0.999168 -1.256193  5.219789  60.138733 -0.824750  ...  1.497718  0.505220  0.041756 -0.591549  0.718957  1199.034027  1310.451079 -16.146377  47.086588
3750 -0.542461 -0.366616 -0.795570  2.388683  0.999168 -1.511744  3.958659  60.138733 -0.824750  ...  3.310093 -0.259588  0.439595  0.082036  0.618155  1272.737615  1371.247983 -16.147085  53.307050
3751 -0.541013 -0.703269 -0.784563 -1.089818  0.999168 -0.387320  4.742604  13.148564  0.092246  ...  1.959050  0.627771 -0.956457  0.322660  1.067103  1195.981881  1275.544734 -16.146525  50.006186
3752 -0.541882 -0.715973 -0.746036  1.839446  0.999168 -1.256193  5.219789  60.138733 -0.824750  ...  2.266604  0.455292  0.801266 -0.131225  0.443354  1241.455641  1371.490754 -16.146780  51.817973
3753 -0.541158 -0.696917 -0.845105  0.649432  0.999168 -1.256193  5.526550  60.138733 -0.824750  ...  1.168195  0.053597 -0.410333  0.766888 -0.963215  1195.969538  1255.891078 -16.144867  43.119485

[3754 rows x 30 columns]
2024-10-23 22:09:37,929 - INFO - home goal predictions: [ 90.94258  103.338486  77.30436  ...  84.76557   97.03744   94.22114 ]
2024-10-24 17:30:54,177 - INFO - Model directory checked/created.
2024-10-24 17:31:00,063 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 17:31:01,194 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 17:31:01,194 - INFO - Data loaded with 3754 rows
2024-10-24 17:31:01,194 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 17:31:01,695 - INFO - new real scores length: 92
2024-10-24 17:31:01,701 - INFO - prediction_df length: 3754
2024-10-24 17:31:01,704 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 17:31:06,209 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 17:31:06,209 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 17:31:06,209 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 17:31:06,226 - INFO - Data scaling completed.
2024-10-24 17:31:06,246 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 17:35:08,491 - INFO - Feature selection using RFE completed.
2024-10-24 17:35:09,444 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 17:37:46,146 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 17:37:47,645 - INFO - home_goals Stacking Model MSE: 0.10626396676334354, R2: 0.9304392918067683, Stacking Model MAE: 0.16121240656630934, Stacking Model MAPE: inf%
2024-10-24 17:47:42,146 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpqelpcnaz\assets
2024-10-24 17:47:42,227 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 17:47:42,743 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 17:47:42,845 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 17:47:42,862 - INFO - Start home_goals predictions
2024-10-24 17:47:42,862 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 17:47:43,244 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 17:47:43,255 - INFO - [[  0.5434818    0.39561804  -1.18634233 ... -16.13685693 -16.14423857
   32.36142002]
 [  0.92076041   1.05622083  -0.23417963 ... -16.12482123 -16.13711974
   40.1589156 ]
 [ -0.18935945   0.54171289   1.65363429 ... -16.13086527 -16.1495523
   40.37484726]
 ...
 [ -0.54101322  -0.7032693   -0.78456269 ... -16.12929474 -16.14652524
   50.00618552]
 [ -0.54188186  -0.7159732   -0.74603588 ... -16.1270792  -16.14677992
   51.81797313]
 [ -0.54115799  -0.69691735  -0.84510483 ... -16.13156961 -16.14486702
   43.11948486]]
2024-10-24 17:47:43,262 - INFO - X_new_prepared:             0         1         2         3         4         5          6         7         8   ...        21        22        23        24           25           26         27         28         29
0     0.543482  0.395618 -1.186342  0.191735  0.276582  1.920401  49.082223 -0.824750 -0.944406  ... -1.380818 -1.809635 -0.115472 -2.665198  1168.557181  1310.203326 -16.136857 -16.144239  32.361420
1     0.920760  1.056221 -0.234180  2.480222  0.517444  7.669334  65.666988  0.183946 -0.843091  ... -0.518834  0.307852  0.209980 -0.837241  1333.900353  1294.329998 -16.124821 -16.137120  40.158916
2    -0.189359  0.541713  1.653634 -0.723660  0.637875  2.064124  13.148564  0.275646  0.170060  ... -0.319915 -1.073265 -0.824328 -0.275833  1057.858718  1206.867814 -16.130865 -16.149552  40.374847
3     1.001544  0.173300 -1.340450 -0.906739  0.397013  2.303663  15.912691  1.926239 -0.539146  ... -0.585141 -0.411550  0.178485 -0.822500  1197.487658  1238.472051 -16.131977 -16.148373  39.174782
4     0.634834  1.430986 -0.014026 -1.364437  0.517444  1.984278  15.912691  0.734144 -0.437831  ... -1.778656 -0.615155 -2.870266 -1.215609  1145.984566  1170.837319 -16.134046 -16.149390  38.261435
...        ...       ...       ...       ...       ...       ...        ...       ...       ...  ...       ...       ...       ...       ...          ...          ...        ...        ...        ...
3749 -0.542316  1.145148  1.549062  2.388683  0.999168  5.219789  60.138733 -0.824750 -0.640461  ...  0.041756 -0.591549  0.485421  0.718957  1199.034027  1310.451079 -16.130436 -16.146377  47.086588
3750 -0.542461 -0.366616 -0.795570  2.388683  0.999168  3.958659  60.138733 -0.824750  1.183212  ...  0.439595  0.082036 -0.339185  0.618155  1272.737615  1371.247983 -16.124431 -16.147085  53.307050
3751 -0.541013 -0.703269 -0.784563 -1.089818  0.999168  4.742604  13.148564  0.092246 -0.944406  ... -0.956457  0.322660  1.020041  1.067103  1195.981881  1275.544734 -16.129295 -16.146525  50.006186
3752 -0.541882 -0.715973 -0.746036  1.839446  0.999168  5.219789  60.138733 -0.824750 -1.045721  ...  0.801266 -0.131225  0.347987  0.443354  1241.455641  1371.490754 -16.127079 -16.146780  51.817973
3753 -0.541158 -0.696917 -0.845105  0.649432  0.999168  5.526550  60.138733 -0.824750 -0.437831  ... -0.410333  0.766888 -0.284211 -0.963215  1195.969538  1255.891078 -16.131570 -16.144867  43.119485

[3754 rows x 30 columns]
2024-10-24 17:47:43,419 - INFO - home goal predictions: [84.28083  86.5444   74.048584 ... 80.826485 87.38208  84.039635]
2024-10-24 18:17:30,523 - INFO - Model directory checked/created.
2024-10-24 18:17:36,433 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:17:37,548 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:17:37,548 - INFO - Data loaded with 3754 rows
2024-10-24 18:17:37,563 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:17:38,078 - INFO - new real scores length: 92
2024-10-24 18:17:38,082 - INFO - prediction_df length: 3754
2024-10-24 18:17:38,088 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:17:39,814 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 18:17:39,815 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:17:39,815 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:17:39,847 - INFO - Data scaling completed.
2024-10-24 18:17:39,863 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 18:21:08,006 - INFO - Feature selection using RFE completed.
2024-10-24 18:21:08,008 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:21:09,139 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 18:23:40,280 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 18:23:41,632 - INFO - home_goals Stacking Model MSE: 0.10605137776230125, R2: 0.9305784531981318, Stacking Model MAE: 0.1585640924648419, Stacking Model MAPE: inf%
2024-10-24 18:32:50,598 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpa4a9xzym\assets
2024-10-24 18:32:50,665 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 18:32:51,147 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 18:32:51,231 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 18:32:51,248 - INFO - Start home_goals predictions
2024-10-24 18:32:51,248 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:32:51,565 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 18:50:34,164 - INFO - Model directory checked/created.
2024-10-24 18:50:39,140 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:50:40,251 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:50:40,251 - INFO - Data loaded with 3754 rows
2024-10-24 18:50:40,251 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:50:40,733 - INFO - new real scores length: 92
2024-10-24 18:50:40,733 - INFO - prediction_df length: 3754
2024-10-24 18:50:40,749 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:50:51,249 - INFO - Model directory checked/created.
2024-10-24 18:50:56,134 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:50:57,166 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:50:57,166 - INFO - Data loaded with 3754 rows
2024-10-24 18:50:57,166 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:50:57,599 - INFO - new real scores length: 92
2024-10-24 18:50:57,599 - INFO - prediction_df length: 3754
2024-10-24 18:50:57,617 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:50:59,245 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 18:50:59,248 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:50:59,250 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:50:59,250 - INFO - Data scaling completed.
2024-10-24 18:50:59,273 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 18:54:15,102 - INFO - Feature selection using RFE completed.
2024-10-24 18:54:15,114 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:54:16,300 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 18:56:38,480 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 18:56:39,941 - INFO - home_goals Stacking Model MSE: 0.10473661368936762, R2: 0.931439101664455, Stacking Model MAE: 0.15736474730417055, Stacking Model MAPE: inf%
2024-10-24 18:56:40,366 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpqcauqa72\assets
2024-10-24 18:56:40,433 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 18:56:40,950 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 18:56:41,033 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 18:56:41,049 - INFO - Start home_goals predictions
2024-10-24 18:56:41,050 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:56:41,399 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 18:59:45,909 - INFO - Model directory checked/created.
2024-10-24 18:59:51,036 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:59:52,150 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:59:52,150 - INFO - Data loaded with 3754 rows
2024-10-24 18:59:52,150 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:59:52,616 - INFO - new real scores length: 92
2024-10-24 18:59:52,616 - INFO - prediction_df length: 3754
2024-10-24 18:59:52,616 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:59:54,484 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 18:59:54,484 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:59:54,484 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:59:54,501 - INFO - Data scaling completed.
2024-10-24 18:59:54,518 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 19:03:17,760 - INFO - Feature selection using RFE completed.
2024-10-24 19:03:17,762 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:03:18,849 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 19:05:52,193 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 19:05:53,615 - INFO - home_goals Stacking Model MSE: 0.10746362861645792, R2: 0.929653989595334, Stacking Model MAE: 0.16062454982805194, Stacking Model MAPE: inf%
2024-10-24 19:05:54,084 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpz2ig08po\assets
2024-10-24 19:05:54,150 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 19:05:54,699 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 19:05:54,766 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 19:05:54,782 - INFO - Start home_goals predictions
2024-10-24 19:05:54,783 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:05:55,115 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 19:05:55,117 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:08:23,504 - INFO - Model directory checked/created.
2024-10-24 19:08:29,116 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:08:30,423 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:08:30,424 - INFO - Data loaded with 3754 rows
2024-10-24 19:08:30,429 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:08:31,018 - INFO - new real scores length: 92
2024-10-24 19:08:31,021 - INFO - prediction_df length: 3754
2024-10-24 19:08:31,024 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:08:33,349 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 19:08:33,349 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 19:08:33,364 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 19:08:33,366 - INFO - Data scaling completed.
2024-10-24 19:08:33,399 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 19:11:52,533 - INFO - Feature selection using RFE completed.
2024-10-24 19:11:52,533 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:11:53,717 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 19:14:17,517 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 19:14:19,000 - INFO - home_goals Stacking Model MSE: 0.10983296446734697, R2: 0.9281030153116193, Stacking Model MAE: 0.163586362825422, Stacking Model MAPE: inf%
2024-10-24 19:14:19,481 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpn8wrr6wq\assets
2024-10-24 19:14:19,550 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 19:14:20,066 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 19:14:20,201 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 19:14:20,217 - INFO - Start home_goals predictions
2024-10-24 19:14:20,217 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:14:20,534 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 19:14:20,534 - INFO - Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:14:20,534 - INFO - [[ 0.5434818   0.39561804 -1.18634233 ... -2.16563348 -0.92405004
  -0.33507785]
 [ 0.92076041  1.05622083 -0.23417963 ... -0.39152035  1.22310171
  -0.52626905]
 [-0.18935945  0.54171289  1.65363429 ... -1.23422409 -2.36158384
  -1.57973434]
 ...
 [-0.54101322 -0.7032693  -0.78456269 ... -0.16572414 -0.567912
  -0.75253396]
 [-0.54188186 -0.7159732  -0.74603588 ... -0.29895793  0.02261171
   0.40311751]
 [-0.54115799 -0.69691735 -0.84510483 ... -0.60925242 -0.56807229
  -0.98925849]]
2024-10-24 19:14:20,566 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     0.543482  0.395618 -1.186342  0.191735 -0.566434 -1.528959 -0.672074 -0.824750 -0.944406  0.109982  ...  0.576274  0.105795 -1.380818 -1.809635 -0.115472 -2.665198 -0.272392 -2.165633 -0.924050 -0.335078
1     0.920760  1.056221 -0.234180  2.480222  0.637875  0.770614 -0.326558  0.183946 -0.843091  1.132817  ... -0.900476  0.565134 -0.518834  0.307852  0.209980 -0.837241  0.253626 -0.391520  1.223102 -0.526269
2    -0.189359  0.541713  1.653634 -0.723660 -4.179359 -0.810342  0.986402  0.275646  0.170060  0.198924  ... -1.424051  0.105795 -0.319915 -1.073265 -0.824328 -0.275833 -0.089429 -1.234224 -2.361584 -1.579734
3     1.001544  0.173300 -1.340450 -0.906739 -0.325572 -0.570803 -0.672074  1.926239 -0.539146  2.911662  ... -0.699101  0.297186 -0.585141 -0.411550  0.178485 -0.822500  1.557233 -0.421089 -0.548358 -1.199067
4     0.634834  1.430986 -0.014026 -1.364437 -2.372896 -0.890189 -0.672074  0.734144 -0.437831 -0.334730  ... -0.900476  2.019706 -1.778656 -0.615155 -2.870266 -1.215609 -1.187204 -0.223965 -1.217179 -2.013715
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
3749 -0.542316  1.145148  1.549062  2.388683 -0.205141 -0.029237 -0.546432 -0.824750 -0.640461 -1.668863  ... -0.699101 -0.193774  0.041756 -0.591549  0.485421  0.718957 -0.239126 -0.260390 -0.528277 -0.332094
3750 -0.542461 -0.366616 -0.795570  2.388683 -0.686864  0.038932 -0.672074 -0.824750  1.183212  0.109982  ...  0.234547 -0.624971  0.439595  0.082036 -0.339185  0.618155  0.995871 -0.851177  0.428840  0.400193
3751 -0.541013 -0.703269 -0.784563 -1.089818 -0.927726  0.038932 -0.119249  0.092246 -0.944406 -0.512614  ...  0.267499  0.210190 -0.956457  0.322660  1.020041  1.067103  0.075237 -0.165724 -0.567912 -0.752534
3752 -0.541882 -0.715973 -0.746036  1.839446 -0.205141 -0.029237 -0.546432 -0.824750 -1.045721 -0.557085  ... -0.589260 -0.143846  0.801266 -0.131225  0.347987  0.443354  0.284812 -0.298958  0.022612  0.403118
3753 -0.541158 -0.696917 -0.845105  0.649432 -0.686864  0.038932 -0.546432 -0.824750 -0.437831 -0.734970  ... -0.259737  0.105795 -0.410333  0.766888 -0.284211 -0.963215 -0.463671 -0.609252 -0.568072 -0.989258

[3754 rows x 30 columns]
2024-10-24 19:14:20,683 - INFO - home goal predictions: [ 0.13441214 -0.06190029  3.2794077  ... -0.00738108 -0.14134717
 -0.06439912]
2024-10-24 19:16:07,634 - INFO - Model directory checked/created.
2024-10-24 19:16:12,872 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:16:19,051 - INFO - Model directory checked/created.
2024-10-24 19:16:24,201 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:16:25,300 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:16:25,300 - INFO - Data loaded with 3754 rows
2024-10-24 19:16:25,300 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:16:25,752 - INFO - new real scores length: 92
2024-10-24 19:16:25,752 - INFO - prediction_df length: 3754
2024-10-24 19:16:25,770 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:16:27,618 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 19:16:27,650 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 19:16:27,651 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 19:16:27,669 - INFO - Data scaling completed.
2024-10-24 19:16:27,766 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 19:20:26,087 - INFO - Feature selection using RFE completed.
2024-10-24 19:20:26,090 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-24 19:20:27,251 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 19:23:00,351 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 19:23:01,905 - INFO - home_goals Stacking Model MSE: 0.10524071174264615, R2: 0.931109117581864, Stacking Model MAE: 0.161831492721106, Stacking Model MAPE: inf%
2024-10-24 19:23:02,476 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpx5ixsogq\assets
2024-10-24 19:23:02,557 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 19:23:03,114 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 19:23:03,215 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 19:23:03,217 - INFO - Start home_goals predictions
2024-10-24 19:23:03,219 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:23:03,584 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 19:23:03,584 - INFO - Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:23:03,601 - INFO - [[ 0.5434818   0.39561804 -1.18634233 ... -0.92405004 -0.33507785
  -1.60158079]
 [ 0.92076041  1.05622083 -0.23417963 ...  1.22310171 -0.52626905
   0.465453  ]
 [-0.18935945  0.54171289  1.65363429 ... -2.36158384 -1.57973434
  -0.5725624 ]
 ...
 [-0.54101322 -0.7032693  -0.78456269 ... -0.567912   -0.75253396
  -0.30283523]
 [-0.54188186 -0.7159732  -0.74603588 ...  0.02261171  0.40311751
   0.07766439]
 [-0.54115799 -0.69691735 -0.84510483 ... -0.56807229 -0.98925849
  -0.6935269 ]]
2024-10-24 19:23:03,623 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     0.543482  0.395618 -1.186342  0.191735 -0.566434  1.299317 -1.528959 -0.672074 -0.824750 -0.944406  ...  0.693691  0.576274  0.105795 -1.380818 -1.809635 -2.665198 -0.272392 -0.924050 -0.335078 -1.601581
1     0.920760  1.056221 -0.234180  2.480222  0.637875 -0.574724  0.770614 -0.326558  0.183946 -0.843091  ...  0.736151 -0.900476  0.565134 -0.518834  0.307852 -0.837241  0.253626  1.223102 -0.526269  0.465453
2    -0.189359  0.541713  1.653634 -0.723660 -4.179359  0.737104 -0.810342  0.986402  0.275646  0.170060  ... -0.341263 -1.424051  0.105795 -0.319915 -1.073265 -0.275833 -0.089429 -2.361584 -1.579734 -0.572562
3     1.001544  0.173300 -1.340450 -0.906739 -0.325572 -1.511744 -0.570803 -0.672074  1.926239 -0.539146  ...  0.035566 -0.699101  0.297186 -0.585141 -0.411550 -0.822500  1.557233 -0.548358 -1.199067 -0.763418
4     0.634834  1.430986 -0.014026 -1.364437 -2.372896 -0.574724 -0.890189 -0.672074  0.734144 -0.437831  ... -0.749938 -0.900476  2.019706 -1.778656 -0.615155 -1.215609 -1.187204 -1.217179 -2.013715 -1.118876
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
3749 -0.542316  1.145148  1.549062  2.388683 -0.205141  0.788215 -0.029237 -0.546432 -0.824750 -0.640461  ...  2.009941 -0.699101 -0.193774  0.041756 -0.591549  0.718957 -0.239126 -0.528277 -0.332094 -0.498917
3750 -0.542461 -0.366616 -0.795570  2.388683 -0.686864 -0.745091  0.038932 -0.672074 -0.824750  1.183212  ... -0.728708  0.234547 -0.624971  0.439595  0.082036  0.618155  0.995871  0.428840  0.400193  0.532530
3751 -0.541013 -0.703269 -0.784563 -1.089818 -0.927726 -0.387320  0.038932 -0.119249  0.092246 -0.944406  ...  0.465470  0.267499  0.210190 -0.956457  0.322660  1.067103  0.075237 -0.567912 -0.752534 -0.302835
3752 -0.541882 -0.715973 -0.746036  1.839446 -0.205141  0.788215 -0.029237 -0.546432 -0.824750 -1.045721  ... -1.477060 -0.589260 -0.143846  0.801266 -0.131225  0.443354  0.284812  0.022612  0.403118  0.077664
3753 -0.541158 -0.696917 -0.845105  0.649432 -0.686864  0.532664  0.038932 -0.546432 -0.824750 -0.437831  ... -0.325341 -0.259737  0.105795 -0.410333  0.766888 -0.963215 -0.463671 -0.568072 -0.989258 -0.693527

[3754 rows x 30 columns]
2024-10-24 19:23:03,892 - INFO - home goal predictions: [0.1676853  0.61797094 3.191977   ... 0.29207325 0.7153865  0.01563209]
2024-10-24 19:51:13,020 - INFO - Model directory checked/created.
2024-10-24 19:51:18,655 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:51:19,837 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:51:19,862 - INFO - Data loaded with 3754 rows
2024-10-24 19:51:19,866 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:51:20,389 - INFO - new real scores length: 92
2024-10-24 19:51:20,393 - INFO - prediction_df length: 3754
2024-10-24 19:51:20,396 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:51:22,334 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 19:51:22,336 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 19:51:22,345 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 19:51:22,367 - INFO - Data scaling completed.
2024-10-24 19:51:22,392 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 19:55:27,460 - INFO - Feature selection using RFE completed.
2024-10-24 19:55:27,462 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-24 19:55:28,472 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 19:57:59,991 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 19:58:01,453 - INFO - home_goals Stacking Model MSE: 0.1080296688292752, R2: 0.9292834579911722, Stacking Model MAE: 0.16306891887301006, Stacking Model MAPE: inf%
2024-10-24 19:58:01,953 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp98aldw8t\assets
2024-10-24 19:58:02,021 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 19:58:02,615 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 19:58:02,703 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 19:58:02,703 - INFO - Start home_goals predictions
2024-10-24 19:58:02,703 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:58:03,123 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-24 19:58:03,125 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:58:03,131 - INFO - [[ 0.5434818   0.39561804 -1.18634233 ... -0.92405004 -0.33507785
  -1.60158079]
 [ 0.92076041  1.05622083 -0.23417963 ...  1.22310171 -0.52626905
   0.465453  ]
 [-0.18935945  0.54171289  1.65363429 ... -2.36158384 -1.57973434
  -0.5725624 ]
 ...
 [-0.54101322 -0.7032693  -0.78456269 ... -0.567912   -0.75253396
  -0.30283523]
 [-0.54188186 -0.7159732  -0.74603588 ...  0.02261171  0.40311751
   0.07766439]
 [-0.54115799 -0.69691735 -0.84510483 ... -0.56807229 -0.98925849
  -0.6935269 ]]
2024-10-24 19:58:03,155 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     0.543482  0.395618 -1.186342  0.191735 -0.566434 -1.528959 -0.672074 -0.824750 -0.944406  0.109982  ...  0.576274  0.105795 -1.380818 -1.809635 -0.115472 -2.665198 -0.272392 -0.924050 -0.335078 -1.601581
1     0.920760  1.056221 -0.234180  2.480222  0.637875  0.770614 -0.326558  0.183946 -0.843091  1.132817  ... -0.900476  0.565134 -0.518834  0.307852  0.209980 -0.837241  0.253626  1.223102 -0.526269  0.465453
2    -0.189359  0.541713  1.653634 -0.723660 -4.179359 -0.810342  0.986402  0.275646  0.170060  0.198924  ... -1.424051  0.105795 -0.319915 -1.073265 -0.824328 -0.275833 -0.089429 -2.361584 -1.579734 -0.572562
3     1.001544  0.173300 -1.340450 -0.906739 -0.325572 -0.570803 -0.672074  1.926239 -0.539146  2.911662  ... -0.699101  0.297186 -0.585141 -0.411550  0.178485 -0.822500  1.557233 -0.548358 -1.199067 -0.763418
4     0.634834  1.430986 -0.014026 -1.364437 -2.372896 -0.890189 -0.672074  0.734144 -0.437831 -0.334730  ... -0.900476  2.019706 -1.778656 -0.615155 -2.870266 -1.215609 -1.187204 -1.217179 -2.013715 -1.118876
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
3749 -0.542316  1.145148  1.549062  2.388683 -0.205141 -0.029237 -0.546432 -0.824750 -0.640461 -1.668863  ... -0.699101 -0.193774  0.041756 -0.591549  0.485421  0.718957 -0.239126 -0.528277 -0.332094 -0.498917
3750 -0.542461 -0.366616 -0.795570  2.388683 -0.686864  0.038932 -0.672074 -0.824750  1.183212  0.109982  ...  0.234547 -0.624971  0.439595  0.082036 -0.339185  0.618155  0.995871  0.428840  0.400193  0.532530
3751 -0.541013 -0.703269 -0.784563 -1.089818 -0.927726  0.038932 -0.119249  0.092246 -0.944406 -0.512614  ...  0.267499  0.210190 -0.956457  0.322660  1.020041  1.067103  0.075237 -0.567912 -0.752534 -0.302835
3752 -0.541882 -0.715973 -0.746036  1.839446 -0.205141 -0.029237 -0.546432 -0.824750 -1.045721 -0.557085  ... -0.589260 -0.143846  0.801266 -0.131225  0.347987  0.443354  0.284812  0.022612  0.403118  0.077664
3753 -0.541158 -0.696917 -0.845105  0.649432 -0.686864  0.038932 -0.546432 -0.824750 -0.437831 -0.734970  ... -0.259737  0.105795 -0.410333  0.766888 -0.284211 -0.963215 -0.463671 -0.568072 -0.989258 -0.693527

[3754 rows x 30 columns]
2024-10-24 19:58:03,375 - INFO - home goal predictions: [0.3339831  0.6521524  3.5299444  ... 0.10426337 0.70722747 0.00758499]
2024-10-24 20:48:29,381 - INFO - Model directory checked/created.
2024-10-24 20:48:34,376 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 20:48:35,454 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 20:48:35,456 - INFO - Data loaded with 3754 rows
2024-10-24 20:48:35,461 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:01:27,141 - INFO - Model directory checked/created.
2024-10-24 21:01:32,032 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:01:33,111 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:01:33,113 - INFO - Data loaded with 3754 rows
2024-10-24 21:01:33,119 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:01:47,248 - INFO - Model directory checked/created.
2024-10-24 21:01:52,162 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:01:53,264 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:01:53,281 - INFO - Data loaded with 3754 rows
2024-10-24 21:01:53,281 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:02:08,831 - INFO - Model directory checked/created.
2024-10-24 21:02:13,715 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:02:14,814 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:02:14,814 - INFO - Data loaded with 3754 rows
2024-10-24 21:02:14,830 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:02:15,167 - INFO - new real scores length: 21
2024-10-24 21:03:58,264 - INFO - Model directory checked/created.
2024-10-24 21:04:03,067 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:04:04,098 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:04:04,098 - INFO - Data loaded with 3754 rows
2024-10-24 21:04:04,115 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:04:04,398 - INFO - new real scores length: 21
2024-10-24 21:04:39,449 - INFO - Model directory checked/created.
2024-10-24 21:04:44,199 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:04:45,252 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:04:45,255 - INFO - Data loaded with 3754 rows
2024-10-24 21:04:45,259 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:04:45,531 - INFO - new real scores length: 21
2024-10-24 21:04:45,548 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:04:45,548 - INFO - data_with_error length: 0
2024-10-24 21:04:45,548 - INFO - prediction_df length: 3754
2024-10-24 21:04:45,548 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 21:04:47,232 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 21:04:47,232 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 21:04:47,251 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 21:04:47,261 - INFO - Data scaling completed.
2024-10-24 21:04:47,274 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 21:08:34,048 - INFO - Feature selection using RFE completed.
2024-10-24 21:08:34,048 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-24 21:08:35,215 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 21:10:52,098 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 21:10:53,417 - INFO - home_goals Stacking Model MSE: 0.10778943319672879, R2: 0.9294407169496147, Stacking Model MAE: 0.16301849459787418, Stacking Model MAPE: inf%
2024-10-24 21:10:53,882 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmphcp0v8ro\assets
2024-10-24 21:10:53,969 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 21:10:54,448 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 21:10:54,555 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 21:10:54,556 - INFO - Start home_goals predictions
2024-10-24 21:10:54,558 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 21:15:04,748 - INFO - Model directory checked/created.
2024-10-24 21:15:09,538 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:15:10,582 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:15:10,582 - INFO - Data loaded with 3754 rows
2024-10-24 21:15:10,599 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:15:10,883 - INFO - new real scores length: 21
2024-10-24 21:15:10,899 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:15:10,899 - INFO - data_with_error length: 0
2024-10-24 21:15:10,913 - INFO - prediction_df length: 3754
2024-10-24 21:15:10,915 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 21:15:12,631 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 21:15:12,632 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 21:15:12,632 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 21:15:12,649 - INFO - Data scaling completed.
2024-10-24 21:15:12,671 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 21:16:21,631 - INFO - Model directory checked/created.
2024-10-24 21:16:26,416 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:16:27,449 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:16:27,449 - INFO - Data loaded with 3754 rows
2024-10-24 21:16:27,467 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:16:27,749 - INFO - new real scores length: 21
2024-10-24 21:16:27,749 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:16:27,768 - INFO - data_with_error length: 0
2024-10-24 21:16:27,773 - INFO - prediction_df length: 3754
2024-10-24 21:16:27,776 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 21:16:29,515 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 21:16:29,515 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 21:16:29,533 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 21:16:29,533 - INFO - Data scaling completed.
2024-10-24 21:16:29,549 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 21:18:31,615 - INFO - Model directory checked/created.
2024-10-24 21:18:36,349 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:18:37,382 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:18:37,382 - INFO - Data loaded with 3754 rows
2024-10-24 21:18:37,382 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:18:37,665 - INFO - new real scores length: 21
2024-10-24 21:18:37,682 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:18:37,693 - INFO - data_with_error length: 0
2024-10-24 21:18:37,697 - INFO - prediction_df length: 3754
2024-10-24 21:18:37,701 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 21:18:39,499 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 21:18:39,499 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 21:18:39,499 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 21:18:39,518 - INFO - Data scaling completed.
2024-10-24 21:18:39,533 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 21:19:49,389 - INFO - Model directory checked/created.
2024-10-24 21:19:54,241 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:19:55,349 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:19:55,349 - INFO - Data loaded with 3754 rows
2024-10-24 21:19:55,363 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:19:55,654 - INFO - new real scores length: 21
2024-10-24 21:19:55,669 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:19:55,673 - INFO - data_with_error length: 0
2024-10-24 21:19:55,676 - INFO - prediction_df length: 3754
2024-10-24 21:19:55,679 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 21:21:07,454 - INFO - Model directory checked/created.
2024-10-24 21:21:12,249 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:21:13,341 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:21:13,343 - INFO - Data loaded with 3754 rows
2024-10-24 21:21:13,351 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:21:13,642 - INFO - new real scores length: 21
2024-10-24 21:21:13,654 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:21:33,027 - INFO - Model directory checked/created.
2024-10-24 21:21:37,816 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 21:21:38,865 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 21:21:38,865 - INFO - Data loaded with 3754 rows
2024-10-24 21:21:38,865 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 21:21:39,149 - INFO - new real scores length: 21
2024-10-24 21:21:39,169 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-24 21:21:39,174 - INFO - data_with_error length: 0
2024-10-24 21:21:39,174 - INFO - prediction_df length: 3754
2024-10-24 21:21:39,183 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 21:21:40,832 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-24 21:21:40,832 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 21:21:40,849 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 21:21:40,849 - INFO - Data scaling completed.
2024-10-24 21:21:40,866 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-24 21:25:25,618 - INFO - Feature selection using RFE completed.
2024-10-24 21:25:25,621 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-24 21:25:26,818 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-24 21:27:44,576 - INFO - Stacking model for home_goals trained successfully.
2024-10-24 21:27:45,924 - INFO - home_goals Stacking Model MSE: 0.10746951707634762, R2: 0.9296501349920044, Stacking Model MAE: 0.16177170124045856, Stacking Model MAPE: inf%
2024-10-24 21:27:46,375 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpx0khm961\assets
2024-10-24 21:27:46,440 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-24 21:27:46,951 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-24 21:27:47,037 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-24 21:27:47,039 - INFO - Start home_goals predictions
2024-10-25 00:36:25,175 - INFO - Model directory checked/created.
2024-10-25 00:36:30,014 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:36:46,048 - INFO - Model directory checked/created.
2024-10-25 00:36:51,098 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:36:51,218 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:36:51,218 - INFO - Data loaded with 5111 rows
2024-10-25 00:36:51,231 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:36:51,580 - INFO - new real scores length: 26
2024-10-25 00:36:51,597 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:36:51,608 - INFO - data_with_error length: 0
2024-10-25 00:36:51,614 - INFO - prediction_df length: 4613
2024-10-25 00:36:51,620 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:36:53,423 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:36:53,426 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:36:53,431 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:36:53,443 - INFO - Data scaling completed.
2024-10-25 00:36:53,463 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 00:40:39,363 - INFO - Feature selection using RFE completed.
2024-10-25 00:40:39,363 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:40:40,210 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 00:43:04,729 - INFO - Stacking model for home_goals trained successfully.
2024-10-25 00:43:06,135 - INFO - home_goals Stacking Model MSE: 0.10804242623108908, R2: 0.9292751069580618, Stacking Model MAE: 0.15966426347553442, Stacking Model MAPE: inf%
2024-10-25 00:43:06,598 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpdgoax25q\assets
2024-10-25 00:43:06,677 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-25 00:43:07,212 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-25 00:43:07,295 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-25 00:43:07,298 - INFO - Start home_goals predictions
2024-10-25 00:43:07,636 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 00:43:07,638 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:46:15,647 - INFO - Model directory checked/created.
2024-10-25 00:46:20,520 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:46:20,632 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:46:20,634 - INFO - Data loaded with 5111 rows
2024-10-25 00:46:20,638 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:46:20,921 - INFO - new real scores length: 26
2024-10-25 00:46:20,935 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:46:20,943 - INFO - data_with_error length: 13524
2024-10-25 00:46:20,949 - INFO - prediction_df length: 4613
2024-10-25 00:46:20,952 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:46:22,693 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:46:22,694 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:46:22,701 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:46:22,715 - INFO - Data scaling completed.
2024-10-25 00:46:22,729 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 00:47:25,365 - INFO - Model directory checked/created.
2024-10-25 00:47:30,164 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:47:30,252 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:47:30,255 - INFO - Data loaded with 5111 rows
2024-10-25 00:47:30,259 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:47:30,548 - INFO - new real scores length: 26
2024-10-25 00:47:30,560 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:47:30,566 - INFO - data_with_error length: 26
2024-10-25 00:47:30,572 - INFO - prediction_df length: 4613
2024-10-25 00:47:30,575 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:47:32,264 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:47:32,279 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:47:32,281 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:47:32,281 - INFO - Data scaling completed.
2024-10-25 00:47:32,299 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 00:51:20,985 - INFO - Feature selection using RFE completed.
2024-10-25 00:51:20,985 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:51:21,813 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 00:53:41,980 - INFO - Stacking model for home_goals trained successfully.
2024-10-25 00:53:43,353 - INFO - home_goals Stacking Model MSE: 0.1088779022223058, R2: 0.9287282018932725, Stacking Model MAE: 0.16357878393760614, Stacking Model MAPE: inf%
2024-10-25 00:53:43,798 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp_kun2lkj\assets
2024-10-25 00:53:43,865 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-25 00:53:44,349 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-25 00:53:44,415 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-25 00:53:44,430 - INFO - Start home_goals predictions
2024-10-25 00:53:44,433 - INFO - columns of Prediction_df: Index(['running_id', 'Date', 'season_encoded', 'league_encoded',
       'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins sszege', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 00:54:07,769 - INFO - Model directory checked/created.
2024-10-25 00:54:12,715 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:54:12,832 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:54:12,832 - INFO - Data loaded with 5111 rows
2024-10-25 00:54:12,832 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:54:13,132 - INFO - new real scores length: 26
2024-10-25 00:54:13,149 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:54:13,153 - INFO - data_with_error length: 26
2024-10-25 00:54:13,155 - INFO - prediction_df length: 5111
2024-10-25 00:54:13,155 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:54:14,944 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:54:14,947 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:54:14,950 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:54:14,966 - INFO - Data scaling completed.
2024-10-25 00:54:14,966 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 00:54:27,881 - INFO - Model directory checked/created.
2024-10-25 00:54:32,760 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:54:32,848 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:54:32,850 - INFO - Data loaded with 5111 rows
2024-10-25 00:54:32,855 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:54:33,139 - INFO - new real scores length: 26
2024-10-25 00:54:33,150 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:54:33,154 - INFO - data_with_error length: 26
2024-10-25 00:54:33,158 - INFO - prediction_df length: 5111
2024-10-25 00:54:33,161 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:54:35,043 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:54:35,045 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:54:35,050 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:54:35,061 - INFO - Data scaling completed.
2024-10-25 00:54:35,074 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 00:57:55,465 - INFO - Model directory checked/created.
2024-10-25 00:58:00,166 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:58:00,282 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:58:00,282 - INFO - Data loaded with 5111 rows
2024-10-25 00:58:00,282 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:58:00,577 - INFO - new real scores length: 26
2024-10-25 00:58:00,582 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:58:00,582 - INFO - data_with_error length: 26
2024-10-25 00:58:00,600 - INFO - prediction_df length: 5111
2024-10-25 00:58:00,604 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:58:02,245 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:58:02,247 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:58:02,247 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:58:02,265 - INFO - Data scaling completed.
2024-10-25 00:58:02,280 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 00:58:39,141 - INFO - Model directory checked/created.
2024-10-25 00:58:43,905 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 00:58:44,016 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 00:58:44,016 - INFO - Data loaded with 5111 rows
2024-10-25 00:58:44,030 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 00:58:44,314 - INFO - new real scores length: 26
2024-10-25 00:58:44,315 - INFO - New score dataframe created with errors:     running_id  home_goals_prediction_rounded  away_goals_prediction_rounded  real_home_goals  real_away_goals  home_error  away_error
8         6429                            1.0                            0.0                5                1         4.0         1.0
9         6950                            2.0                            1.0                4                1         2.0         0.0
10        6951                            0.0                            2.0                2                3         2.0         1.0
11        7979                            1.0                            0.0                1                0         0.0         0.0
12       18186                            3.0                            1.0                2                1        -1.0         0.0
2024-10-25 00:58:44,331 - INFO - data_with_error length: 26
2024-10-25 00:58:44,334 - INFO - prediction_df length: 5111
2024-10-25 00:58:44,340 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 00:58:45,998 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 00:58:46,014 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 00:58:46,015 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 00:58:46,031 - INFO - Data scaling completed.
2024-10-25 00:58:46,032 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 01:02:31,099 - INFO - Feature selection using RFE completed.
2024-10-25 01:02:31,099 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:02:31,932 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 01:04:52,149 - INFO - Stacking model for home_goals trained successfully.
2024-10-25 01:04:53,481 - INFO - home_goals Stacking Model MSE: 0.10719267248739071, R2: 0.9298313582820233, Stacking Model MAE: 0.16293100111226727, Stacking Model MAPE: inf%
2024-10-25 01:04:53,916 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmprmqd0z1z\assets
2024-10-25 01:04:53,999 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-25 01:04:54,448 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-25 01:04:54,541 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-25 01:04:54,542 - INFO - Start home_goals predictions
2024-10-25 01:04:54,544 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 01:07:12,523 - INFO - Model directory checked/created.
2024-10-25 01:07:17,300 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 01:07:17,382 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 01:07:17,382 - INFO - Data loaded with 5111 rows
2024-10-25 01:07:17,399 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 01:07:48,649 - INFO - Model directory checked/created.
2024-10-25 01:07:53,551 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 01:07:53,649 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 01:07:53,649 - INFO - Data loaded with 5111 rows
2024-10-25 01:07:53,649 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 01:07:53,949 - INFO - new real scores length: 26
2024-10-25 01:07:53,966 - INFO - data_with_error length: 0
2024-10-25 01:07:53,966 - INFO - prediction_df length: 5111
2024-10-25 01:07:53,966 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:07:55,649 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 01:07:55,664 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 01:07:55,666 - INFO - Data split into train and test. Train shape: (9466, 50), Test shape: (4058, 50)
2024-10-25 01:07:55,666 - INFO - Data scaling completed.
2024-10-25 01:07:55,697 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 01:11:07,081 - INFO - Feature selection using RFE completed.
2024-10-25 01:11:07,098 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:11:07,732 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 01:13:05,982 - INFO - Stacking model for home_goals trained successfully.
2024-10-25 01:13:07,782 - INFO - home_goals Stacking Model MSE: 0.10781805801104623, R2: 0.928795452101998, Stacking Model MAE: 0.16007522887341097, Stacking Model MAPE: inf%
2024-10-25 01:13:08,216 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpo88222sj\assets
2024-10-25 01:13:08,287 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-25 01:13:08,748 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-25 01:13:08,816 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-25 01:13:08,831 - INFO - Start home_goals predictions
2024-10-25 01:13:08,837 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 01:13:09,199 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 01:13:09,199 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:13:09,215 - INFO - [[ 1.61463827  1.16023196  1.6022664  ... -1.03592823 -1.00335916
  -0.54817892]
 [ 1.61478301  0.07298904  1.36578071 ... -1.03592823  1.31389006
  -0.54817892]
 [ 1.61492775  0.71516176  1.36578071 ... -0.0960097   1.31389006
   0.94407361]
 ...
 [-0.96546964 -1.39574262 -1.39505223 ... -0.23218712  0.24715605
  -0.32562362]
 [-0.96387752 -0.48652778 -1.39505223 ... -0.1282611   0.24715605
   2.50557804]
 [-0.96300909 -0.75992805 -1.39505223 ...  1.35025756  0.24715605
  -0.82288521]]
2024-10-25 01:13:09,237 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     1.614638  1.160232  1.602266 -0.906300 -0.705463 -0.671334 -0.828090 -1.342980 -1.670978 -1.582935  ...  0.034329 -0.162389 -0.063883 -0.447241 -0.314553 -0.304014 -0.032066 -1.035928 -1.003359 -0.548179
1     1.614783  0.072989  1.365781  0.189689 -0.705463  0.512403 -0.828090 -1.342980 -1.670978 -1.582935  ... -0.037685 -0.269414 -0.059991 -0.261870  0.511752 -0.339155  0.701670 -1.035928  1.313890 -0.548179
2     1.614928  0.715162  1.365781  0.189689 -0.569280  0.512403 -0.828090 -1.342980 -1.670978 -1.582935  ... -0.467452 -0.247589  0.120238  0.315544  0.485393  0.089400  0.701670 -0.096010  1.313890  0.944074
3     1.615072  0.378180  1.602266 -0.906300 -0.569280 -0.671334 -0.828090 -1.342980 -1.670978 -1.582935  ... -0.244528 -0.136585 -0.038713 -0.269857 -0.377399 -0.028255 -0.032066 -0.182225 -1.003359 -0.557489
4     1.615217  0.740594  1.602266 -0.906300 -0.705463 -0.671334 -0.828090 -1.342980 -1.670978 -1.582935  ... -0.585280 -0.264061  0.059409 -0.016185 -0.286727  0.775073 -0.032066  1.009641 -1.003359  0.646178
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
5106 -0.968220  1.147516 -1.395052 -0.814967  1.337284  0.019179  1.114002 -0.236189 -0.335373  0.539658  ...  2.693389 -0.141541  2.570229 -1.306429  3.385047  0.324231  0.477237 -0.167523  0.247156  1.709971
5107 -0.966193 -0.403872 -1.395052 -0.814967 -1.522562  0.019179  1.114002 -0.839893 -0.335373 -0.054668  ...  0.966519 -0.344774  2.570229  1.325126  3.385047  1.879262  0.477237 -0.232187  0.247156 -0.325624
5108 -0.965470 -1.395743 -1.395052 -0.814967 -1.522562  0.019179  1.114002 -0.839893 -0.335373 -0.054668  ...  0.966519 -0.344774  2.570229  1.325126  3.385047  1.879262  0.477237 -0.232187  0.247156 -0.325624
5109 -0.963878 -0.486528 -1.395052 -0.814967 -1.522562  0.019179  1.114002 -0.336807 -0.335373 -0.733898  ... -1.623786 -1.665785  2.570229 -1.084044  3.385047  0.324231  0.477237 -0.128261  0.247156  2.505578
5110 -0.963009 -0.759928 -1.395052 -0.814967 -0.092639  0.019179  1.114002 -0.638658 -0.335373  0.539658  ... -0.472540 -0.649622  2.570229  1.510447  3.385047  0.324231  0.477237  1.350258  0.247156 -0.822885

[5111 rows x 30 columns]
2024-10-25 01:13:09,400 - INFO - home goal predictions: [1.2321591  0.84273213 0.56164604 ... 2.0192485  1.3821094  2.1194696 ]
2024-10-25 01:14:06,398 - INFO - Model directory checked/created.
2024-10-25 01:14:11,334 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 01:14:11,435 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 01:14:11,435 - INFO - Data loaded with 5111 rows
2024-10-25 01:14:11,450 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 01:14:11,751 - INFO - new real scores length: 26
2024-10-25 01:14:11,759 - INFO - data_with_error length: 0
2024-10-25 01:14:11,762 - INFO - prediction_df length: 5111
2024-10-25 01:14:11,767 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:14:13,599 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 01:14:13,599 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 01:14:13,617 - INFO - Data split into train and test. Train shape: (9466, 50), Test shape: (4058, 50)
2024-10-25 01:14:13,627 - INFO - Data scaling completed.
2024-10-25 01:14:13,640 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 01:17:29,083 - INFO - Feature selection using RFE completed.
2024-10-25 01:17:29,100 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:17:29,765 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 01:19:30,732 - INFO - Stacking model for home_goals trained successfully.
2024-10-25 01:19:32,551 - INFO - home_goals Stacking Model MSE: 0.10761924432575222, R2: 0.9289267514301295, Stacking Model MAE: 0.16028782708083217, Stacking Model MAPE: inf%
2024-10-25 01:19:32,983 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmptkfgut76\assets
2024-10-25 01:19:33,070 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-25 01:19:33,549 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-25 01:19:33,634 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-25 01:19:33,647 - INFO - Start home_goals predictions
2024-10-25 01:19:33,650 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 01:19:33,932 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 01:19:33,932 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 01:19:33,949 - INFO - [[ 1.61463827  1.16023196  1.6022664  ... -1.03592823 -1.00335916
  -0.54817892]
 [ 1.61478301  0.07298904  1.36578071 ... -1.03592823  1.31389006
  -0.54817892]
 [ 1.61492775  0.71516176  1.36578071 ... -0.0960097   1.31389006
   0.94407361]
 ...
 [-0.96546964 -1.39574262 -1.39505223 ... -0.23218712  0.24715605
  -0.32562362]
 [-0.96387752 -0.48652778 -1.39505223 ... -0.1282611   0.24715605
   2.50557804]
 [-0.96300909 -0.75992805 -1.39505223 ...  1.35025756  0.24715605
  -0.82288521]]
2024-10-25 01:19:33,983 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     1.614638  1.160232  1.602266 -0.906300 -0.687742  1.862208 -0.705463 -0.671334 -1.342980 -1.670978  ... -0.112950  0.034329 -0.211862 -0.447241 -0.314553 -0.304014 -0.032066 -1.035928 -1.003359 -0.548179
1     1.614783  0.072989  1.365781  0.189689 -0.687742 -1.511670 -0.705463  0.512403 -1.342980 -1.670978  ... -0.236002 -0.037685 -0.465462 -0.261870  0.511752 -0.339155  0.701670 -1.035928  1.313890 -0.548179
2     1.614928  0.715162  1.365781  0.189689  0.522416 -1.511670 -0.569280  0.512403 -1.342980 -1.670978  ... -0.845000 -0.467452 -0.436070  0.315544  0.485393  0.089400  0.701670 -0.096010  1.313890  0.944074
3     1.615072  0.378180  1.602266 -0.906300 -0.082663  1.862208 -0.569280 -0.671334 -1.342980 -1.670978  ... -0.283104 -0.244528 -0.307408 -0.269857 -0.377399 -0.028255 -0.032066 -0.182225 -1.003359 -0.557489
4     1.615217  0.740594  1.602266 -0.906300  1.006480  1.862208 -0.705463 -0.671334 -1.342980 -1.670978  ... -0.483328 -0.585280 -0.207589 -0.016185 -0.286727  0.775073 -0.032066  1.009641 -1.003359  0.646178
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
5106 -0.968220  1.147516 -1.395052 -0.814967  0.764448 -0.105887  1.337284  0.019179 -0.236189 -0.335373  ... -0.093019  2.693389 -2.597465 -1.306429  3.385047  0.324231  0.477237 -0.167523  0.247156  1.709971
5107 -0.966193 -0.403872 -1.395052 -0.814967  0.038353 -0.105887 -1.522562  0.019179 -0.839893 -0.335373  ... -0.093019  0.966519 -2.597465  1.325126  3.385047  1.879262  0.477237 -0.232187  0.247156 -0.325624
5108 -0.965470 -1.395743 -1.395052 -0.814967  0.038353 -0.105887 -1.522562  0.019179 -0.839893 -0.335373  ... -0.093019  0.966519 -2.597465  1.325126  3.385047  1.879262  0.477237 -0.232187  0.247156 -0.325624
5109 -0.963878 -0.486528 -1.395052 -0.814967  0.764448 -0.105887 -1.522562  0.019179 -0.336807 -0.335373  ... -0.093019 -1.623786 -2.597465 -1.084044  3.385047  0.324231  0.477237 -0.128261  0.247156  2.505578
5110 -0.963009 -0.759928 -1.395052 -0.814967 -0.082663 -0.105887 -0.092639  0.019179 -0.638658 -0.335373  ... -0.093019 -0.472540 -2.597465  1.510447  3.385047  0.324231  0.477237  1.350258  0.247156 -0.822885

[5111 rows x 30 columns]
2024-10-25 01:19:34,138 - INFO - home goal predictions: [1.4494116  1.1613306  0.17390046 ... 1.9967622  1.3132595  2.1390269 ]
2024-10-25 17:13:49,119 - INFO - Model directory checked/created.
2024-10-25 17:13:56,114 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 17:13:56,218 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 17:13:56,220 - INFO - Data loaded with 5111 rows
2024-10-25 17:13:56,232 - INFO - Data filtered to only include home_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 17:13:56,648 - INFO - new real scores length: 26
2024-10-25 17:13:56,666 - INFO - data_with_error length: 0
2024-10-25 17:13:56,670 - INFO - prediction_df length: 5111
2024-10-25 17:13:56,678 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:14:02,428 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 17:14:02,429 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 17:14:02,429 - INFO - Data split into train and test. Train shape: (9466, 50), Test shape: (4058, 50)
2024-10-25 17:14:02,446 - INFO - Data scaling completed.
2024-10-25 17:14:02,462 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 17:17:27,184 - INFO - Feature selection using RFE completed.
2024-10-25 17:17:27,194 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:17:28,046 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 17:19:37,230 - INFO - Stacking model for home_goals trained successfully.
2024-10-25 17:19:39,083 - INFO - home_goals Stacking Model MSE: 0.10684667772630567, R2: 0.9294369651777101, Stacking Model MAE: 0.16208435366587814, Stacking Model MAPE: inf%
2024-10-25 17:19:39,546 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmppvv_6b_g\assets
2024-10-25 17:19:39,615 - INFO - Stacking model for home goals (without Keras) saved to ./models/home_goals_stacking_model.pkl
2024-10-25 17:19:40,129 - INFO - Assets written to: ./models/nn_regressor_home_goals_model\assets
2024-10-25 17:19:40,215 - INFO - Keras neural network model saved to ./models/nn_regressor_home_goals_model
2024-10-25 17:19:40,228 - INFO - Start home_goals predictions
2024-10-25 17:19:40,230 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 17:19:40,562 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 17:19:40,562 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:19:40,765 - INFO - home goal predictions: [1.1589359  1.0430018  0.38572472 ... 1.9870701  1.4171047  2.1225274 ]
2024-10-25 20:39:57,641 - INFO - Model directory checked/created.
2024-10-25 20:40:03,214 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 20:40:03,335 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 20:40:03,337 - INFO - Data loaded with 5111 rows
2024-10-25 20:40:03,342 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 20:40:03,681 - INFO - new real scores length: 26
2024-10-25 20:40:03,697 - INFO - data_with_error length: 0
2024-10-25 20:40:03,697 - INFO - prediction_df length: 5111
2024-10-25 20:40:03,697 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:40:05,781 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 20:40:05,796 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 20:40:05,798 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 20:40:05,798 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 20:40:05,798 - INFO - Data scaling started.
2024-10-25 20:40:05,831 - INFO - Data scaling completed.
2024-10-25 20:40:05,847 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 20:40:05,847 - INFO - Feature Selection started.
2024-10-25 20:48:13,902 - INFO - Feature selection using RFE completed.
2024-10-25 20:48:13,902 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:48:15,085 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 20:48:15,096 - INFO - First fit started
2024-10-25 20:54:11,532 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 20:54:13,227 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10128436902594871, R2: 0.9336989512725402, Stacking Model MAE: 0.15374440754478336, Stacking Model MAPE: inf%
2024-10-25 20:54:13,230 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.95194085027727%
2024-10-25 20:54:13,232 - INFO - Second fit started
2024-10-25 20:59:47,531 - INFO - Stacking model for home_goals trained successfully on second split.
2024-10-25 20:59:48,937 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09799895552664156, R2: 0.9358412355051224, Stacking Model MAE: 0.14897671310798694, Stacking Model MAPE: inf%
2024-10-25 20:59:48,939 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.35859519408503%
2024-10-25 20:59:48,950 - INFO - Start home_goals predictions
2024-10-25 20:59:48,955 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 20:59:49,321 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 20:59:49,323 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:03:43,209 - INFO - Model directory checked/created.
2024-10-25 21:03:49,126 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:03:49,164 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:03:49,167 - INFO - Data loaded with 5111 rows
2024-10-25 21:03:49,173 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:03:49,485 - INFO - new real scores length: 26
2024-10-25 21:03:49,485 - INFO - data_with_error length: 0
2024-10-25 21:03:49,501 - INFO - prediction_df length: 5111
2024-10-25 21:03:49,505 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:03:51,622 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 21:03:51,625 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:03:51,630 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:03:51,638 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:03:51,643 - INFO - Data scaling started.
2024-10-25 21:03:51,664 - INFO - Data scaling completed.
2024-10-25 21:03:51,677 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 21:03:51,679 - INFO - Feature Selection started.
2024-10-25 21:09:57,147 - INFO - Model directory checked/created.
2024-10-25 21:10:03,721 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:10:03,785 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:10:03,785 - INFO - Data loaded with 5111 rows
2024-10-25 21:10:03,803 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:10:04,151 - INFO - new real scores length: 26
2024-10-25 21:10:04,168 - INFO - data_with_error length: 0
2024-10-25 21:10:04,168 - INFO - prediction_df length: 5111
2024-10-25 21:10:04,184 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:10:06,118 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 21:10:06,118 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:10:06,134 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:10:06,134 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:10:06,134 - INFO - Data scaling started.
2024-10-25 21:10:06,152 - INFO - Data scaling completed.
2024-10-25 21:10:06,177 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 21:10:06,179 - INFO - Feature Selection started.
2024-10-25 21:14:26,981 - INFO - Feature selection using RFE completed.
2024-10-25 21:14:26,983 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:14:28,183 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 21:14:28,186 - INFO - First fit started
2024-10-25 21:21:01,623 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 21:21:03,374 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10097259508478815, R2: 0.933903039420234, Stacking Model MAE: 0.15050182639079898, Stacking Model MAPE: inf%
2024-10-25 21:21:03,376 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.32162661737523%
2024-10-25 21:21:03,378 - INFO - Second fit started
2024-10-25 21:26:55,786 - INFO - Stacking model for home_goals trained successfully on second split.
2024-10-25 21:26:57,419 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09751186789574871, R2: 0.9361601260527909, Stacking Model MAE: 0.14930858852673098, Stacking Model MAPE: inf%
2024-10-25 21:26:57,423 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.39556377079482%
2024-10-25 21:29:52,523 - INFO - Model directory checked/created.
2024-10-25 21:29:58,069 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:29:58,173 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:29:58,174 - INFO - Data loaded with 5111 rows
2024-10-25 21:29:58,174 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:29:58,536 - INFO - new real scores length: 26
2024-10-25 21:29:58,559 - INFO - data_with_error length: 0
2024-10-25 21:29:58,563 - INFO - prediction_df length: 5111
2024-10-25 21:29:58,565 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:30:00,686 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 21:30:00,686 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:30:00,686 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:30:00,703 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:30:00,703 - INFO - Data scaling started.
2024-10-25 21:30:00,726 - INFO - Data scaling completed.
2024-10-25 21:30:00,738 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 21:30:00,740 - INFO - Feature Selection started.
2024-10-25 21:34:23,345 - INFO - Feature selection using RFE completed.
2024-10-25 21:34:23,346 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:34:24,476 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 21:34:24,478 - INFO - First fit started
2024-10-25 21:40:32,046 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 21:40:33,605 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10147823092911956, R2: 0.9335720486950533, Stacking Model MAE: 0.15356815852280992, Stacking Model MAPE: inf%
2024-10-25 21:40:33,608 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.98890942698706%
2024-10-25 21:40:34,745 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpblt5w8w4\tmps6507q95\assets
2024-10-25 21:45:38,163 - INFO - Model directory checked/created.
2024-10-25 21:45:46,374 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:45:46,425 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:45:46,427 - INFO - Data loaded with 5111 rows
2024-10-25 21:45:46,434 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:45:46,837 - INFO - new real scores length: 26
2024-10-25 21:45:46,848 - INFO - data_with_error length: 0
2024-10-25 21:45:46,853 - INFO - prediction_df length: 5111
2024-10-25 21:45:46,858 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:45:49,107 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 21:45:49,109 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:45:49,115 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:45:49,122 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:45:49,124 - INFO - Data scaling started.
2024-10-25 21:45:49,146 - INFO - Data scaling completed.
2024-10-25 21:45:49,157 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 21:45:49,159 - INFO - Feature Selection started.
2024-10-25 21:49:25,262 - INFO - Model directory checked/created.
2024-10-25 21:49:30,992 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:49:31,084 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:49:31,086 - INFO - Data loaded with 5111 rows
2024-10-25 21:49:31,093 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:49:31,419 - INFO - new real scores length: 26
2024-10-25 21:49:31,429 - INFO - data_with_error length: 0
2024-10-25 21:49:31,431 - INFO - prediction_df length: 5111
2024-10-25 21:49:31,435 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:49:33,424 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 21:49:33,426 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:49:33,433 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:49:33,444 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:49:33,446 - INFO - Data scaling started.
2024-10-25 21:49:33,466 - INFO - Data scaling completed.
2024-10-25 21:49:33,477 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 21:49:33,479 - INFO - Feature Selection started.
2024-10-25 21:50:19,807 - INFO - Model directory checked/created.
2024-10-25 21:50:26,023 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:50:26,063 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:50:26,065 - INFO - Data loaded with 5111 rows
2024-10-25 21:50:26,071 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:50:26,398 - INFO - new real scores length: 26
2024-10-25 21:50:26,409 - INFO - data_with_error length: 0
2024-10-25 21:50:26,413 - INFO - prediction_df length: 5111
2024-10-25 21:50:26,417 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:50:28,459 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 21:50:28,462 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:50:28,468 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:50:28,473 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:50:28,475 - INFO - Data scaling started.
2024-10-25 21:50:28,491 - INFO - Data scaling completed.
2024-10-25 21:50:28,507 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 21:50:28,509 - INFO - Feature Selection started.
2024-10-25 21:54:47,852 - INFO - Feature selection using RFE completed.
2024-10-25 21:54:47,855 - INFO - Selected Features: ['running_id', 'away_encoded', 'Home_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:54:49,030 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 21:54:49,032 - INFO - First fit started
2024-10-25 22:00:45,083 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 22:00:46,534 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10212688964583495, R2: 0.9331474347729048, Stacking Model MAE: 0.15034533071239176, Stacking Model MAPE: inf%
2024-10-25 22:00:46,536 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.28465804066543%
2024-10-25 22:00:46,539 - INFO - Start home_goals predictions
2024-10-25 22:00:46,542 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:00:46,953 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 22:00:46,954 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:05:20,988 - INFO - Model directory checked/created.
2024-10-25 22:05:27,145 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:05:27,181 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:05:27,183 - INFO - Data loaded with 5111 rows
2024-10-25 22:05:27,188 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:05:27,503 - INFO - new real scores length: 26
2024-10-25 22:05:27,513 - INFO - data_with_error length: 0
2024-10-25 22:05:27,517 - INFO - prediction_df length: 5111
2024-10-25 22:05:27,520 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:05:29,529 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 22:05:29,531 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:05:29,536 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:05:29,542 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:05:29,544 - INFO - Data scaling started.
2024-10-25 22:05:29,557 - INFO - Data scaling completed.
2024-10-25 22:05:29,573 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 22:05:29,574 - INFO - Feature Selection started.
2024-10-25 22:09:57,695 - INFO - Feature selection using RFE completed.
2024-10-25 22:09:57,700 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:09:58,849 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 22:09:58,851 - INFO - First fit started
2024-10-25 22:15:40,561 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 22:15:42,162 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10532895920014367, R2: 0.931051350534136, Stacking Model MAE: 0.16062491516457175, Stacking Model MAPE: inf%
2024-10-25 22:15:42,162 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.6561922365989%
2024-10-25 22:15:42,175 - INFO - Start home_goals predictions
2024-10-25 22:15:42,178 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:15:42,494 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 22:15:42,496 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:17:22,991 - INFO - Model directory checked/created.
2024-10-25 22:17:28,416 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:17:28,512 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:17:28,512 - INFO - Data loaded with 5111 rows
2024-10-25 22:17:28,526 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:17:28,842 - INFO - new real scores length: 26
2024-10-25 22:17:28,861 - INFO - data_with_error length: 0
2024-10-25 22:17:28,864 - INFO - prediction_df length: 5111
2024-10-25 22:17:28,867 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:17:30,792 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 22:17:30,806 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:17:30,809 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:17:30,809 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:17:30,809 - INFO - Data scaling started.
2024-10-25 22:17:30,825 - INFO - Data scaling completed.
2024-10-25 22:17:30,842 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 22:17:30,842 - INFO - Feature Selection started.
2024-10-25 22:21:48,376 - INFO - Feature selection using RFE completed.
2024-10-25 22:21:48,376 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:21:49,545 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 22:21:49,545 - INFO - First fit started
2024-10-25 22:27:30,480 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 22:27:31,955 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10359086565105663, R2: 0.9321891117326224, Stacking Model MAE: 0.15446233783572427, Stacking Model MAPE: inf%
2024-10-25 22:27:31,957 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.6931608133087%
2024-10-25 22:27:31,960 - INFO - Start home_goals predictions
2024-10-25 22:27:31,962 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:27:32,396 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 22:27:32,398 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:27:32,418 - ERROR - Error occurred while making prediction: This StandardScaler instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2024-10-25 22:27:33,667 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpfrbdkzjk\tmpka4ov7wt\assets
2024-10-25 22:29:15,043 - INFO - Model directory checked/created.
2024-10-25 22:29:20,211 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:29:20,346 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:29:20,352 - INFO - Data loaded with 5111 rows
2024-10-25 22:29:20,353 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:29:20,673 - INFO - new real scores length: 26
2024-10-25 22:29:20,678 - INFO - data_with_error length: 0
2024-10-25 22:29:20,678 - INFO - prediction_df length: 5111
2024-10-25 22:29:20,678 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:29:22,523 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 22:29:22,526 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:29:22,532 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:29:22,537 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:29:22,539 - INFO - Data scaling started.
2024-10-25 22:29:22,542 - INFO - Data scaling completed.
2024-10-25 22:29:22,576 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 22:29:22,576 - INFO - Feature Selection started.
2024-10-25 22:30:01,304 - INFO - Model directory checked/created.
2024-10-25 22:30:06,624 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:30:06,671 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:30:06,673 - INFO - Data loaded with 5111 rows
2024-10-25 22:30:06,679 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:30:06,977 - INFO - new real scores length: 26
2024-10-25 22:30:06,977 - INFO - data_with_error length: 0
2024-10-25 22:30:06,977 - INFO - prediction_df length: 5111
2024-10-25 22:30:06,995 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:30:08,928 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 22:30:08,928 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:30:08,928 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:30:08,948 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:30:08,948 - INFO - Data scaling started.
2024-10-25 22:30:08,960 - INFO - Data scaling completed.
2024-10-25 22:30:08,977 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 22:30:08,977 - INFO - Feature Selection started.
2024-10-25 22:34:27,791 - INFO - Feature selection using RFE completed.
2024-10-25 22:34:27,800 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:34:29,042 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 22:34:29,044 - INFO - First fit started
2024-10-25 22:40:11,332 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 22:40:12,705 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10523677548816453, R2: 0.9311116942657363, Stacking Model MAE: 0.15493487994963587, Stacking Model MAPE: inf%
2024-10-25 22:40:12,707 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.4343807763401%
2024-10-25 22:40:12,711 - INFO - Start home_goals predictions
2024-10-25 22:40:12,713 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:40:13,106 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 22:40:13,109 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:40:15,563 - INFO - home goal predictions: [0.21850663 0.91649752 0.90620704 ... 2.10913425 1.39739808 2.06310462]
2024-10-25 22:40:26,513 - INFO - Assets written to: ./models/nn_regressor_home_goals_stacked_2fit\assets
2024-10-25 22:40:26,605 - INFO - Keras model saved successfully at ./models/nn_regressor_home_goals_stacked_2fit
2024-10-25 22:40:26,615 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000144ADDEEAF0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 22:41:57,026 - INFO - Model directory checked/created.
2024-10-25 22:42:03,490 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:42:03,526 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:42:03,528 - INFO - Data loaded with 5111 rows
2024-10-25 22:42:03,534 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:42:03,881 - INFO - new real scores length: 26
2024-10-25 22:42:03,890 - INFO - data_with_error length: 0
2024-10-25 22:42:03,892 - INFO - prediction_df length: 5111
2024-10-25 22:42:03,897 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:42:05,758 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 22:42:05,762 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:42:05,767 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:42:05,771 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:42:05,773 - INFO - Data scaling started.
2024-10-25 22:42:05,789 - INFO - Data scaling completed.
2024-10-25 22:42:05,802 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 22:42:05,805 - INFO - Feature Selection started.
2024-10-25 22:46:17,565 - INFO - Feature selection using RFE completed.
2024-10-25 22:46:17,567 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:46:18,716 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 22:46:18,719 - INFO - First fit started
2024-10-25 22:51:52,829 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 22:51:54,227 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10606240833822621, R2: 0.9305712325503762, Stacking Model MAE: 0.15342554602548267, Stacking Model MAPE: inf%
2024-10-25 22:51:54,229 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.09981515711645%
2024-10-25 22:51:54,233 - INFO - Start home_goals predictions
2024-10-25 22:51:54,235 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:51:54,578 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 22:51:54,578 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:51:57,296 - INFO - home goal predictions: [0.52460596 0.9376497  0.9596349  ... 1.88620727 1.5592734  1.86542417]
2024-10-25 22:52:09,118 - INFO - Assets written to: ./models/nn_regressor_home_goals_stacked_2fit\assets
2024-10-25 22:52:09,226 - INFO - Keras model saved successfully at ./models/nn_regressor_home_goals_stacked_2fit
2024-10-25 22:52:09,228 - ERROR - Error occurred while saving models: 'nn'
2024-10-25 22:55:08,248 - INFO - Model directory checked/created.
2024-10-25 22:55:15,354 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:55:15,393 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:55:15,399 - INFO - Data loaded with 5111 rows
2024-10-25 22:55:15,405 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:55:15,785 - INFO - new real scores length: 26
2024-10-25 22:55:15,794 - INFO - data_with_error length: 0
2024-10-25 22:55:15,798 - INFO - prediction_df length: 5111
2024-10-25 22:55:15,802 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:55:17,798 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 22:55:17,800 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:55:17,805 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:55:17,812 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:55:17,813 - INFO - Data scaling started.
2024-10-25 22:55:17,832 - INFO - Data scaling completed.
2024-10-25 22:55:17,843 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 22:55:17,845 - INFO - Feature Selection started.
2024-10-25 22:59:22,590 - INFO - Feature selection using RFE completed.
2024-10-25 22:59:22,592 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:59:23,673 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 22:59:23,675 - INFO - First fit started
2024-10-25 23:05:14,744 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 23:05:16,310 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10478345420128178, R2: 0.9314084397262634, Stacking Model MAE: 0.15298925117011486, Stacking Model MAPE: inf%
2024-10-25 23:05:16,312 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.4713493530499%
2024-10-25 23:05:16,315 - INFO - Start home_goals predictions
2024-10-25 23:05:16,317 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:05:16,715 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 23:05:16,717 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:05:19,368 - INFO - home goal predictions: [0.67177895 0.97601297 0.95469252 ... 1.91494598 1.31123445 1.9347613 ]
2024-10-25 23:05:30,380 - INFO - Assets written to: ./models/nn_regressor_home_goals_stacked_2fit\assets
2024-10-25 23:05:30,481 - INFO - Keras model saved successfully at ./models/nn_regressor_home_goals_stacked_2fit
2024-10-25 23:05:31,176 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpzsuedqd6\tmp9_xaan6w\assets
2024-10-25 23:05:31,412 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000194DB2E4160>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:17:52,665 - INFO - Model directory checked/created.
2024-10-25 23:17:58,475 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:17:58,521 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:17:58,524 - INFO - Data loaded with 5111 rows
2024-10-25 23:17:58,532 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:17:58,849 - INFO - new real scores length: 26
2024-10-25 23:17:58,859 - INFO - data_with_error length: 0
2024-10-25 23:17:58,862 - INFO - prediction_df length: 5111
2024-10-25 23:17:58,866 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:18:00,752 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 23:18:00,755 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:18:00,761 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:18:00,769 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:18:00,771 - INFO - Data scaling started.
2024-10-25 23:18:00,791 - INFO - Data scaling completed.
2024-10-25 23:18:00,805 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 23:18:00,806 - INFO - Feature Selection started.
2024-10-25 23:22:10,079 - INFO - Feature selection using RFE completed.
2024-10-25 23:22:10,081 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:22:11,206 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 23:22:11,208 - INFO - First fit started
2024-10-25 23:27:33,862 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 23:27:35,258 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10217153246989698, R2: 0.9331182114477073, Stacking Model MAE: 0.1559756962824686, Stacking Model MAPE: inf%
2024-10-25 23:27:35,260 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.98890942698706%
2024-10-25 23:27:35,263 - INFO - Start home_goals predictions
2024-10-25 23:27:35,266 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:27:35,565 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 23:27:35,566 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:27:38,016 - INFO - home goal predictions: [0.35691003 0.88062676 0.93772856 ... 2.09003351 1.43174953 2.09265198]
2024-10-25 23:27:49,441 - INFO - Assets written to: ./models/nn_regressor_home_goals_stacked_2fit\assets
2024-10-25 23:27:49,536 - INFO - Keras model saved successfully at ./models/nn_regressor_home_goals_stacked_2fit
2024-10-25 23:27:49,545 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000247D9DDDB80>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:43:47,271 - INFO - Model directory checked/created.
2024-10-25 23:43:52,559 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:43:52,668 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:43:52,670 - INFO - Data loaded with 5111 rows
2024-10-25 23:43:52,679 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:43:53,018 - INFO - new real scores length: 26
2024-10-25 23:43:53,026 - INFO - data_with_error length: 0
2024-10-25 23:43:53,029 - INFO - prediction_df length: 5111
2024-10-25 23:43:53,032 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:43:54,931 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-25 23:43:54,934 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:43:54,939 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:43:54,944 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:43:54,945 - INFO - Data scaling started.
2024-10-25 23:43:54,961 - INFO - Data scaling completed.
2024-10-25 23:43:54,968 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-25 23:43:54,968 - INFO - Feature Selection started.
2024-10-25 23:48:03,340 - INFO - Feature selection using RFE completed.
2024-10-25 23:48:03,340 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG']
2024-10-25 23:48:04,538 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-25 23:48:04,539 - INFO - First fit started
2024-10-25 23:53:36,628 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-25 23:53:38,086 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10246040427660341, R2: 0.9329291151052349, Stacking Model MAE: 0.15499452065282432, Stacking Model MAPE: inf%
2024-10-25 23:53:38,088 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.73012939001849%
2024-10-25 23:53:38,091 - INFO - Start home_goals predictions
2024-10-25 23:53:38,099 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:53:38,464 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-25 23:53:38,467 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:53:41,113 - INFO - home goal predictions: [0.52637788 0.75507237 0.71987776 ... 1.99975781 1.24286295 2.03874784]
2024-10-25 23:53:52,777 - INFO - Assets written to: ./models/nn_regressor_home_goals_stacked_2fit\assets
2024-10-25 23:53:52,883 - INFO - Keras model saved successfully at ./models/nn_regressor_home_goals_stacked_2fit
2024-10-25 23:53:53,737 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmplcsmp0oz\tmp_7_87sur\assets
2024-10-25 23:53:54,029 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000297B5DDB280>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 19:00:20,239 - INFO - Model directory checked/created.
2024-10-28 19:00:25,400 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 19:00:25,509 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 19:00:25,524 - INFO - Data loaded with 5111 rows
2024-10-28 19:00:25,526 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 19:00:25,859 - INFO - new real scores length: 26
2024-10-28 19:00:25,877 - INFO - data_with_error length: 0
2024-10-28 19:00:25,877 - INFO - prediction_df length: 5111
2024-10-28 19:00:25,877 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:00:27,843 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-10-28 19:00:27,860 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 19:00:27,860 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 19:00:27,860 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 19:00:27,860 - INFO - Data scaling started.
2024-10-28 19:00:27,894 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-10-28 19:00:27,894 - INFO - Data scaling completed.
2024-10-28 19:00:27,894 - INFO - Feature Selection started.
2024-10-28 19:04:32,047 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-10-28 19:04:32,053 - INFO - Feature selection using RFE completed.
2024-10-28 19:04:32,054 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:04:32,055 - INFO - First fit started
2024-10-28 19:09:43,125 - INFO - Stacking model for home_goals trained successfully on first split.
2024-10-28 19:09:44,513 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10733582930447533, R2: 0.9297376474044567, Stacking Model MAE: 0.16088505760990793, Stacking Model MAPE: inf%
2024-10-28 19:09:44,515 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.06469500924214%
2024-10-28 19:09:44,516 - INFO - Second fit started
2024-10-28 19:14:58,388 - INFO - Stacking model for home_goals trained successfully on second split.
2024-10-28 19:14:59,917 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09990705016156146, R2: 0.9345920283716599, Stacking Model MAE: 0.14618192699982768, Stacking Model MAPE: inf%
2024-10-28 19:14:59,920 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.50646950092421%
2024-10-28 19:14:59,924 - INFO - Start home_goals predictions
2024-10-28 19:14:59,927 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 19:15:00,311 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-10-28 19:15:00,312 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 19:15:02,917 - INFO - home_goals predictions: [0.28207829 0.99524252 0.87725966 ... 1.90593692 1.37838297 1.95409805]
2024-10-28 19:15:15,308 - INFO - Assets written to: ./models/nn_regressor_home_goals_stacked_2fit\assets
2024-10-28 19:15:15,426 - INFO - Keras model saved successfully at ./models/nn_regressor_home_goals_stacked_2fit
2024-10-28 19:15:16,151 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp9078zgll\tmp1185kuv9\assets
2024-10-28 19:15:16,420 - INFO - Error with joblib: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000162D17BE790>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 19:15:17,343 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp9078zgll\tmpvjpqa8g_\assets
2024-10-28 19:15:17,615 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_home_goals.pkl
2024-10-28 19:15:17,747 - INFO - Keras model zipped successfully at ./models/nn_regressor_home_goals_stacked_2fit.zip
2024-11-02 19:19:13,061 - INFO - Model directory checked/created.
2024-11-02 19:19:18,278 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:19:18,370 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:19:18,370 - INFO - Data loaded with 5111 rows
2024-11-02 19:19:18,380 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:19:18,678 - INFO - new real scores length: 26
2024-11-02 19:19:18,869 - INFO - data_with_error length: 0
2024-11-02 19:19:18,874 - INFO - prediction_df length: 5111
2024-11-02 19:19:18,878 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:19:20,978 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 19:19:20,978 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:19:20,978 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:19:20,996 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:19:20,996 - INFO - Data scaling started.
2024-11-02 19:19:21,032 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 19:19:21,049 - INFO - Data scaling completed.
2024-11-02 19:19:21,051 - INFO - Feature Selection started.
2024-11-02 19:23:27,945 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 19:23:27,962 - INFO - Feature selection using RFE completed.
2024-11-02 19:23:27,962 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:23:27,962 - INFO - First fit started
2024-11-02 19:29:47,696 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 19:29:49,866 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10379467243231981, R2: 0.932055699208405, Stacking Model MAE: 0.15265067082914968, Stacking Model MAPE: inf%
2024-11-02 19:29:49,866 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.39741219963032%
2024-11-02 19:29:49,866 - INFO - Second fit started
2024-11-02 19:37:35,364 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 19:37:37,115 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 19:37:37,220 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09667069683093589, R2: 0.9367108308634412, Stacking Model MAE: 0.15365114698623808, Stacking Model MAPE: inf%
2024-11-02 19:37:37,223 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.17375231053605%
2024-11-02 19:37:37,226 - INFO - Start home_goals predictions
2024-11-02 19:37:37,229 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 19:37:37,547 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-02 19:37:37,547 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:37:41,037 - INFO - home_goals predictions: [0.32478526 0.97498744 0.98610206 ... 2.17855126 1.45929085 2.07482171]
2024-11-02 19:37:54,078 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp_prlq75w\tmpkjninzvf\assets
2024-11-02 19:45:10,965 - INFO - Model directory checked/created.
2024-11-02 19:45:17,183 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:45:17,230 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:45:17,232 - INFO - Data loaded with 5111 rows
2024-11-02 19:45:17,250 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:45:17,715 - INFO - new real scores length: 274
2024-11-02 19:53:48,449 - INFO - Model directory checked/created.
2024-11-02 19:53:54,050 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:53:54,101 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:53:54,101 - INFO - Data loaded with 5111 rows
2024-11-02 19:53:54,115 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:53:54,720 - INFO - new real scores length: 274
2024-11-02 19:53:54,867 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 19:53:54,867 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 19:53:54,867 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 19:53:54,884 - INFO - data_with_error length: 0
2024-11-02 19:53:54,890 - INFO - prediction_df length: 5111
2024-11-02 19:53:54,893 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:53:56,931 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 19:53:56,933 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:53:56,938 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:53:56,943 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:53:56,945 - INFO - Data scaling started.
2024-11-02 19:53:56,966 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 19:53:56,966 - INFO - Data scaling completed.
2024-11-02 19:53:56,966 - INFO - Feature Selection started.
2024-11-02 19:56:20,742 - INFO - Model directory checked/created.
2024-11-02 19:56:27,272 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:56:27,311 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:56:27,313 - INFO - Data loaded with 5111 rows
2024-11-02 19:56:27,321 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:56:27,784 - INFO - new real scores length: 274
2024-11-02 19:56:27,934 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 19:56:27,934 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 19:56:27,934 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 19:56:27,934 - INFO - data_with_error length: 267
2024-11-02 19:56:27,934 - INFO - prediction_df length: 5111
2024-11-02 19:56:27,951 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:56:29,889 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 19:56:29,891 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:56:29,897 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:56:29,903 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:56:29,905 - INFO - Data scaling started.
2024-11-02 19:56:29,928 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 19:56:29,937 - INFO - Data scaling completed.
2024-11-02 19:56:29,939 - INFO - Feature Selection started.
2024-11-02 20:00:45,701 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 20:00:45,701 - INFO - Feature selection using RFE completed.
2024-11-02 20:00:45,701 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:00:45,716 - INFO - First fit started
2024-11-02 20:05:56,985 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 20:05:58,420 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10150974330749928, R2: 0.9335514205985902, Stacking Model MAE: 0.15205401403322083, Stacking Model MAPE: inf%
2024-11-02 20:05:58,422 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.50646950092421%
2024-11-02 20:05:58,423 - INFO - Second fit started
2024-11-02 20:08:20,502 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0003s vs `on_train_batch_end` time: 0.0021s). Check your callbacks.
2024-11-02 20:09:49,112 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 20:10:48,771 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0004s vs `on_predict_batch_end` time: 0.0024s). Check your callbacks.
2024-11-02 20:10:49,962 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 20:10:51,406 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.0960770266342798, R2: 0.9370994997643514, Stacking Model MAE: 0.1486367837936171, Stacking Model MAPE: inf%
2024-11-02 20:10:51,408 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.28465804066543%
2024-11-02 20:10:51,412 - INFO - Start home_goals predictions
2024-11-02 20:10:51,414 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:10:51,803 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-02 20:10:51,803 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:10:54,237 - INFO - home_goals predictions: [0.32618609 0.97225937 0.72597101 ... 2.04824732 1.37943311 2.0011395 ]
2024-11-02 20:11:06,268 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp5f2l0e2o\tmp7zrk9vmh\assets
2024-11-02 20:28:16,617 - INFO - Model directory checked/created.
2024-11-02 20:28:22,983 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:28:23,074 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:28:23,074 - INFO - Data loaded with 5111 rows
2024-11-02 20:28:23,091 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:28:23,623 - INFO - new real scores length: 274
2024-11-02 20:28:23,809 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:28:23,809 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:28:23,809 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:28:23,824 - INFO - data_with_error length: 267
2024-11-02 20:28:23,824 - INFO - prediction_df length: 5111
2024-11-02 20:28:23,824 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:28:25,892 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 20:28:25,896 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:28:25,916 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:28:25,929 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:28:25,931 - INFO - Data scaling started.
2024-11-02 20:28:25,961 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 20:28:25,970 - INFO - Data scaling completed.
2024-11-02 20:28:25,971 - INFO - Feature Selection started.
2024-11-02 20:31:44,205 - INFO - Model directory checked/created.
2024-11-02 20:31:50,709 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:31:50,740 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:31:50,755 - INFO - Data loaded with 5111 rows
2024-11-02 20:31:50,758 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:31:51,223 - INFO - new real scores length: 274
2024-11-02 20:31:51,391 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:31:51,391 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:31:51,391 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:31:51,391 - INFO - data_with error columns: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'home_goals_prediction_rounded', 'away_goals_prediction_rounded',
       'real_home_goals', 'real_away_goals', 'home_error', 'away_error'],
      dtype='object')
2024-11-02 20:31:51,407 - INFO - data_with_error length: 0
2024-11-02 20:31:51,407 - INFO - prediction_df length: 5111
2024-11-02 20:31:51,407 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:31:53,272 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 20:31:53,272 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:31:53,289 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:31:53,289 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:31:53,306 - INFO - Data scaling started.
2024-11-02 20:31:53,339 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 20:31:53,339 - INFO - Data scaling completed.
2024-11-02 20:31:53,339 - INFO - Feature Selection started.
2024-11-02 20:35:58,408 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 20:35:58,408 - INFO - Feature selection using RFE completed.
2024-11-02 20:35:58,408 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:35:58,408 - INFO - First fit started
2024-11-02 20:41:28,572 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 20:41:30,095 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10313571589826734, R2: 0.9324870541123617, Stacking Model MAE: 0.15895307854692353, Stacking Model MAPE: inf%
2024-11-02 20:41:30,095 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 85.80406654343807%
2024-11-02 20:41:30,095 - INFO - Second fit started
2024-11-02 20:45:40,845 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_train_batch_end` time: 0.0029s). Check your callbacks.
2024-11-02 20:46:42,143 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 20:46:43,483 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09827651360945792, R2: 0.9356595214901785, Stacking Model MAE: 0.147627234661391, Stacking Model MAPE: inf%
2024-11-02 20:46:43,485 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.35859519408503%
2024-11-02 20:46:43,487 - INFO - Start home_goals predictions
2024-11-02 20:46:43,491 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:46:43,860 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-02 20:46:43,860 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:46:46,211 - INFO - home_goals predictions: [0.76616442 0.98810266 1.01942874 ... 2.02734024 1.42283785 2.07220723]
2024-11-02 20:46:59,293 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp7wj9awxx\tmpwi7i9u_2\assets
2024-11-02 21:09:19,068 - INFO - Model directory checked/created.
2024-11-02 21:09:25,270 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:09:25,302 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:09:25,317 - INFO - Data loaded with 5111 rows
2024-11-02 21:09:25,329 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:09:25,868 - INFO - new real scores length: 274
2024-11-02 21:09:26,018 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:09:26,018 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:09:26,018 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:09:26,034 - INFO - running_id                                    0
Date                                          0
season_encoded                                0
league_encoded                                0
home_encoded                                  0
away_encoded                                  0
venue_encoded                                 0
home_league_position                          0
away_league_position                          0
Home_points_cum                               0
Away_points_cum                               0
Home_team_matches                             0
Away_team_matches                             0
Home_goal_difference_cum                      0
Away_goal_difference_cum                      0
Home_draws                                    0
Away_draws                                    0
home_draw_rate                                0
away_draw_rate                                0
home_average_points                           0
away_average_points                           0
home_win_rate                                 0
away_win_rate                                 0
Home_wins                                     0
Away_wins                                     0
home_xG_rolling_avg                           0
away_xG_rolling_avg                           0
home_shots_on_target_accuracy_rolling_avg     0
away_shots_on_target_accuracy_rolling_avg     0
home_shots_on_target_rolling_avg              0
away_shots_on_target_rolling_avg              0
home_saves_accuracy_rolling_avg               0
away_saves_accuracy_rolling_avg               0
home_goals_rolling_avg                        0
away_goals_rolling_avg                        0
home_goal_difference_rolling_avg              0
away_goal_difference_rolling_avg              0
referee_foul_rate                            30
referee_encoded                               0
Home_saves_mean                              29
Away_saves_mean                              22
Home_fouls_mean                              33
Away_fouls_mean                              31
Home_possession_mean                         31
away_possession_mean                         30
Home_shot_on_target_mean                     29
away_shot_on_target_mean                     22
home_team_elo                                 0
away_team_elo                                 0
home_poisson_xG                               0
away_poisson_xG                               0
home_goals_prediction_rounded                 0
away_goals_prediction_rounded                 0
real_home_goals                               0
real_away_goals                               0
home_error                                    0
away_error                                    0
dtype: int64
2024-11-02 21:09:26,034 - INFO - data_with_error length: 234
2024-11-02 21:09:26,034 - INFO - prediction_df length: 5111
2024-11-02 21:09:26,034 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:09:28,084 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 21:09:28,084 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:09:28,102 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:09:28,102 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:09:28,102 - INFO - Data scaling started.
2024-11-02 21:09:28,138 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 21:09:28,145 - INFO - Data scaling completed.
2024-11-02 21:09:28,147 - INFO - Feature Selection started.
2024-11-02 21:13:48,868 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 21:13:48,869 - INFO - Feature selection using RFE completed.
2024-11-02 21:13:48,869 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:13:48,869 - INFO - First fit started
2024-11-02 21:19:01,524 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 21:19:02,990 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10301891469572007, R2: 0.9325635125263892, Stacking Model MAE: 0.15612209593932982, Stacking Model MAPE: inf%
2024-11-02 21:19:02,990 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 86.28465804066543%
2024-11-02 21:19:02,990 - INFO - Second fit started
2024-11-02 21:24:17,704 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 21:24:19,103 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09844753035221605, R2: 0.9355475588384916, Stacking Model MAE: 0.14973213924480272, Stacking Model MAPE: inf%
2024-11-02 21:24:19,105 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 85.84103512014788%
2024-11-02 21:24:19,109 - INFO - Start home_goals predictions
2024-11-02 21:24:19,111 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 21:24:19,126 - ERROR - Error occurred while making prediction: could not convert string to float: '2024-10-23 00:00:00'
2024-11-02 21:24:21,254 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpy9atubic\tmpns32i9w0\assets
2024-11-02 22:07:29,931 - INFO - Model directory checked/created.
2024-11-02 22:07:35,199 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 22:07:35,288 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 22:07:35,290 - INFO - Data loaded with 5111 rows
2024-11-02 22:07:35,296 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 22:07:35,750 - INFO - new real scores length: 274
2024-11-02 22:07:35,909 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 22:07:35,911 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 22:07:35,912 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 22:07:35,912 - INFO - data_with_error length: 234
2024-11-02 22:07:35,926 - INFO - prediction_df length: 5111
2024-11-02 22:07:35,929 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:07:37,829 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 22:07:37,829 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 22:07:37,844 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 22:07:37,846 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 22:07:37,846 - INFO - Data scaling started.
2024-11-02 22:07:37,863 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 22:07:37,879 - INFO - Data scaling completed.
2024-11-02 22:07:37,879 - INFO - Feature Selection started.
2024-11-02 22:11:33,812 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 22:11:33,813 - INFO - Feature selection using RFE completed.
2024-11-02 22:11:33,813 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:11:33,813 - INFO - First fit started
2024-11-02 22:15:30,295 - WARNING - Callback method `on_predict_batch_begin` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_begin` time: 0.0002s). Check your callbacks.
2024-11-02 22:15:30,298 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 22:16:29,901 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 22:16:31,357 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10164941288364987, R2: 0.9334599924792943, Stacking Model MAE: 0.15314877176075473, Stacking Model MAPE: inf%
2024-11-02 22:16:31,357 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 86.09981515711645%
2024-11-02 22:16:31,357 - INFO - Second fit started
2024-11-02 22:20:11,514 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0026s). Check your callbacks.
2024-11-02 22:21:06,548 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 22:21:07,903 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09468227285962465, R2: 0.938012628669405, Stacking Model MAE: 0.1454112574056308, Stacking Model MAPE: inf%
2024-11-02 22:21:07,903 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.54343807763402%
2024-11-02 22:21:07,903 - INFO - Start home_goals predictions
2024-11-02 22:21:07,913 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 22:21:07,915 - INFO - Residual model train data selected
2024-11-02 22:21:07,923 - INFO - Residual model scaler loaded
2024-11-02 22:21:08,199 - INFO - Residual model successfully fitted
2024-11-02 22:21:08,581 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-02 22:21:08,581 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:21:11,008 - INFO - home_goals predictions: [0.36407549 0.95661477 0.94576932 ... 1.94304186 1.36825462 1.96457565]
2024-11-02 22:21:11,015 - INFO - residual model prediction error: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2024-11-02 22:21:23,715 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp092glras\tmpbssxxka_\assets
2024-11-02 22:24:22,500 - INFO - Model directory checked/created.
2024-11-02 22:24:28,517 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 22:24:28,565 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 22:24:28,565 - INFO - Data loaded with 5111 rows
2024-11-02 22:24:28,565 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 22:24:29,028 - INFO - new real scores length: 274
2024-11-02 22:24:29,185 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 22:24:29,185 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 22:24:29,185 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 22:24:29,200 - INFO - data_with_error length: 234
2024-11-02 22:24:29,203 - INFO - prediction_df length: 5111
2024-11-02 22:24:29,206 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:24:31,082 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 22:24:31,082 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 22:24:31,100 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 22:24:31,100 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 22:24:31,100 - INFO - Data scaling started.
2024-11-02 22:24:31,131 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 22:24:31,132 - INFO - Data scaling completed.
2024-11-02 22:24:31,132 - INFO - Feature Selection started.
2024-11-02 22:28:45,795 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 22:28:45,801 - INFO - Feature selection using RFE completed.
2024-11-02 22:28:45,803 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:28:45,805 - INFO - First fit started
2024-11-02 22:33:38,295 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 22:34:48,629 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 22:34:50,204 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10273772558502063, R2: 0.9327475797532417, Stacking Model MAE: 0.15438759795744458, Stacking Model MAPE: inf%
2024-11-02 22:34:50,207 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 85.58225508317929%
2024-11-02 22:34:50,208 - INFO - Second fit started
2024-11-02 22:39:13,030 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-02 22:40:16,019 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 22:40:17,443 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.10018585749357953, R2: 0.9344094964879447, Stacking Model MAE: 0.14939045156119637, Stacking Model MAPE: inf%
2024-11-02 22:40:17,445 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.09981515711645%
2024-11-02 22:40:17,450 - INFO - Start home_goals predictions
2024-11-02 22:40:17,452 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 22:40:17,452 - INFO - Residual model train data selected
2024-11-02 22:40:17,452 - INFO - Residual model scaler loaded
2024-11-02 22:40:17,738 - INFO - Residual model successfully fitted
2024-11-02 22:40:18,052 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-02 22:40:18,052 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:40:20,440 - INFO - home_goals predictions: [0.62549699 0.98135114 0.93936512 ... 2.06204051 1.28875737 2.04956171]
2024-11-02 22:40:20,444 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-02 22:40:32,819 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpuztf26u3\tmpbu66c3xg\assets
2024-11-02 23:38:27,021 - INFO - Model directory checked/created.
2024-11-02 23:38:33,725 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 23:38:33,790 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5282, 51)
2024-11-02 23:38:33,790 - INFO - Data loaded with 5282 rows
2024-11-02 23:38:33,805 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 23:38:34,936 - INFO - new real scores length: 274
2024-11-02 23:38:35,293 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 23:38:35,295 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 23:38:35,296 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 23:38:35,307 - INFO - data_with_error length: 239
2024-11-02 23:38:35,310 - INFO - prediction_df length: 5282
2024-11-02 23:38:35,313 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:38:37,289 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-02 23:38:37,289 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 23:38:37,305 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 23:38:37,305 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 23:38:37,305 - INFO - Data scaling started.
2024-11-02 23:38:37,323 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-02 23:38:37,339 - INFO - Data scaling completed.
2024-11-02 23:38:37,339 - INFO - Feature Selection started.
2024-11-02 23:42:49,455 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-02 23:42:49,472 - INFO - Feature selection using RFE completed.
2024-11-02 23:42:49,472 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:42:49,472 - INFO - First fit started
2024-11-02 23:48:07,406 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-02 23:48:08,891 - INFO - home_goals (1st fit) Stacking Model MSE: 0.10447113660288795, R2: 0.9316128837535965, Stacking Model MAE: 0.1556830843499768, Stacking Model MAPE: inf%
2024-11-02 23:48:08,891 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 86.02587800369686%
2024-11-02 23:48:08,891 - INFO - Second fit started
2024-11-02 23:48:33,504 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0023s). Check your callbacks.
2024-11-02 23:50:41,060 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0009s vs `on_train_batch_end` time: 0.0023s). Check your callbacks.
2024-11-02 23:52:58,607 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-02 23:52:59,990 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.09785052279448624, R2: 0.935938412670476, Stacking Model MAE: 0.1486435082217284, Stacking Model MAPE: inf%
2024-11-02 23:52:59,990 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 86.28465804066543%
2024-11-02 23:52:59,990 - INFO - Start home_goals predictions
2024-11-02 23:52:59,990 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 23:52:59,990 - INFO - Residual model train data selected
2024-11-02 23:53:00,007 - INFO - Residual model scaler loaded
2024-11-02 23:53:00,174 - INFO - Residual model successfully fitted
2024-11-02 23:53:00,591 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-02 23:53:00,624 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:53:03,157 - INFO - home_goals predictions: [2.22172149 2.09494973 1.89745514 ... 1.77348438 2.4094152  2.50312247]
2024-11-02 23:53:03,157 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-02 23:53:15,923 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp6lw8bpyx\tmpoyr6gqb2\assets
2024-11-03 02:00:11,960 - INFO - Model directory checked/created.
2024-11-03 02:00:17,837 - INFO - Data loaded from ./Model_build1/model_data_training_newPoisson.xlsx with shape: (13917, 65)
2024-11-03 02:00:17,922 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5282, 51)
2024-11-03 02:00:17,922 - INFO - Data loaded with 5282 rows
2024-11-03 02:00:17,922 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 65)
2024-11-03 02:00:18,421 - INFO - new real scores length: 274
2024-11-03 02:00:18,591 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 02:00:18,594 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 02:00:18,594 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 02:00:18,594 - INFO - data_with_error length: 234
2024-11-03 02:00:18,606 - INFO - prediction_df length: 5282
2024-11-03 02:00:18,611 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:00:20,940 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-03 02:00:20,943 - INFO - Data prepared for modeling. Feature shape: (13883, 50), Target shape: (13883,)
2024-11-03 02:00:20,948 - INFO - Data split into train and test. Train shape: (11106, 50), Test shape: (2777, 50)
2024-11-03 02:00:20,956 - INFO - Data split into train2 and test2. Train2 shape: (11106, 50), Test2 shape: (2777, 50)
2024-11-03 02:00:20,957 - INFO - Data scaling started.
2024-11-03 02:00:20,974 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-03 02:00:20,986 - INFO - Data scaling completed.
2024-11-03 02:00:20,988 - INFO - Feature Selection started.
2024-11-03 02:04:59,489 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-03 02:04:59,489 - INFO - Feature selection using RFE completed.
2024-11-03 02:04:59,489 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Away_team_matches', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:04:59,489 - INFO - First fit started
2024-11-03 02:10:39,163 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0003s). Check your callbacks.
2024-11-03 02:11:13,241 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-03 02:11:14,879 - INFO - home_goals (1st fit) Stacking Model MSE: 0.12128541034697841, R2: 0.9179487097751043, Stacking Model MAE: 0.16686001074659637, Stacking Model MAPE: inf%
2024-11-03 02:11:14,882 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 84.4796543032049%
2024-11-03 02:11:14,883 - INFO - Second fit started
2024-11-03 02:13:51,842 - INFO - Model directory checked/created.
2024-11-03 02:13:57,950 - INFO - Data loaded from ./Model_build1/model_data_training_newPoisson.xlsx with shape: (13917, 65)
2024-11-03 02:13:57,986 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (3760, 51)
2024-11-03 02:13:57,988 - INFO - Data loaded with 3760 rows
2024-11-03 02:13:57,995 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 65)
2024-11-03 02:13:58,475 - INFO - new real scores length: 274
2024-11-03 02:13:58,627 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 02:13:58,627 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 02:13:58,627 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 02:13:58,654 - INFO - data_with_error length: 173
2024-11-03 02:13:58,659 - INFO - prediction_df length: 3760
2024-11-03 02:13:58,662 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:14:00,690 - INFO - Imputer saved to ./models/imputer_home_goals.pkl
2024-11-03 02:14:00,693 - INFO - Data prepared for modeling. Feature shape: (13883, 50), Target shape: (13883,)
2024-11-03 02:14:00,702 - INFO - Data split into train and test. Train shape: (11106, 50), Test shape: (2777, 50)
2024-11-03 02:14:00,708 - INFO - Data split into train2 and test2. Train2 shape: (11106, 50), Test2 shape: (2777, 50)
2024-11-03 02:14:00,708 - INFO - Data scaling started.
2024-11-03 02:14:00,724 - INFO - Scaler saved to ./models/scaler_home_goals.pkl
2024-11-03 02:14:00,739 - INFO - Data scaling completed.
2024-11-03 02:14:00,741 - INFO - Feature Selection started.
2024-11-03 02:18:32,857 - INFO - RFE selector saved to ./models/rfe_home_goals_selector.pkl
2024-11-03 02:18:32,858 - INFO - Feature selection using RFE completed.
2024-11-03 02:18:32,858 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:18:32,858 - INFO - First fit started
2024-11-03 02:24:30,647 - INFO - Stacking model for home_goals trained successfully on first split.
2024-11-03 02:24:32,205 - INFO - home_goals (1st fit) Stacking Model MSE: 0.12227256510614842, R2: 0.9172808856616366, Stacking Model MAE: 0.16671729138415284, Stacking Model MAPE: inf%
2024-11-03 02:24:32,210 - INFO - home_goals (1st fit) Stacking Model Within Range (0.3): 84.76773496579042%
2024-11-03 02:24:32,210 - INFO - Second fit started
2024-11-03 02:29:29,320 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0007s). Check your callbacks.
2024-11-03 02:30:04,160 - INFO - Stacking model for home_goals trained successfully on second split.
2024-11-03 02:30:05,600 - INFO - home_goals (2nd fit) Stacking Model MSE: 0.11587397215962666, R2: 0.9264376960342875, Stacking Model MAE: 0.16502124546350372, Stacking Model MAPE: inf%
2024-11-03 02:30:05,600 - INFO - home_goals (2nd fit) Stacking Model Within Range (0.3): 84.98379546272956%
2024-11-03 02:30:05,612 - INFO - Start home_goals predictions
2024-11-03 02:30:05,614 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-03 02:30:05,617 - INFO - Residual model train data selected
2024-11-03 02:30:05,625 - INFO - Residual model scaler loaded
2024-11-03 02:30:05,893 - INFO - Residual model successfully fitted
2024-11-03 02:30:06,244 - INFO - Imputer loaded from ./models/imputer_home_goals.pkl
2024-11-03 02:30:06,244 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:30:08,061 - INFO - home_goals predictions: [-0.0533481   1.64772564  2.79585509 ...  1.87640547  2.35945102
  0.28993584]
2024-11-03 02:30:08,077 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-03 02:30:17,527 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpetsk6tjn\tmpjelhmp3f\assets
2024-11-03 17:52:29,152 - INFO - Model directory checked/created.
2024-11-03 17:52:48,835 - INFO - Data loaded from ./Model_build1/data/model_data_training_newPoisson.xlsx with shape: (13917, 69)
2024-11-03 17:52:48,974 - INFO - Data loaded from ./Model_build1/data/merged_data_prediction.csv with shape: (3760, 55)
2024-11-03 17:52:48,974 - INFO - Data loaded with 3760 rows
2024-11-03 17:52:48,996 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 69)
2024-11-03 17:52:50,956 - INFO - new real scores length: 274
2024-11-03 17:52:51,051 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 17:52:51,051 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 17:52:51,052 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 17:52:51,068 - INFO - data_with_error length: 173
2024-11-03 17:52:51,073 - INFO - prediction_df length: 3760
2024-11-03 17:52:51,079 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'Home_offsides_mean', 'Away_offsides_mean', 'Home_passes_mean', 'Away_passes_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
