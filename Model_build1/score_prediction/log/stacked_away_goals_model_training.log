2024-10-22 23:17:56,214 - INFO - Model directory checked/created.
2024-10-22 23:17:56,331 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-22 23:17:58,330 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-22 23:17:58,330 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (13447, 56)
2024-10-22 23:17:58,914 - INFO - New score dataframe created with errors:    running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
0        7971         2.122105         1.201717              3.0              0.0                 1.0    0.877895   -1.201717       0.006483
1        7972         0.935789        -0.003282              1.0              1.0                 0.0    0.064211    1.003282      -1.024491
2       14408         2.325106         0.318673              3.0              2.0                 1.0    0.674894    1.681327       0.010585
3       14410         1.086156         0.081375              1.0              2.0                -1.0   -0.086156    1.918625      -1.992787
4        6411         0.816743         2.678010              0.0              2.0                -1.0   -0.816743   -0.678010       0.039193
2024-10-22 23:17:58,935 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-22 23:18:00,463 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-22 23:18:00,463 - INFO - Data prepared for modeling. Feature shape: (13447, 44), Target shape: (13447,)
2024-10-22 23:18:00,480 - INFO - Data split into train and test. Train shape: (10757, 44), Test shape: (2690, 44)
2024-10-22 23:18:00,495 - INFO - Data scaling completed.
2024-10-22 23:18:00,497 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-22 23:20:24,778 - INFO - Feature selection using RFE completed.
2024-10-22 23:20:25,930 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-22 23:23:09,547 - INFO - Stacking model for away_goals trained successfully.
2024-10-22 23:23:11,333 - INFO - away_goals Stacking Model MSE: 0.08835623157771877, R2: 0.9241046192260055, Stacking Model MAE: 0.1527591777666507, Stacking Model MAPE: inf%
2024-10-22 23:33:22,132 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmptoy2cr1r\assets
2024-10-22 23:33:22,215 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-22 23:33:22,905 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-22 23:33:23,001 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-22 23:33:23,073 - INFO - Start away_goals predictions
2024-10-22 23:33:23,075 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-22 23:33:23,418 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-22 23:33:23,431 - INFO - [[-1.54187569 -0.00929519 -0.98628877 ... -0.81743435  0.30176534
  -1.40133035]
 [-1.54173038 -0.30816653 -0.01372492 ... -1.13245679  1.59659553
  -0.06148439]
 [-1.54158506 -1.28108812 -0.45868878 ... -0.34881889  0.52218069
   0.11457045]
 ...
 [ 1.20369695 -1.5354467   0.4248823  ...  0.17852332  0.68708253
   1.03600035]
 [ 1.20384227 -1.54816463 -1.29776347 ... -0.32335066  0.10798555
   0.06069653]
 [ 1.20398758 -0.60703787 -0.61760444 ...  0.9245927  -0.12914709
  -1.17468832]]
2024-10-22 23:33:23,599 - INFO - home goal predictions: [ 0.62602615  0.7359946   0.60813594 ...  2.0781658   0.03802428
 -0.04097316]
2024-10-22 23:33:23,611 - INFO - home goal error predictions: [0.68681367 0.77443185 0.87834464 ... 0.80635889 0.68647085 0.73859865]
2024-10-23 00:34:31,086 - INFO - Model directory checked/created.
2024-10-23 00:34:31,185 - INFO - Data loaded from ./Model_build1/model_data_training.csv with shape: (13557, 56)
2024-10-23 00:34:32,554 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3759, 50)
2024-10-23 00:34:32,559 - INFO - Data filtered to only include home_goals from 0 to 5. Filtered data shape: (13447, 56)
2024-10-23 00:34:33,133 - INFO - New score dataframe created with errors:    running_id  home_prediction  away_prediction  real_home_goals  real_away_goals  real_match_outcome  home_error  away_error  outcome_error
0        7971         2.122105         1.201717              3.0              0.0                 1.0    0.877895   -1.201717       0.006483
1        7972         0.935789        -0.003282              1.0              1.0                 0.0    0.064211    1.003282      -1.024491
2       14408         2.325106         0.318673              3.0              2.0                 1.0    0.674894    1.681327       0.010585
3       14410         1.086156         0.081375              1.0              2.0                -1.0   -0.086156    1.918625      -1.992787
4        6411         0.816743         2.678010              0.0              2.0                -1.0   -0.816743   -0.678010       0.039193
2024-10-23 00:34:33,143 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean']
2024-10-23 00:34:34,683 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-23 00:34:34,683 - INFO - Data prepared for modeling. Feature shape: (13447, 44), Target shape: (13447,)
2024-10-23 00:34:34,683 - INFO - Data split into train and test. Train shape: (10757, 44), Test shape: (2690, 44)
2024-10-23 00:34:34,700 - INFO - Data scaling completed.
2024-10-23 00:34:34,717 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-23 00:36:59,238 - INFO - Feature selection using RFE completed.
2024-10-23 00:37:00,517 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-23 00:39:51,233 - INFO - Stacking model for away_goals trained successfully.
2024-10-23 00:39:53,463 - INFO - away_goals Stacking Model MSE: 0.08605233234083084, R2: 0.9260836002975864, Stacking Model MAE: 0.15253280334063418, Stacking Model MAPE: inf%
2024-10-23 00:50:48,438 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpga_njve2\assets
2024-10-23 00:50:48,512 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-23 00:50:49,119 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-23 00:50:49,230 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-23 00:50:49,307 - INFO - Start away_goals predictions
2024-10-23 00:50:49,310 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'away_league_position',
       'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws',
       'away_draw_rate', 'away_average_points', 'Away_team_matches',
       'away_win_rate', 'Away_wins', 'away_xG_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_average_points', 'home_draw_rate', 'Home_draws',
       'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches',
       'home_win_rate', 'Home_wins', 'home_xG_rolling_avg',
       'home_shots_on_target_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'Home_points_cum',
       'home_goals_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean'],
      dtype='object')
2024-10-23 00:50:49,633 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-23 00:50:49,644 - INFO - [[-1.54187569 -0.00929519 -0.98628877 ... -0.81743435  0.30176534
  -1.40133035]
 [-1.54173038 -0.30816653 -0.01372492 ... -1.13245679  1.59659553
  -0.06148439]
 [-1.54158506 -1.28108812 -0.45868878 ... -0.34881889  0.52218069
   0.11457045]
 ...
 [ 1.20369695 -1.5354467   0.4248823  ...  0.17852332  0.68708253
   1.03600035]
 [ 1.20384227 -1.54816463 -1.29776347 ... -0.32335066  0.10798555
   0.06069653]
 [ 1.20398758 -0.60703787 -0.61760444 ...  0.9245927  -0.12914709
  -1.17468832]]
2024-10-23 00:50:49,803 - INFO - home goal predictions: [ 1.1252185   0.6163673   0.5650166  ...  1.7327837   0.04001355
 -0.04724526]
2024-10-23 00:50:49,814 - INFO - home goal error predictions: [0.74393306 0.89389891 0.9274362  ... 0.87404096 0.72280767 0.80628073]
2024-10-23 19:09:09,678 - INFO - Model directory checked/created.
2024-10-23 19:09:14,659 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 64)
2024-10-23 19:09:15,992 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 19:09:15,992 - INFO - Data loaded with 5174 rows
2024-10-23 19:09:15,992 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 64)
2024-10-23 19:09:16,508 - INFO - new real scores length: 92
2024-10-23 19:09:16,514 - INFO - prediction_df length: 3754
2024-10-23 19:09:16,517 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 19:09:18,212 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-23 19:09:18,213 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 19:09:18,218 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 19:09:18,231 - INFO - Data scaling completed.
2024-10-23 19:09:18,252 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-23 19:12:54,391 - INFO - Feature selection using RFE completed.
2024-10-23 19:12:55,624 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-23 19:15:15,857 - INFO - Stacking model for away_goals trained successfully.
2024-10-23 19:15:17,323 - INFO - away_goals Stacking Model MSE: 0.10010848170102253, R2: 0.9220009656682785, Stacking Model MAE: 0.15619238308639444, Stacking Model MAPE: inf%
2024-10-23 19:24:57,646 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp0sf567wg\assets
2024-10-23 19:24:57,737 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-23 19:24:58,328 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-23 19:24:58,416 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-23 19:24:58,419 - INFO - Start away_goals predictions
2024-10-23 19:24:58,422 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 19:24:58,731 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-23 19:24:58,746 - INFO - [[-1.53341891e+00  1.14897838e-01  4.80319613e-01 ...  1.44085374e+03
  -1.62042882e+01  3.23359190e+01]
 [-1.53327399e+00 -1.17613545e+00 -1.11999126e-01 ...  1.39230321e+03
  -1.61933534e+01  4.01458725e+01]
 [-1.53312906e+00 -1.15696169e+00  1.67132611e+00 ...  1.29469812e+03
  -1.62076579e+01  3.99209049e+01]
 ...
 [ 2.40468564e+00  8.30718277e-01 -3.54021837e-01 ...  1.35852055e+03
  -1.62069017e+01  4.43907420e+01]
 [ 2.40483057e+00 -1.48291564e+00  3.08356108e-01 ...  1.33765070e+03
  -1.62073710e+01  4.43907420e+01]
 [ 2.40497549e+00  6.07024390e-01 -1.57687343e+00 ...  1.34239751e+03
  -1.62117706e+01  4.53037300e+01]]
2024-10-23 19:24:58,912 - INFO - home goal predictions: [244.31235 226.47139 218.94101 ... 214.955   213.4731  216.50258]
2024-10-23 19:40:59,038 - INFO - Model directory checked/created.
2024-10-23 19:41:04,994 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 64)
2024-10-23 19:41:07,323 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 52)
2024-10-23 19:41:07,324 - INFO - Data loaded with 5174 rows
2024-10-23 19:41:07,324 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 64)
2024-10-23 19:41:07,940 - INFO - new real scores length: 92
2024-10-23 19:41:07,958 - INFO - prediction_df length: 3754
2024-10-23 19:41:07,960 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'away_league_position', 'Away_points_cum', 'Away_goal_difference_cum', 'Away_draws', 'away_draw_rate', 'away_average_points', 'Away_team_matches', 'away_win_rate', 'Away_wins', 'away_xG_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'away_saves_accuracy_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_average_points', 'home_draw_rate', 'Home_draws', 'Home_goal_difference_cum', 'home_league_position', 'Home_team_matches', 'home_win_rate', 'Home_wins', 'home_xG_rolling_avg', 'home_shots_on_target_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'home_saves_accuracy_rolling_avg', 'Home_points_cum', 'home_goals_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 19:41:10,146 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-23 19:41:10,146 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 19:41:10,146 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 19:41:10,173 - INFO - Data scaling completed.
2024-10-23 19:41:10,175 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-23 19:45:14,408 - INFO - Feature selection using RFE completed.
2024-10-23 19:45:15,691 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-23 19:48:04,108 - INFO - Stacking model for away_goals trained successfully.
2024-10-23 19:48:05,731 - INFO - away_goals Stacking Model MSE: 0.09885970814938397, R2: 0.9229739414788366, Stacking Model MAE: 0.15467238895889515, Stacking Model MAPE: inf%
2024-10-23 19:57:33,613 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpzk3q6pv3\assets
2024-10-23 19:57:33,691 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-23 19:57:34,207 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-23 19:57:34,307 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-23 19:57:34,307 - INFO - Start away_goals predictions
2024-10-23 19:57:34,307 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 19:57:34,574 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-23 19:57:34,598 - INFO - [[-1.53341891e+00  1.14897838e-01  1.86403553e+00 ...  1.44085374e+03
  -1.62042882e+01  3.23359190e+01]
 [-1.53327399e+00 -1.17613545e+00  1.67182833e+00 ...  1.39230321e+03
  -1.61933534e+01  4.01458725e+01]
 [-1.53312906e+00 -1.15696169e+00 -1.51394295e-01 ...  1.29469812e+03
  -1.62076579e+01  3.99209049e+01]
 ...
 [ 2.40468564e+00  8.30718277e-01  8.59066435e-01 ...  1.35852055e+03
  -1.62069017e+01  4.43907420e+01]
 [ 2.40483057e+00 -1.48291564e+00  9.02999511e-01 ...  1.33765070e+03
  -1.62073710e+01  4.43907420e+01]
 [ 2.40497549e+00  6.07024390e-01  8.86524607e-01 ...  1.34239751e+03
  -1.62117706e+01  4.53037300e+01]]
2024-10-23 19:57:34,618 - INFO - X_new_prepared:             0         1         2         3           4         5         6         7          8   ...        21        22        23        24        25        26           27         28         29
0    -1.533419  0.114898  1.864036 -1.296872   -7.217877 -1.080177  0.965258 -0.858445   9.786866  ... -1.547638  1.982310  0.898067 -0.556488  1.742432 -0.019144  1440.853740 -16.204288  32.335919
1    -1.533274 -1.176135  1.671828 -1.186374  123.837806 -1.185144 -1.083457 -0.510086  58.548118  ... -1.552738  1.926266  2.212351  0.060501  0.519073  0.090890  1392.303205 -16.193353  40.145873
2    -1.533129 -1.156962 -0.151394  0.139606   15.574416 -1.099858 -0.937121 -1.083335  44.616332  ... -1.549821  1.557312  0.273412 -0.260151  0.419661 -0.444292  1294.698117 -16.207658  39.920905
3    -1.532984  0.255505  0.513093 -0.744380  158.026245 -1.151030 -0.937121 -0.945755  44.616332  ... -1.554330  4.350156  2.404325 -1.307209  2.335398  1.472005  1241.295161 -16.205959  40.066245
4    -1.532839 -1.438177 -0.261227 -1.296872   26.970562 -1.099858 -0.937121 -0.782379  44.616332  ... -1.551854  2.589450  1.444455 -0.200884 -0.363359  0.941756  1387.740068 -16.203318  38.323176
...        ...       ...       ...       ...         ...       ...       ...       ...        ...  ...       ...       ...       ...       ...       ...       ...          ...        ...        ...
3749  2.404396 -1.316743  0.804150 -1.186374    9.876342 -1.355716 -0.725745 -0.808175   9.786866  ... -1.547964  2.225166  1.713218 -0.477465 -0.325348  0.850503  1357.491550 -16.203461  41.195284
3750  2.404541  0.172419  0.771200 -1.296872   21.272489 -1.355716  1.599385 -0.601806   7.464902  ... -1.551147  3.864444  1.022111  1.063488  0.647725  1.679172  1361.064027 -16.197998  39.452307
3751  2.404686  0.830718  0.859066 -0.965377  -41.406316 -1.355716 -1.571247 -1.014545   7.464902  ... -1.550086 -0.081967 -0.129734  0.273256  0.229607  0.998480  1358.520546 -16.206902  44.390742
3752  2.404831 -1.482916  0.903000 -1.075875   26.970562 -1.355716  0.965258 -0.911360   9.786866  ... -1.551412  1.982310  0.676558  0.865930 -1.450464  1.250040  1337.650704 -16.207371  44.390742
3753  2.404975  0.607024  0.886525 -0.744380   26.970562 -1.151030  1.599385 -1.152125   7.464902  ... -1.546904  3.560874 -0.590472  0.174477 -0.910713 -0.214928  1342.397509 -16.211771  45.303730

[3754 rows x 30 columns]
2024-10-23 19:57:34,740 - INFO - home goal predictions: [-4.9314775 -1.0518234 -5.2678576 ... -6.4450884 -6.41599   -4.2811937]
2024-10-23 21:52:19,559 - INFO - Model directory checked/created.
2024-10-23 21:52:25,077 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-23 21:52:26,608 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (5174, 53)
2024-10-23 21:52:26,613 - INFO - Data loaded with 5174 rows
2024-10-23 21:52:26,619 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-23 21:52:27,089 - INFO - new real scores length: 92
2024-10-23 21:52:27,097 - INFO - prediction_df length: 3754
2024-10-23 21:52:27,102 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-23 21:52:29,929 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-23 21:52:29,931 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-23 21:52:29,936 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-23 21:52:29,950 - INFO - Data scaling completed.
2024-10-23 21:52:29,961 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-23 21:56:11,553 - INFO - Feature selection using RFE completed.
2024-10-23 21:56:12,809 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-23 21:58:45,142 - INFO - Stacking model for away_goals trained successfully.
2024-10-23 21:58:46,812 - INFO - away_goals Stacking Model MSE: 0.09293322412959085, R2: 0.925069171136639, Stacking Model MAE: 0.16027213868382403, Stacking Model MAPE: inf%
2024-10-23 22:09:03,572 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp6o8snx5h\assets
2024-10-23 22:09:03,660 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-23 22:09:04,450 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-23 22:09:04,543 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-23 22:09:04,543 - INFO - Start away_goals predictions
2024-10-23 22:09:04,543 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-23 22:09:04,942 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-23 22:09:04,969 - INFO - [[ 5.43481802e-01 -6.74098965e-01  3.95618041e-01 ...  1.31020333e+03
  -1.61442386e+01  3.23614200e+01]
 [ 9.20760406e-01  4.82261609e-01  1.05622083e+00 ...  1.29433000e+03
  -1.61371197e+01  4.01589156e+01]
 [-1.89359447e-01  1.07641373e+00  5.41712889e-01 ...  1.20686781e+03
  -1.61495523e+01  4.03748473e+01]
 ...
 [-5.41013219e-01  3.50503377e-02 -7.03269296e-01 ...  1.27554473e+03
  -1.61465252e+01  5.00061855e+01]
 [-5.41881858e-01  1.24492592e-01 -7.15973196e-01 ...  1.37149075e+03
  -1.61467799e+01  5.18179731e+01]
 [-5.41157992e-01 -1.82166566e-01 -6.96917346e-01 ...  1.25589108e+03
  -1.61448670e+01  4.31194849e+01]]
2024-10-23 22:09:05,000 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7          8   ...        21        22        23        24        25        26           27         28         29
0     0.543482 -0.674099  0.395618 -1.186342  0.191735 -1.077531  0.775702  1.920401  49.082223  ... -1.551364  1.448900 -1.961229 -1.380818 -0.115472 -2.665198  1310.203326 -16.144239  32.361420
1     0.920760  0.482262  1.056221 -0.234180  2.480222 -0.526715  0.197886  7.669334  65.666988  ... -1.549241  2.220837  0.335464 -0.518834  0.209980 -0.837241  1294.329998 -16.137120  40.158916
2    -0.189359  1.076414  0.541713  1.653634 -0.723660  0.244428 -0.033241  2.064124  13.148564  ... -1.551364  1.717400 -0.755465 -0.319915 -0.824328 -0.275833  1206.867814 -16.149552  40.374847
3     1.001544 -0.897705  0.173300 -1.340450 -0.906739 -0.967368 -0.264367  2.303663  15.912691  ... -1.550480  4.133900  0.297186 -0.585141  0.178485 -0.822500  1238.472051 -16.148373  39.174782
4     0.634834 -1.530189  1.430986 -0.014026 -1.364437 -0.196225 -0.148804  1.984278  15.912691  ... -1.542518  0.106399  0.552374 -1.778656 -2.870266 -1.215609  1170.837319 -16.149390  38.261435
...        ...       ...       ...       ...       ...       ...       ...       ...        ...  ...       ...       ...       ...       ...       ...       ...          ...        ...        ...
3749 -0.542316  0.769755  1.145148  1.549062  2.388683  1.566388  0.775702  5.219789  60.138733  ... -1.552749  1.497718  0.505220  0.041756  0.485421  0.718957  1310.451079 -16.146377  47.086588
3750 -0.542461  0.776143 -0.366616 -0.795570  2.388683  0.905408  0.082322  3.958659  60.138733  ... -1.554742  3.310093 -0.259588  0.439595 -0.339185  0.618155  1371.247983 -16.147085  53.307050
3751 -0.541013  0.035050 -0.703269 -0.784563 -1.089818  1.235898 -0.148804  4.742604  13.148564  ... -1.550882  1.959050  0.627771 -0.956457  1.020041  1.067103  1275.544734 -16.146525  50.006186
3752 -0.541882  0.124493 -0.715973 -0.746036  1.839446  1.566388  0.775702  5.219789  60.138733  ... -1.552518  2.266604  0.455292  0.801266  0.347987  0.443354  1371.490754 -16.146780  51.817973
3753 -0.541158 -0.182167 -0.696917 -0.845105  0.649432  1.566388  0.660139  5.526550  60.138733  ... -1.551364  1.168195  0.053597 -0.410333 -0.284211 -0.963215  1255.891078 -16.144867  43.119485

[3754 rows x 30 columns]
2024-10-23 22:09:05,393 - INFO - home goal predictions: [67.290276 55.323147 77.60273  ... 83.03078  64.95563  57.165733]
2024-10-24 17:30:54,177 - INFO - Model directory checked/created.
2024-10-24 17:31:00,090 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 17:31:01,244 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 17:31:01,244 - INFO - Data loaded with 3754 rows
2024-10-24 17:31:01,244 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 17:31:01,728 - INFO - new real scores length: 92
2024-10-24 17:31:01,728 - INFO - prediction_df length: 3754
2024-10-24 17:31:01,742 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 17:31:06,209 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-24 17:31:06,226 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 17:31:06,226 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 17:31:06,247 - INFO - Data scaling completed.
2024-10-24 17:31:06,261 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-24 17:34:51,913 - INFO - Feature selection using RFE completed.
2024-10-24 17:34:53,128 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-24 17:37:28,595 - INFO - Stacking model for away_goals trained successfully.
2024-10-24 17:37:30,472 - INFO - away_goals Stacking Model MSE: 0.09434200663683649, R2: 0.9239332884429652, Stacking Model MAE: 0.15832984382602597, Stacking Model MAPE: inf%
2024-10-24 17:47:14,980 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp44oxhl73\assets
2024-10-24 17:47:15,062 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-24 17:47:15,649 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-24 17:47:15,734 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-24 17:47:15,734 - INFO - Start away_goals predictions
2024-10-24 17:47:15,744 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 17:47:16,081 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-24 17:47:16,104 - INFO - [[ 5.43481802e-01 -6.74098965e-01  3.95618041e-01 ...  1.31020333e+03
  -1.61442386e+01  3.23614200e+01]
 [ 9.20760406e-01  4.82261609e-01  1.05622083e+00 ...  1.29433000e+03
  -1.61371197e+01  4.01589156e+01]
 [-1.89359447e-01  1.07641373e+00  5.41712889e-01 ...  1.20686781e+03
  -1.61495523e+01  4.03748473e+01]
 ...
 [-5.41013219e-01  3.50503377e-02 -7.03269296e-01 ...  1.27554473e+03
  -1.61465252e+01  5.00061855e+01]
 [-5.41881858e-01  1.24492592e-01 -7.15973196e-01 ...  1.37149075e+03
  -1.61467799e+01  5.18179731e+01]
 [-5.41157992e-01 -1.82166566e-01 -6.96917346e-01 ...  1.25589108e+03
  -1.61448670e+01  4.31194849e+01]]
2024-10-24 17:47:16,125 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7          8   ...        21        22        23        24        25           26           27         28         29
0     0.543482 -0.674099  0.395618 -1.186342  0.191735 -1.077531  0.775702  1.920401  49.082223  ...  1.448900 -1.961229 -1.380818 -0.115472 -2.665198  1168.557181  1310.203326 -16.144239  32.361420
1     0.920760  0.482262  1.056221 -0.234180  2.480222 -0.526715  0.197886  7.669334  65.666988  ...  2.220837  0.335464 -0.518834  0.209980 -0.837241  1333.900353  1294.329998 -16.137120  40.158916
2    -0.189359  1.076414  0.541713  1.653634 -0.723660  0.244428 -0.033241  2.064124  13.148564  ...  1.717400 -0.755465 -0.319915 -0.824328 -0.275833  1057.858718  1206.867814 -16.149552  40.374847
3     1.001544 -0.897705  0.173300 -1.340450 -0.906739 -0.967368 -0.264367  2.303663  15.912691  ...  4.133900  0.297186 -0.585141  0.178485 -0.822500  1197.487658  1238.472051 -16.148373  39.174782
4     0.634834 -1.530189  1.430986 -0.014026 -1.364437 -0.196225 -0.148804  1.984278  15.912691  ...  0.106399  0.552374 -1.778656 -2.870266 -1.215609  1145.984566  1170.837319 -16.149390  38.261435
...        ...       ...       ...       ...       ...       ...       ...       ...        ...  ...       ...       ...       ...       ...       ...          ...          ...        ...        ...
3749 -0.542316  0.769755  1.145148  1.549062  2.388683  1.566388  0.775702  5.219789  60.138733  ...  1.497718  0.505220  0.041756  0.485421  0.718957  1199.034027  1310.451079 -16.146377  47.086588
3750 -0.542461  0.776143 -0.366616 -0.795570  2.388683  0.905408  0.082322  3.958659  60.138733  ...  3.310093 -0.259588  0.439595 -0.339185  0.618155  1272.737615  1371.247983 -16.147085  53.307050
3751 -0.541013  0.035050 -0.703269 -0.784563 -1.089818  1.235898 -0.148804  4.742604  13.148564  ...  1.959050  0.627771 -0.956457  1.020041  1.067103  1195.981881  1275.544734 -16.146525  50.006186
3752 -0.541882  0.124493 -0.715973 -0.746036  1.839446  1.566388  0.775702  5.219789  60.138733  ...  2.266604  0.455292  0.801266  0.347987  0.443354  1241.455641  1371.490754 -16.146780  51.817973
3753 -0.541158 -0.182167 -0.696917 -0.845105  0.649432  1.566388  0.660139  5.526550  60.138733  ...  1.168195  0.053597 -0.410333 -0.284211 -0.963215  1195.969538  1255.891078 -16.144867  43.119485

[3754 rows x 30 columns]
2024-10-24 17:47:16,281 - INFO - home goal predictions: [55.007156 46.604393 61.30021  ... 67.657715 52.402344 47.534424]
2024-10-24 17:50:33,722 - INFO - Model directory checked/created.
2024-10-24 17:50:38,899 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 17:50:40,063 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 17:50:40,077 - INFO - Data loaded with 3754 rows
2024-10-24 17:50:40,080 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 17:50:40,563 - INFO - new real scores length: 92
2024-10-24 17:50:40,580 - INFO - prediction_df length: 3754
2024-10-24 17:50:40,580 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 17:50:42,363 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-24 17:50:42,379 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 17:50:42,396 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 17:50:42,396 - INFO - Data scaling completed.
2024-10-24 17:50:42,414 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-24 17:53:49,994 - INFO - Feature selection using RFE completed.
2024-10-24 17:53:51,196 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-24 17:56:00,867 - INFO - Stacking model for away_goals trained successfully.
2024-10-24 17:56:02,376 - INFO - away_goals Stacking Model MSE: 0.09671473901190485, R2: 0.9220201857264718, Stacking Model MAE: 0.161632624463665, Stacking Model MAPE: inf%
2024-10-24 18:04:12,546 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp_s9lh6y0\assets
2024-10-24 18:04:12,630 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-24 18:04:13,113 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-24 18:04:13,195 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-24 18:04:13,195 - INFO - Start away_goals predictions
2024-10-24 18:04:13,195 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 18:04:13,581 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-24 18:04:13,600 - INFO - [[ 5.43481802e-01  3.95618041e-01 -1.18634233e+00 ... -2.66519788e+00
   1.16855718e+03  1.31020333e+03]
 [ 9.20760406e-01  1.05622083e+00 -2.34179626e-01 ... -8.37241350e-01
   1.33390035e+03  1.29433000e+03]
 [-1.89359447e-01  5.41712889e-01  1.65363429e+00 ... -2.75832657e-01
   1.05785872e+03  1.20686781e+03]
 ...
 [-5.41013219e-01 -7.03269296e-01 -7.84562693e-01 ...  1.06710340e+00
   1.19598188e+03  1.27554473e+03]
 [-5.41881858e-01 -7.15973196e-01 -7.46035878e-01 ...  4.43353724e-01
   1.24145564e+03  1.37149075e+03]
 [-5.41157992e-01 -6.96917346e-01 -8.45104830e-01 ... -9.63214894e-01
   1.19596954e+03  1.25589108e+03]]
2024-10-24 18:04:13,620 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8   ...        21        22        23        24        25        26        27           28           29
0     0.543482  0.395618 -1.186342  0.191735 -1.077531  0.775702  0.276582 -1.511744  1.920401  ... -6.643509 -1.551364  1.448900 -1.961229 -1.380818 -0.115472 -2.665198  1168.557181  1310.203326
1     0.920760  1.056221 -0.234180  2.480222 -0.526715  0.197886  0.517444 -0.808979  7.669334  ... -7.007762 -1.549241  2.220837  0.335464 -0.518834  0.209980 -0.837241  1333.900353  1294.329998
2    -0.189359  0.541713  1.653634 -0.723660  0.244428 -0.033241  0.637875  1.861529  2.064124  ... -7.136906 -1.551364  1.717400 -0.755465 -0.319915 -0.824328 -0.275833  1057.858718  1206.867814
3     1.001544  0.173300 -1.340450 -0.906739 -0.967368 -0.264367  0.397013 -1.511744  2.303663  ... -6.958091 -1.550480  4.133900  0.297186 -0.585141  0.178485 -0.822500  1197.487658  1238.472051
4     0.634834  1.430986 -0.014026 -1.364437 -0.196225 -0.148804  0.517444 -1.511744  1.984278  ... -7.007762 -1.542518  0.106399  0.552374 -1.778656 -2.870266 -1.215609  1145.984566  1170.837319
...        ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...          ...          ...
3749 -0.542316  1.145148  1.549062  2.388683  1.566388  0.775702  0.999168 -1.256193  5.219789  ... -6.958091 -1.552749  1.497718  0.505220  0.041756  0.485421  0.718957  1199.034027  1310.451079
3750 -0.542461 -0.366616 -0.795570  2.388683  0.905408  0.082322  0.999168 -1.511744  3.958659  ... -6.727799 -1.554742  3.310093 -0.259588  0.439595 -0.339185  0.618155  1272.737615  1371.247983
3751 -0.541013 -0.703269 -0.784563 -1.089818  1.235898 -0.148804  0.999168 -0.387320  4.742604  ... -6.719671 -1.550882  1.959050  0.627771 -0.956457  1.020041  1.067103  1195.981881  1275.544734
3752 -0.541882 -0.715973 -0.746036  1.839446  1.566388  0.775702  0.999168 -1.256193  5.219789  ... -6.930998 -1.552518  2.266604  0.455292  0.801266  0.347987  0.443354  1241.455641  1371.490754
3753 -0.541158 -0.696917 -0.845105  0.649432  1.566388  0.660139  0.999168 -1.256193  5.526550  ... -6.849719 -1.551364  1.168195  0.053597 -0.410333 -0.284211 -0.963215  1195.969538  1255.891078

[3754 rows x 30 columns]
2024-10-24 18:04:13,751 - INFO - home goal predictions: [154.0938  166.15363 151.112   ... 172.0898  159.01285 153.73537]
2024-10-24 18:57:13,699 - INFO - Model directory checked/created.
2024-10-24 18:57:18,744 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 18:57:19,807 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 18:57:19,808 - INFO - Data loaded with 3754 rows
2024-10-24 18:57:19,812 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 18:57:20,266 - INFO - new real scores length: 92
2024-10-24 18:57:20,269 - INFO - prediction_df length: 3754
2024-10-24 18:57:20,272 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 18:57:21,888 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-24 18:57:21,890 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 18:57:21,895 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 18:57:21,906 - INFO - Data scaling completed.
2024-10-24 18:57:21,918 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-24 19:00:35,110 - INFO - Feature selection using RFE completed.
2024-10-24 19:00:35,112 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo']
2024-10-24 19:00:36,250 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-24 19:02:49,183 - INFO - Stacking model for away_goals trained successfully.
2024-10-24 19:02:50,722 - INFO - away_goals Stacking Model MSE: 0.09307281094440949, R2: 0.9249566241349535, Stacking Model MAE: 0.157374416440069, Stacking Model MAPE: inf%
2024-10-24 19:11:42,000 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpuq3c3ze6\assets
2024-10-24 19:11:42,084 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-24 19:11:42,552 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-24 19:11:42,635 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-24 19:11:42,638 - INFO - Start away_goals predictions
2024-10-24 19:11:42,639 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:11:43,079 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-24 19:11:47,300 - INFO - Model directory checked/created.
2024-10-24 19:11:52,102 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:11:53,176 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:11:53,178 - INFO - Data loaded with 3754 rows
2024-10-24 19:11:53,185 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:11:53,632 - INFO - new real scores length: 92
2024-10-24 19:11:53,634 - INFO - prediction_df length: 3754
2024-10-24 19:11:53,634 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo']
2024-10-24 19:11:55,217 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-24 19:11:55,217 - INFO - Data prepared for modeling. Feature shape: (13524, 48), Target shape: (13524,)
2024-10-24 19:11:55,234 - INFO - Data split into train and test. Train shape: (10819, 48), Test shape: (2705, 48)
2024-10-24 19:11:55,234 - INFO - Data scaling completed.
2024-10-24 19:11:55,251 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-24 19:15:01,999 - INFO - Feature selection using RFE completed.
2024-10-24 19:15:02,001 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo']
2024-10-24 19:15:03,116 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-24 19:17:19,067 - INFO - Stacking model for away_goals trained successfully.
2024-10-24 19:17:20,551 - INFO - away_goals Stacking Model MSE: 0.09376486259810013, R2: 0.9243986320442563, Stacking Model MAE: 0.16044682350774597, Stacking Model MAPE: inf%
2024-10-24 19:26:18,268 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmp79nk5qm2\assets
2024-10-24 19:26:18,369 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-24 19:26:18,935 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-24 19:26:19,066 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-24 19:26:19,068 - INFO - Start away_goals predictions
2024-10-24 19:26:19,068 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 19:26:19,467 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-24 19:26:19,501 - INFO - Prediction data:       running_id  season_encoded  league_encoded  home_encoded  away_encoded  ...  away_possession_mean  Home_shot_on_target_mean  away_shot_on_target_mean  home_team_elo  away_team_elo
0          14792               4               7           150           319  ...             31.000000                  3.777778                  1.200000    1423.412500    1480.664800
1          17398               4               4           331           423  ...             43.400000                  4.416667                  3.200000    1624.234684    1462.770420
2           9730               1               4           424           342  ...             47.208333                  4.000000                  2.250000    1288.960579    1364.172216
3          17956               4               4           115           284  ...             43.500000                  6.000000                  3.166667    1458.550822    1399.800425
4          15423               0               7            16           482  ...             40.833333                  2.666667                  3.388889    1395.996297    1323.554179
...          ...             ...             ...           ...           ...  ...                   ...                       ...                       ...            ...            ...
3749        7292               3              17           376           437  ...             53.956522                  3.818182                  3.347826    1460.429007    1480.944099
3750        7291               2              17           377           199  ...             53.272727                  5.318182                  2.681818    1549.947766    1549.481897
3751        7301               3              17           261           146  ...             56.318182                  4.200000                  3.454545    1456.721938    1441.593344
3752        7295               3              17           275           144  ...             52.086957                  4.454545                  3.304348    1511.953368    1549.755579
3753        7300               3              17           227           147  ...             42.545455                  3.545455                  2.954545    1456.706946    1419.437309

[3754 rows x 48 columns]
2024-10-24 19:26:19,501 - INFO - [[ 0.5434818  -0.67409896  0.39561804 ... -0.27239153 -2.16563348
  -0.33507785]
 [ 0.92076041  0.48226161  1.05622083 ...  0.25362563 -0.39152035
  -0.52626905]
 [-0.18935945  1.07641373  0.54171289 ... -0.08942904 -1.23422409
  -1.57973434]
 ...
 [-0.54101322  0.03505034 -0.7032693  ...  0.0752372  -0.16572414
  -0.75253396]
 [-0.54188186  0.12449259 -0.7159732  ...  0.28481242 -0.29895793
   0.40311751]
 [-0.54115799 -0.18216657 -0.69691735 ... -0.4636705  -0.60925242
  -0.98925849]]
2024-10-24 19:26:19,518 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     0.543482 -0.674099  0.395618 -1.186342  0.191735 -1.077531 -1.188873 -1.528959 -0.672074 -0.824750  ... -1.873420  0.693691  0.576274  0.105795 -1.380818 -0.115472 -2.665198 -0.272392 -2.165633 -0.335078
1     0.920760  0.482262  1.056221 -0.234180  2.480222 -0.526715  1.931334  0.770614 -0.326558  0.183946  ... -0.607866  0.736151 -0.900476  0.565134 -0.518834  0.209980 -0.837241  0.253626 -0.391520 -0.526269
2    -0.189359  1.076414  0.541713  1.653634 -0.723660  0.244428  0.082322 -0.810342  0.986402  0.275646  ... -0.572820 -0.341263 -1.424051  0.105795 -0.319915 -0.824328 -0.275833 -0.089429 -1.234224 -1.579734
3     1.001544 -0.897705  0.173300 -1.340450 -0.906739 -0.967368 -0.264367 -0.570803 -0.672074  1.926239  ... -0.767594  0.035566 -0.699101  0.297186 -0.585141  0.178485 -0.822500  1.557233 -0.421089 -1.199067
4     0.634834 -1.530189  1.430986 -0.014026 -1.364437 -0.196225 -1.882253 -0.890189 -0.672074  0.734144  ... -0.915832 -0.749938 -0.900476  2.019706 -1.778656 -2.870266 -1.215609 -1.187204 -0.223965 -2.013715
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
3749 -0.542316  0.769755  1.145148  1.549062  2.388683  1.566388  0.891265 -0.029237 -0.546432 -0.824750  ...  0.516513  2.009941 -0.699101 -0.193774  0.041756  0.485421  0.718957 -0.239126 -0.260390 -0.332094
3750 -0.542461  0.776143 -0.366616 -0.795570  2.388683  0.905408  1.237955  0.038932 -0.672074 -0.824750  ...  1.526110 -0.728708  0.234547 -0.624971  0.439595 -0.339185  0.618155  0.995871 -0.851177  0.400193
3751 -0.541013  0.035050 -0.703269 -0.784563 -1.089818  1.235898 -0.611057  0.038932 -0.119249  0.092246  ...  0.990371  0.465470  0.267499  0.210190 -0.956457  1.020041  1.067103  0.075237 -0.165724 -0.752534
3752 -0.541882  0.124493 -0.715973 -0.746036  1.839446  1.566388  0.082322 -0.029237 -0.546432 -0.824750  ...  1.284429 -1.477060 -0.589260 -0.143846  0.801266  0.347987  0.443354  0.284812 -0.298958  0.403118
3753 -0.541158 -0.182167 -0.696917 -0.845105  0.649432  1.566388 -0.611057  0.038932 -0.546432 -0.824750  ... -0.127358 -0.325341 -0.259737  0.105795 -0.410333 -0.284211 -0.963215 -0.463671 -0.609252 -0.989258

[3754 rows x 30 columns]
2024-10-24 19:26:19,657 - INFO - home goal predictions: [ 0.02433339 -0.10069281 -0.1505194  ...  0.01548642 -0.04767662
  0.10510856]
2024-10-24 19:26:25,751 - INFO - Model directory checked/created.
2024-10-24 19:26:30,485 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:26:31,535 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:26:31,535 - INFO - Data loaded with 3754 rows
2024-10-24 19:26:31,535 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:26:31,985 - INFO - new real scores length: 92
2024-10-24 19:26:31,985 - INFO - prediction_df length: 3754
2024-10-24 19:26:32,002 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:26:33,635 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-24 19:26:33,650 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 19:26:33,651 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 19:26:33,669 - INFO - Data scaling completed.
2024-10-24 19:26:33,669 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-24 19:51:14,820 - INFO - Model directory checked/created.
2024-10-24 19:51:20,193 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-24 19:51:21,669 - INFO - Data loaded from ./Model_build1/merged_data_prediction.xlsx with shape: (3754, 53)
2024-10-24 19:51:21,671 - INFO - Data loaded with 3754 rows
2024-10-24 19:51:21,677 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-24 19:51:22,263 - INFO - new real scores length: 92
2024-10-24 19:51:22,265 - INFO - prediction_df length: 3754
2024-10-24 19:51:22,270 - INFO - Numeric features selected: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 19:51:24,286 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-24 19:51:24,286 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-24 19:51:24,286 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-24 19:51:24,303 - INFO - Data scaling completed.
2024-10-24 19:51:24,319 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-24 19:55:12,093 - INFO - Feature selection using RFE completed.
2024-10-24 19:55:12,095 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_poisson_xG']
2024-10-24 19:55:13,150 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-24 19:57:40,405 - INFO - Stacking model for away_goals trained successfully.
2024-10-24 19:57:42,152 - INFO - away_goals Stacking Model MSE: 0.09212698145061654, R2: 0.9257192339399731, Stacking Model MAE: 0.1554844152566306, Stacking Model MAPE: inf%
2024-10-24 20:06:28,337 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpcwaqnwff\assets
2024-10-24 20:06:28,421 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-24 20:06:28,903 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-24 20:06:28,988 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-24 20:06:28,988 - INFO - Start away_goals predictions
2024-10-24 20:06:28,988 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'Date', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws',
       'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'Home_team_matches', 'Away_team_matches',
       'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins',
       'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg',
       'away_goals_rolling_avg', 'away_goal_difference_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'home_goal_difference_rolling_avg',
       'Home_saves_mean', 'Away_saves_mean', 'Home_shot_on_target_mean',
       'away_shot_on_target_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'referee_foul_rate', 'referee_encoded'],
      dtype='object')
2024-10-24 20:06:29,353 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-24 20:06:29,353 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-24 20:06:29,370 - INFO - [[ 0.5434818  -0.67409896  0.39561804 ... -0.27239153 -2.16563348
  -1.60158079]
 [ 0.92076041  0.48226161  1.05622083 ...  0.25362563 -0.39152035
   0.465453  ]
 [-0.18935945  1.07641373  0.54171289 ... -0.08942904 -1.23422409
  -0.5725624 ]
 ...
 [-0.54101322  0.03505034 -0.7032693  ...  0.0752372  -0.16572414
  -0.30283523]
 [-0.54188186  0.12449259 -0.7159732  ...  0.28481242 -0.29895793
   0.07766439]
 [-0.54115799 -0.18216657 -0.69691735 ... -0.4636705  -0.60925242
  -0.6935269 ]]
2024-10-24 20:06:29,389 - INFO - X_new_prepared:             0         1         2         3         4         5         6         7         8         9   ...        20        21        22        23        24        25        26        27        28        29
0     0.543482 -0.674099  0.395618 -1.186342  0.191735 -1.077531 -1.188873 -0.566434 -1.528959 -0.672074  ... -1.873420  0.693691  0.576274  0.105795 -1.380818 -0.115472 -2.665198 -0.272392 -2.165633 -1.601581
1     0.920760  0.482262  1.056221 -0.234180  2.480222 -0.526715  1.931334  0.637875  0.770614 -0.326558  ... -0.607866  0.736151 -0.900476  0.565134 -0.518834  0.209980 -0.837241  0.253626 -0.391520  0.465453
2    -0.189359  1.076414  0.541713  1.653634 -0.723660  0.244428  0.082322 -4.179359 -0.810342  0.986402  ... -0.572820 -0.341263 -1.424051  0.105795 -0.319915 -0.824328 -0.275833 -0.089429 -1.234224 -0.572562
3     1.001544 -0.897705  0.173300 -1.340450 -0.906739 -0.967368 -0.264367 -0.325572 -0.570803 -0.672074  ... -0.767594  0.035566 -0.699101  0.297186 -0.585141  0.178485 -0.822500  1.557233 -0.421089 -0.763418
4     0.634834 -1.530189  1.430986 -0.014026 -1.364437 -0.196225 -1.882253 -2.372896 -0.890189 -0.672074  ... -0.915832 -0.749938 -0.900476  2.019706 -1.778656 -2.870266 -1.215609 -1.187204 -0.223965 -1.118876
...        ...       ...       ...       ...       ...       ...       ...       ...       ...       ...  ...       ...       ...       ...       ...       ...       ...       ...       ...       ...       ...
3749 -0.542316  0.769755  1.145148  1.549062  2.388683  1.566388  0.891265 -0.205141 -0.029237 -0.546432  ...  0.516513  2.009941 -0.699101 -0.193774  0.041756  0.485421  0.718957 -0.239126 -0.260390 -0.498917
3750 -0.542461  0.776143 -0.366616 -0.795570  2.388683  0.905408  1.237955 -0.686864  0.038932 -0.672074  ...  1.526110 -0.728708  0.234547 -0.624971  0.439595 -0.339185  0.618155  0.995871 -0.851177  0.532530
3751 -0.541013  0.035050 -0.703269 -0.784563 -1.089818  1.235898 -0.611057 -0.927726  0.038932 -0.119249  ...  0.990371  0.465470  0.267499  0.210190 -0.956457  1.020041  1.067103  0.075237 -0.165724 -0.302835
3752 -0.541882  0.124493 -0.715973 -0.746036  1.839446  1.566388  0.082322 -0.205141 -0.029237 -0.546432  ...  1.284429 -1.477060 -0.589260 -0.143846  0.801266  0.347987  0.443354  0.284812 -0.298958  0.077664
3753 -0.541158 -0.182167 -0.696917 -0.845105  0.649432  1.566388 -0.611057 -0.686864  0.038932 -0.546432  ... -0.127358 -0.325341 -0.259737  0.105795 -0.410333 -0.284211 -0.963215 -0.463671 -0.609252 -0.693527

[3754 rows x 30 columns]
2024-10-24 20:06:29,520 - INFO - home goal predictions: [0.01254396 0.18416212 0.01347068 ... 0.07503356 0.28073186 0.33540326]
2024-10-25 17:13:49,117 - INFO - Model directory checked/created.
2024-10-25 17:13:56,079 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 17:13:56,211 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 17:13:56,215 - INFO - Data loaded with 5111 rows
2024-10-25 17:13:56,233 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 17:13:56,685 - INFO - new real scores length: 26
2024-10-25 17:13:56,703 - INFO - data_with_error length: 0
2024-10-25 17:13:56,705 - INFO - prediction_df length: 5111
2024-10-25 17:13:56,714 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:14:02,498 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 17:14:02,498 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 17:14:02,513 - INFO - Data split into train and test. Train shape: (9466, 50), Test shape: (4058, 50)
2024-10-25 17:14:02,513 - INFO - Data scaling completed.
2024-10-25 17:14:02,529 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 17:17:17,630 - INFO - Feature selection using RFE completed.
2024-10-25 17:17:17,632 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Away_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:17:18,684 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 17:19:28,230 - INFO - Stacking model for away_goals trained successfully.
2024-10-25 17:19:30,280 - INFO - away_goals Stacking Model MSE: 0.09156758755482729, R2: 0.9251964945608641, Stacking Model MAE: 0.1607715230292918, Stacking Model MAPE: inf%
2024-10-25 17:19:30,812 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpi6se7jql\assets
2024-10-25 17:19:30,879 - INFO - Stacking model for home goals (without Keras) saved to ./models/away_goals_stacking_model.pkl
2024-10-25 17:19:31,479 - INFO - Assets written to: ./models/nn_regressor_away_goals_model\assets
2024-10-25 17:19:31,626 - INFO - Keras neural network model saved to ./models/nn_regressor_away_goals_model
2024-10-25 17:19:31,628 - INFO - Start away_goals predictions
2024-10-25 17:19:31,630 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 17:19:31,935 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 17:19:31,937 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 17:19:32,162 - INFO - home goal predictions: [ 1.3863385   0.58128345 -0.35002798 ...  1.1741836   0.933727
  1.1876218 ]
2024-10-25 18:58:09,368 - INFO - Model directory checked/created.
2024-10-25 18:58:14,685 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 18:58:14,776 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 18:58:14,776 - INFO - Data loaded with 5111 rows
2024-10-25 18:58:14,785 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 18:58:15,136 - INFO - new real scores length: 26
2024-10-25 18:58:15,153 - INFO - data_with_error length: 0
2024-10-25 18:58:15,157 - INFO - prediction_df length: 5111
2024-10-25 18:58:15,159 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 18:58:17,053 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 18:58:17,069 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 18:58:17,070 - INFO - Data split into train and test. Train shape: (9466, 50), Test shape: (4058, 50)
2024-10-25 18:58:17,085 - INFO - Data scaling completed.
2024-10-25 18:58:17,087 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:01:24,876 - INFO - Feature selection using RFE completed.
2024-10-25 19:01:24,878 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 19:01:25,938 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 19:01:43,781 - WARNING - Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss
2024-10-25 19:01:43,958 - WARNING - Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss
2024-10-25 19:01:44,135 - WARNING - Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss
2024-10-25 19:01:44,315 - WARNING - Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss
2024-10-25 19:01:44,494 - WARNING - Early stopping conditioned on metric `val_loss` which is not available. Available metrics are: loss
2024-10-25 19:04:23,580 - INFO - Model directory checked/created.
2024-10-25 19:04:28,668 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 19:04:28,737 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 19:04:28,751 - INFO - Data loaded with 5111 rows
2024-10-25 19:04:28,754 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 19:04:29,072 - INFO - new real scores length: 26
2024-10-25 19:04:29,072 - INFO - data_with_error length: 0
2024-10-25 19:04:29,086 - INFO - prediction_df length: 5111
2024-10-25 19:04:29,090 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:04:30,953 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 19:04:30,969 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 19:04:30,969 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 19:04:30,986 - INFO - Data scaling completed.
2024-10-25 19:04:31,003 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:08:01,753 - INFO - Feature selection using RFE completed.
2024-10-25 19:08:01,770 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 19:08:02,853 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 19:11:37,964 - INFO - Model directory checked/created.
2024-10-25 19:11:43,482 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 19:11:43,596 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 19:11:43,598 - INFO - Data loaded with 5111 rows
2024-10-25 19:11:43,604 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 19:11:43,900 - INFO - new real scores length: 26
2024-10-25 19:11:43,910 - INFO - data_with_error length: 0
2024-10-25 19:11:43,914 - INFO - prediction_df length: 5111
2024-10-25 19:11:43,917 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:11:45,735 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 19:11:45,737 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 19:11:45,743 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 19:11:45,756 - INFO - Data scaling completed.
2024-10-25 19:11:45,769 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:15:23,238 - INFO - Feature selection using RFE completed.
2024-10-25 19:15:23,238 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 19:15:24,470 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 19:15:49,247 - INFO - Assets written to: C:\Users\szita\AppData\Local\Temp\tmpr_dh0tkr\assets
2024-10-25 19:17:26,941 - INFO - Model directory checked/created.
2024-10-25 19:17:31,806 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 19:17:31,888 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 19:17:31,888 - INFO - Data loaded with 5111 rows
2024-10-25 19:17:31,905 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 19:17:32,205 - INFO - new real scores length: 26
2024-10-25 19:17:32,221 - INFO - data_with_error length: 0
2024-10-25 19:17:32,221 - INFO - prediction_df length: 5111
2024-10-25 19:17:32,221 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:17:33,954 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 19:17:33,954 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 19:17:33,954 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 19:17:33,971 - INFO - Data scaling completed.
2024-10-25 19:17:33,989 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:21:02,939 - INFO - Feature selection using RFE completed.
2024-10-25 19:21:02,939 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 19:21:04,170 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 19:21:29,755 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpz_um0lvp\tmp4xj_v2i9\assets
2024-10-25 19:39:42,901 - INFO - Model directory checked/created.
2024-10-25 19:39:47,998 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 19:39:48,092 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 19:39:48,094 - INFO - Data loaded with 5111 rows
2024-10-25 19:39:48,099 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 19:39:48,400 - INFO - new real scores length: 26
2024-10-25 19:39:48,425 - INFO - data_with_error length: 0
2024-10-25 19:39:48,434 - INFO - prediction_df length: 5111
2024-10-25 19:39:48,437 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:39:50,343 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 19:39:50,345 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 19:39:50,349 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 19:39:50,362 - INFO - Data scaling completed.
2024-10-25 19:39:50,376 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:43:28,038 - INFO - Feature selection using RFE completed.
2024-10-25 19:43:28,040 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:43:29,191 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 19:46:29,066 - INFO - Model directory checked/created.
2024-10-25 19:46:34,205 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 19:46:34,312 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 19:46:34,319 - INFO - Data loaded with 5111 rows
2024-10-25 19:46:34,325 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 19:46:34,680 - INFO - new real scores length: 26
2024-10-25 19:46:34,688 - INFO - data_with_error length: 0
2024-10-25 19:46:34,692 - INFO - prediction_df length: 5111
2024-10-25 19:46:34,695 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:46:36,489 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 19:46:36,490 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 19:46:36,497 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 19:46:36,511 - INFO - Data scaling completed.
2024-10-25 19:46:36,524 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:47:10,408 - INFO - Model directory checked/created.
2024-10-25 19:47:15,343 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 19:47:15,426 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 19:47:15,426 - INFO - Data loaded with 5111 rows
2024-10-25 19:47:15,442 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 19:47:15,759 - INFO - new real scores length: 26
2024-10-25 19:47:15,776 - INFO - data_with_error length: 0
2024-10-25 19:47:15,779 - INFO - prediction_df length: 5111
2024-10-25 19:47:15,782 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 19:47:17,696 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 19:47:17,699 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 19:47:17,704 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 19:47:17,720 - INFO - Data scaling completed.
2024-10-25 19:47:17,734 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 19:50:55,457 - INFO - Feature selection using RFE completed.
2024-10-25 19:50:55,459 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_poisson_xG']
2024-10-25 19:50:56,591 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 19:55:19,709 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 20:03:34,776 - INFO - Stacking model for away_goals trained successfully on second split.
2024-10-25 20:03:36,224 - INFO - away_goals Stacking Model MSE: 2.398017413445604, R2: -0.9334897083489699, Stacking Model MAE: 1.1727510742286964, Stacking Model MAPE: inf%
2024-10-25 20:03:37,616 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08591769936060883, R2: 0.9323643116972755, Stacking Model MAE: 0.14421043710906525, Stacking Model MAPE: inf%
2024-10-25 20:03:37,616 - INFO - Start away_goals predictions
2024-10-25 20:03:37,624 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 20:03:37,969 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 20:03:37,972 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:04:49,194 - INFO - Model directory checked/created.
2024-10-25 20:04:54,270 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 20:04:54,362 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 20:04:54,362 - INFO - Data loaded with 5111 rows
2024-10-25 20:04:54,362 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 20:04:54,660 - INFO - new real scores length: 26
2024-10-25 20:04:54,677 - INFO - data_with_error length: 0
2024-10-25 20:04:54,677 - INFO - prediction_df length: 5111
2024-10-25 20:04:54,677 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:04:56,549 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 20:04:56,551 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 20:04:56,555 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 20:04:56,567 - INFO - Data scaling completed.
2024-10-25 20:04:56,577 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 20:08:29,962 - INFO - Feature selection using RFE completed.
2024-10-25 20:08:29,965 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 20:08:31,073 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 20:13:08,224 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 20:13:09,703 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09198374189665783, R2: 0.925834726096892, Stacking Model MAE: 0.1459381620517341, Stacking Model MAPE: inf%
2024-10-25 20:21:47,294 - INFO - Stacking model for away_goals trained successfully on second split.
2024-10-25 20:21:48,717 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08303240185240901, R2: 0.9346356607252118, Stacking Model MAE: 0.14244695215641787, Stacking Model MAPE: inf%
2024-10-25 20:21:48,718 - INFO - Start away_goals predictions
2024-10-25 20:21:48,718 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 20:21:49,045 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 20:21:49,047 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:22:39,183 - INFO - Model directory checked/created.
2024-10-25 20:22:44,131 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 20:22:44,225 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 20:22:44,227 - INFO - Data loaded with 5111 rows
2024-10-25 20:22:44,232 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 20:22:44,540 - INFO - new real scores length: 26
2024-10-25 20:22:44,551 - INFO - data_with_error length: 0
2024-10-25 20:22:44,554 - INFO - prediction_df length: 5111
2024-10-25 20:22:44,556 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:22:46,399 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 20:22:46,399 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 20:22:46,410 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 20:22:46,418 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 20:22:46,460 - INFO - Data scaling completed.
2024-10-25 20:22:46,478 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 20:24:48,446 - INFO - Model directory checked/created.
2024-10-25 20:24:53,580 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 20:24:53,662 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 20:24:53,662 - INFO - Data loaded with 5111 rows
2024-10-25 20:24:53,680 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 20:24:53,985 - INFO - new real scores length: 26
2024-10-25 20:24:53,996 - INFO - data_with_error length: 0
2024-10-25 20:24:53,999 - INFO - prediction_df length: 5111
2024-10-25 20:24:54,002 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:24:55,878 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 20:24:55,879 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 20:24:55,879 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 20:24:55,879 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 20:24:55,879 - INFO - Data scaling started.
2024-10-25 20:24:55,912 - INFO - Data scaling completed.
2024-10-25 20:24:55,929 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 20:24:55,929 - INFO - Feature Selection started.
2024-10-25 20:32:06,619 - INFO - Feature selection using RFE completed.
2024-10-25 20:32:06,629 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:32:07,829 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 20:32:07,829 - INFO - First fit started
2024-10-25 20:36:44,335 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 20:37:52,033 - INFO - Model directory checked/created.
2024-10-25 20:37:56,987 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 20:37:57,090 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 20:37:57,091 - INFO - Data loaded with 5111 rows
2024-10-25 20:37:57,097 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 20:37:57,415 - INFO - new real scores length: 26
2024-10-25 20:37:57,415 - INFO - data_with_error length: 0
2024-10-25 20:37:57,432 - INFO - prediction_df length: 5111
2024-10-25 20:37:57,435 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:37:59,245 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 20:37:59,248 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 20:37:59,248 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 20:37:59,248 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 20:37:59,248 - INFO - Data scaling started.
2024-10-25 20:37:59,282 - INFO - Data scaling completed.
2024-10-25 20:37:59,295 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 20:37:59,297 - INFO - Feature Selection started.
2024-10-25 20:45:32,988 - INFO - Feature selection using RFE completed.
2024-10-25 20:45:32,992 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 20:45:34,144 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 20:45:34,146 - INFO - First fit started
2024-10-25 20:50:44,771 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 20:50:46,595 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09059270016723844, R2: 0.926956304636162, Stacking Model MAE: 0.1495569359469574, Stacking Model MAPE: inf%
2024-10-25 20:50:46,597 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.98890942698706%
2024-10-25 20:50:46,598 - INFO - Second fit started
2024-10-25 20:56:53,667 - INFO - Stacking model for away_goals trained successfully on second split.
2024-10-25 20:56:55,500 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08508969093677979, R2: 0.9330161322195067, Stacking Model MAE: 0.14220027262334733, Stacking Model MAPE: inf%
2024-10-25 20:56:55,503 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.98890942698706%
2024-10-25 20:56:55,506 - INFO - Start away_goals predictions
2024-10-25 20:56:55,515 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 20:56:55,907 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 20:56:55,909 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:02:38,699 - INFO - Model directory checked/created.
2024-10-25 21:02:43,776 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:02:43,873 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:02:43,875 - INFO - Data loaded with 5111 rows
2024-10-25 21:02:43,880 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:02:44,183 - INFO - new real scores length: 26
2024-10-25 21:02:44,201 - INFO - data_with_error length: 0
2024-10-25 21:02:44,201 - INFO - prediction_df length: 5111
2024-10-25 21:02:44,201 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:02:46,155 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 21:02:46,155 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:02:46,173 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:02:46,173 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:02:46,173 - INFO - Data scaling started.
2024-10-25 21:02:46,185 - INFO - Data scaling1 completed.
2024-10-25 21:02:46,201 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 21:02:46,201 - INFO - Feature Selection started.
2024-10-25 21:09:55,465 - INFO - Model directory checked/created.
2024-10-25 21:10:01,436 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:10:01,526 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:10:01,528 - INFO - Data loaded with 5111 rows
2024-10-25 21:10:01,535 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:10:01,867 - INFO - new real scores length: 26
2024-10-25 21:10:01,884 - INFO - data_with_error length: 0
2024-10-25 21:10:01,884 - INFO - prediction_df length: 5111
2024-10-25 21:10:01,884 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:10:04,034 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 21:10:04,034 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:10:04,034 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:10:04,034 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:10:04,034 - INFO - Data scaling started.
2024-10-25 21:10:04,064 - INFO - Data scaling1 completed.
2024-10-25 21:10:04,068 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 21:10:04,068 - INFO - Feature Selection started.
2024-10-25 21:16:17,693 - INFO - Model directory checked/created.
2024-10-25 21:16:24,825 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:16:24,928 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:16:24,930 - INFO - Data loaded with 5111 rows
2024-10-25 21:16:24,940 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:16:25,462 - INFO - new real scores length: 26
2024-10-25 21:16:25,479 - INFO - data_with_error length: 0
2024-10-25 21:16:25,498 - INFO - prediction_df length: 5111
2024-10-25 21:16:25,504 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:16:28,468 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 21:16:28,470 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:16:28,477 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:16:28,486 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:16:28,487 - INFO - Data scaling started.
2024-10-25 21:16:28,513 - INFO - Data scaling1 completed.
2024-10-25 21:16:28,524 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 21:16:28,526 - INFO - Feature Selection started.
2024-10-25 21:21:29,430 - INFO - Feature selection using RFE completed.
2024-10-25 21:21:29,432 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 21:21:30,620 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 21:21:30,620 - INFO - First fit started
2024-10-25 21:27:18,944 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 21:27:20,572 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09102914497631297, R2: 0.9266044049619242, Stacking Model MAE: 0.15066946060198988, Stacking Model MAPE: inf%
2024-10-25 21:27:20,574 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 86.35859519408503%
2024-10-25 21:27:20,576 - INFO - Second fit started
2024-10-25 21:30:05,489 - INFO - Model directory checked/created.
2024-10-25 21:30:11,496 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:30:11,616 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:30:11,618 - INFO - Data loaded with 5111 rows
2024-10-25 21:30:11,623 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:30:11,958 - INFO - new real scores length: 26
2024-10-25 21:30:11,968 - INFO - data_with_error length: 0
2024-10-25 21:30:11,971 - INFO - prediction_df length: 5111
2024-10-25 21:30:11,975 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:30:14,195 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 21:30:14,198 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:30:14,205 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:30:14,207 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:30:14,207 - INFO - Data scaling started.
2024-10-25 21:30:14,231 - INFO - Data scaling1 completed.
2024-10-25 21:30:14,246 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 21:30:14,247 - INFO - Feature Selection started.
2024-10-25 21:34:19,073 - INFO - Feature selection using RFE completed.
2024-10-25 21:34:19,076 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 21:34:20,202 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 21:34:20,204 - INFO - First fit started
2024-10-25 21:40:18,384 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 21:40:20,129 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09392063552274875, R2: 0.9242730343963999, Stacking Model MAE: 0.14842606939422903, Stacking Model MAPE: inf%
2024-10-25 21:40:20,131 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.87800369685768%
2024-10-25 21:40:21,508 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp_9_0gkrg\tmp18_q09xh\assets
2024-10-25 21:45:29,974 - INFO - Model directory checked/created.
2024-10-25 21:45:37,173 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:45:37,313 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:45:37,315 - INFO - Data loaded with 5111 rows
2024-10-25 21:45:37,324 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:45:37,784 - INFO - new real scores length: 26
2024-10-25 21:45:37,798 - INFO - data_with_error length: 0
2024-10-25 21:45:37,802 - INFO - prediction_df length: 5111
2024-10-25 21:45:37,806 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:45:40,396 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 21:45:40,399 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:45:40,407 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:45:40,413 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:45:40,415 - INFO - Data scaling started.
2024-10-25 21:45:40,440 - INFO - Data scaling1 completed.
2024-10-25 21:45:40,454 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 21:45:40,454 - INFO - Feature Selection started.
2024-10-25 21:49:44,008 - INFO - Feature selection using RFE completed.
2024-10-25 21:49:44,010 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_poisson_xG']
2024-10-25 21:49:45,004 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 21:49:45,005 - INFO - First fit started
2024-10-25 21:50:00,887 - INFO - Model directory checked/created.
2024-10-25 21:50:06,171 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 21:50:06,248 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 21:50:06,250 - INFO - Data loaded with 5111 rows
2024-10-25 21:50:06,255 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 21:50:06,562 - INFO - new real scores length: 26
2024-10-25 21:50:06,572 - INFO - data_with_error length: 0
2024-10-25 21:50:06,575 - INFO - prediction_df length: 5111
2024-10-25 21:50:06,579 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 21:50:08,377 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 21:50:08,378 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 21:50:08,383 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 21:50:08,390 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 21:50:08,392 - INFO - Data scaling started.
2024-10-25 21:50:08,409 - INFO - Data scaling1 completed.
2024-10-25 21:50:08,420 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 21:50:08,421 - INFO - Feature Selection started.
2024-10-25 21:54:10,886 - INFO - Feature selection using RFE completed.
2024-10-25 21:54:10,888 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 21:54:12,013 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 21:54:12,014 - INFO - First fit started
2024-10-25 22:00:07,357 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 22:00:08,981 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09448230195290347, R2: 0.9238201701860984, Stacking Model MAE: 0.14942548264570304, Stacking Model MAPE: inf%
2024-10-25 22:00:08,984 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.95194085027727%
2024-10-25 22:00:08,987 - INFO - Start away_goals predictions
2024-10-25 22:00:08,989 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:00:09,336 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 22:00:09,338 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:05:18,252 - INFO - Model directory checked/created.
2024-10-25 22:05:24,260 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:05:24,382 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:05:24,383 - INFO - Data loaded with 5111 rows
2024-10-25 22:05:24,388 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:05:24,724 - INFO - new real scores length: 26
2024-10-25 22:05:24,740 - INFO - data_with_error length: 0
2024-10-25 22:05:24,740 - INFO - prediction_df length: 5111
2024-10-25 22:05:24,740 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:05:26,669 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 22:05:26,672 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:05:26,677 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:05:26,684 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:05:26,686 - INFO - Data scaling started.
2024-10-25 22:05:26,707 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 22:05:26,715 - INFO - Data scaling1 completed.
2024-10-25 22:05:26,717 - INFO - Feature Selection started.
2024-10-25 22:09:37,894 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 22:09:37,899 - INFO - Feature selection using RFE completed.
2024-10-25 22:09:37,901 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:09:37,903 - INFO - First fit started
2024-10-25 22:15:13,711 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 22:15:15,450 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09245399731308523, R2: 0.9254555653773493, Stacking Model MAE: 0.14858727658855356, Stacking Model MAPE: inf%
2024-10-25 22:15:15,453 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 86.13678373382625%
2024-10-25 22:15:15,456 - INFO - Start away_goals predictions
2024-10-25 22:15:15,459 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:15:15,808 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 22:15:15,808 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:18:04,102 - INFO - Model directory checked/created.
2024-10-25 22:18:10,775 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:18:10,875 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:18:10,875 - INFO - Data loaded with 5111 rows
2024-10-25 22:18:10,892 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:18:11,191 - INFO - new real scores length: 26
2024-10-25 22:18:11,209 - INFO - data_with_error length: 0
2024-10-25 22:18:11,209 - INFO - prediction_df length: 5111
2024-10-25 22:18:11,223 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:18:13,108 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 22:18:13,112 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:18:13,117 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:18:13,121 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:18:13,122 - INFO - Data scaling started.
2024-10-25 22:18:13,142 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 22:18:13,144 - INFO - Data scaling1 completed.
2024-10-25 22:18:13,144 - INFO - Feature Selection started.
2024-10-25 22:22:17,847 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 22:22:17,848 - INFO - Feature selection using RFE completed.
2024-10-25 22:22:17,848 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:22:17,857 - INFO - First fit started
2024-10-25 22:27:56,440 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 22:27:58,101 - INFO - away_goals (1st fit) Stacking Model MSE: 0.08986283005851861, R2: 0.927544789246711, Stacking Model MAE: 0.14810587245401083, Stacking Model MAPE: inf%
2024-10-25 22:27:58,103 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.95194085027727%
2024-10-25 22:27:58,106 - INFO - Start away_goals predictions
2024-10-25 22:27:58,108 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:27:58,478 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 22:27:58,479 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:27:58,497 - ERROR - Error occurred while making prediction: This StandardScaler instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2024-10-25 22:27:59,526 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp0oyoozmo\tmpmupz7x4j\assets
2024-10-25 22:29:47,743 - INFO - Model directory checked/created.
2024-10-25 22:29:53,154 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:29:53,260 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:29:53,260 - INFO - Data loaded with 5111 rows
2024-10-25 22:29:53,260 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:29:53,593 - INFO - new real scores length: 26
2024-10-25 22:29:53,612 - INFO - data_with_error length: 0
2024-10-25 22:29:53,615 - INFO - prediction_df length: 5111
2024-10-25 22:29:53,618 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:29:55,694 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 22:29:55,696 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:29:55,701 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:29:55,706 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:29:55,707 - INFO - Data scaling started.
2024-10-25 22:29:55,727 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 22:29:55,734 - INFO - Data scaling1 completed.
2024-10-25 22:29:55,736 - INFO - Feature Selection started.
2024-10-25 22:33:56,396 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 22:33:56,402 - INFO - Feature selection using RFE completed.
2024-10-25 22:33:56,403 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:33:56,404 - INFO - First fit started
2024-10-25 22:39:36,717 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 22:39:38,417 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09082616513317139, R2: 0.9267680649234892, Stacking Model MAE: 0.14727256592817517, Stacking Model MAPE: inf%
2024-10-25 22:39:38,421 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.5452865064695%
2024-10-25 22:39:38,426 - INFO - Start away_goals predictions
2024-10-25 22:39:38,429 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:39:38,761 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 22:39:38,763 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:39:41,640 - INFO - home goal predictions: [0.90284462 0.50903652 0.02941172 ... 1.04545125 0.95351552 1.0646937 ]
2024-10-25 22:39:52,554 - INFO - Assets written to: ./models/nn_regressor_away_goals_stacked_2fit\assets
2024-10-25 22:39:52,650 - INFO - Keras model saved successfully at ./models/nn_regressor_away_goals_stacked_2fit
2024-10-25 22:39:52,659 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x000001DCAE5B4AF0>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 22:42:00,119 - INFO - Model directory checked/created.
2024-10-25 22:42:06,379 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:42:06,414 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:42:06,418 - INFO - Data loaded with 5111 rows
2024-10-25 22:42:06,424 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:42:06,744 - INFO - new real scores length: 26
2024-10-25 22:42:06,755 - INFO - data_with_error length: 0
2024-10-25 22:42:06,759 - INFO - prediction_df length: 5111
2024-10-25 22:42:06,764 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:42:08,856 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 22:42:08,860 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:42:08,868 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:42:08,873 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:42:08,875 - INFO - Data scaling started.
2024-10-25 22:42:08,912 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 22:42:08,919 - INFO - Data scaling1 completed.
2024-10-25 22:42:08,922 - INFO - Feature Selection started.
2024-10-25 22:46:04,578 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 22:46:04,583 - INFO - Feature selection using RFE completed.
2024-10-25 22:46:04,584 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Home_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:46:04,589 - INFO - First fit started
2024-10-25 22:51:40,703 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 22:51:42,485 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09213568604677472, R2: 0.9257122155392756, Stacking Model MAE: 0.14916245421751734, Stacking Model MAPE: inf%
2024-10-25 22:51:42,487 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.6192236598891%
2024-10-25 22:51:42,490 - INFO - Start away_goals predictions
2024-10-25 22:51:42,492 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 22:51:42,894 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 22:51:42,896 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:51:45,727 - INFO - home goal predictions: [ 0.75732588  0.4678916  -0.20046075 ...  0.99669303  0.962683
  0.98577478]
2024-10-25 22:51:56,656 - INFO - Assets written to: ./models/nn_regressor_away_goals_stacked_2fit\assets
2024-10-25 22:51:56,745 - INFO - Keras model saved successfully at ./models/nn_regressor_away_goals_stacked_2fit
2024-10-25 22:51:56,761 - ERROR - Error occurred while saving models: 'nn'
2024-10-25 22:55:05,678 - INFO - Model directory checked/created.
2024-10-25 22:55:11,732 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 22:55:11,865 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 22:55:11,865 - INFO - Data loaded with 5111 rows
2024-10-25 22:55:11,884 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 22:55:12,394 - INFO - new real scores length: 26
2024-10-25 22:55:12,413 - INFO - data_with_error length: 0
2024-10-25 22:55:12,419 - INFO - prediction_df length: 5111
2024-10-25 22:55:12,424 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 22:55:14,647 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 22:55:14,647 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 22:55:14,663 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 22:55:14,664 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 22:55:14,664 - INFO - Data scaling started.
2024-10-25 22:55:14,701 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 22:55:14,709 - INFO - Data scaling1 completed.
2024-10-25 22:55:14,710 - INFO - Feature Selection started.
2024-10-25 22:59:06,389 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 22:59:06,393 - INFO - Feature selection using RFE completed.
2024-10-25 22:59:06,394 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 22:59:06,396 - INFO - First fit started
2024-10-25 23:04:56,862 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 23:04:58,587 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09060290753221238, R2: 0.9269480745728539, Stacking Model MAE: 0.14858209282509754, Stacking Model MAPE: inf%
2024-10-25 23:04:58,589 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.4343807763401%
2024-10-25 23:04:58,592 - INFO - Start away_goals predictions
2024-10-25 23:04:58,594 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:04:58,949 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 23:04:58,951 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:05:01,927 - INFO - home goal predictions: [ 1.05057915  0.63858755 -0.03946908 ...  1.02408067  0.94893547
  1.03539045]
2024-10-25 23:05:12,908 - INFO - Assets written to: ./models/nn_regressor_away_goals_stacked_2fit\assets
2024-10-25 23:05:13,003 - INFO - Keras model saved successfully at ./models/nn_regressor_away_goals_stacked_2fit
2024-10-25 23:05:13,900 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpo48c96xp\tmpu3angjpb\assets
2024-10-25 23:05:14,195 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x0000027CED34E160>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:17:54,632 - INFO - Model directory checked/created.
2024-10-25 23:18:00,751 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:18:00,789 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:18:00,791 - INFO - Data loaded with 5111 rows
2024-10-25 23:18:00,797 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:18:01,107 - INFO - new real scores length: 26
2024-10-25 23:18:01,117 - INFO - data_with_error length: 0
2024-10-25 23:18:01,120 - INFO - prediction_df length: 5111
2024-10-25 23:18:01,124 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:18:03,066 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 23:18:03,069 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:18:03,075 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:18:03,083 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:18:03,085 - INFO - Data scaling started.
2024-10-25 23:18:03,123 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 23:18:03,134 - INFO - Data scaling1 completed.
2024-10-25 23:18:03,136 - INFO - Feature Selection started.
2024-10-25 23:21:57,296 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 23:21:57,300 - INFO - Feature selection using RFE completed.
2024-10-25 23:21:57,302 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 23:21:57,303 - INFO - First fit started
2024-10-25 23:27:11,027 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 23:27:12,577 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09145382328941205, R2: 0.9262619924576896, Stacking Model MAE: 0.14904094817458327, Stacking Model MAPE: inf%
2024-10-25 23:27:12,580 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.21256931608133%
2024-10-25 23:27:12,584 - INFO - Start away_goals predictions
2024-10-25 23:27:12,586 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:27:12,903 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 23:27:12,905 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:27:15,835 - INFO - home goal predictions: [ 0.90248016  0.42029511 -0.23017777 ...  1.00575351  0.94786272
  0.98971913]
2024-10-25 23:27:26,894 - INFO - Assets written to: ./models/nn_regressor_away_goals_stacked_2fit\assets
2024-10-25 23:27:26,995 - INFO - Keras model saved successfully at ./models/nn_regressor_away_goals_stacked_2fit
2024-10-25 23:27:27,004 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x0000022B85DEEB80>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-25 23:43:23,988 - INFO - Model directory checked/created.
2024-10-25 23:43:29,142 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-25 23:43:29,239 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-25 23:43:29,242 - INFO - Data loaded with 5111 rows
2024-10-25 23:43:29,251 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-25 23:43:29,562 - INFO - new real scores length: 26
2024-10-25 23:43:29,572 - INFO - data_with_error length: 0
2024-10-25 23:43:29,579 - INFO - prediction_df length: 5111
2024-10-25 23:43:29,583 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:43:31,439 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-25 23:43:31,442 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-25 23:43:31,450 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-25 23:43:31,456 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-25 23:43:31,458 - INFO - Data scaling started.
2024-10-25 23:43:31,482 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-25 23:43:31,493 - INFO - Data scaling1 completed.
2024-10-25 23:43:31,495 - INFO - Feature Selection started.
2024-10-25 23:47:22,836 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-25 23:47:22,836 - INFO - Feature selection using RFE completed.
2024-10-25 23:47:22,852 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-25 23:47:22,853 - INFO - First fit started
2024-10-25 23:52:49,483 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-25 23:52:51,322 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09136574802181845, R2: 0.9263330063804817, Stacking Model MAE: 0.1486285592545694, Stacking Model MAPE: inf%
2024-10-25 23:52:51,324 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.76709796672827%
2024-10-25 23:52:51,327 - INFO - Start away_goals predictions
2024-10-25 23:52:51,329 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-25 23:52:51,728 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-25 23:52:51,730 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-25 23:52:55,108 - INFO - home goal predictions: [0.89406674 0.46089029 0.05560805 ... 1.03395451 0.94978828 1.05302348]
2024-10-25 23:53:06,508 - INFO - Assets written to: ./models/nn_regressor_away_goals_stacked_2fit\assets
2024-10-25 23:53:06,607 - INFO - Keras model saved successfully at ./models/nn_regressor_away_goals_stacked_2fit
2024-10-25 23:53:07,592 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp8ru3ouhs\tmp4m_08a4x\assets
2024-10-25 23:53:07,862 - ERROR - Error occurred while saving models: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x00000270AE70F280>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 18:32:56,413 - INFO - Model directory checked/created.
2024-10-28 18:33:01,346 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-10-28 18:33:01,446 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-10-28 18:33:01,448 - INFO - Data loaded with 5111 rows
2024-10-28 18:33:01,453 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-10-28 18:33:01,801 - INFO - new real scores length: 26
2024-10-28 18:33:01,808 - INFO - data_with_error length: 0
2024-10-28 18:33:01,812 - INFO - prediction_df length: 5111
2024-10-28 18:33:01,816 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 18:33:03,645 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-10-28 18:33:03,645 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-10-28 18:33:03,662 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-10-28 18:33:03,662 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-10-28 18:33:03,662 - INFO - Data scaling started.
2024-10-28 18:33:03,697 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-10-28 18:33:03,697 - INFO - Data scaling completed.
2024-10-28 18:33:03,697 - INFO - Feature Selection started.
2024-10-28 18:36:43,390 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-10-28 18:36:43,394 - INFO - Feature selection using RFE completed.
2024-10-28 18:36:43,396 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-10-28 18:36:43,398 - INFO - First fit started
2024-10-28 18:41:06,282 - INFO - Stacking model for away_goals trained successfully on first split.
2024-10-28 18:41:07,793 - INFO - away_goals (1st fit) Stacking Model MSE: 0.08961152774627054, R2: 0.9277474109756825, Stacking Model MAE: 0.14608570836621584, Stacking Model MAPE: inf%
2024-10-28 18:41:07,795 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.84103512014788%
2024-10-28 18:41:07,797 - INFO - Second fit started
2024-10-28 18:45:30,944 - INFO - Stacking model for away_goals trained successfully on second split.
2024-10-28 18:45:32,444 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08794673924963188, R2: 0.9307670213774806, Stacking Model MAE: 0.14421702253254423, Stacking Model MAPE: inf%
2024-10-28 18:45:32,444 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.6561922365989%
2024-10-28 18:45:32,444 - INFO - Start away_goals predictions
2024-10-28 18:45:32,444 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-10-28 18:45:32,794 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-10-28 18:45:32,810 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-10-28 18:45:35,444 - INFO - away_goals predictions: [ 1.09053391  0.90470271 -0.36504126 ...  1.03267718  1.01351741
  0.99441665]
2024-10-28 18:45:48,392 - INFO - Assets written to: ./models/nn_regressor_away_goals_stacked_2fit\assets
2024-10-28 18:45:48,510 - INFO - Keras model saved successfully at ./models/nn_regressor_away_goals_stacked_2fit
2024-10-28 18:45:49,225 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp91f7_idq\tmpjv85mt2m\assets
2024-10-28 18:45:49,482 - INFO - Error with joblib: Can't pickle <function ReduceLROnPlateau._reset.<locals>.<lambda> at 0x0000023773EA4820>: it's not found as keras.callbacks.ReduceLROnPlateau._reset.<locals>.<lambda>
2024-10-28 18:45:50,454 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp91f7_idq\tmpl6k2jt_m\assets
2024-10-28 18:45:50,780 - INFO - Stacking model (without nn) saved successfully to ./models/model_stacked_2fit_away_goals.pkl
2024-10-28 18:45:51,105 - INFO - Keras model zipped successfully at ./models/nn_regressor_away_goals_stacked_2fit.zip
2024-11-02 19:20:07,277 - INFO - Model directory checked/created.
2024-11-02 19:20:12,296 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:20:12,378 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:20:12,378 - INFO - Data loaded with 5111 rows
2024-11-02 19:20:12,394 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:20:12,728 - INFO - new real scores length: 26
2024-11-02 19:20:12,894 - INFO - data_with_error length: 0
2024-11-02 19:20:12,894 - INFO - prediction_df length: 5111
2024-11-02 19:20:12,894 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:20:14,859 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 19:20:14,861 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:20:14,867 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:20:14,872 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:20:14,874 - INFO - Data scaling started.
2024-11-02 19:20:14,913 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 19:20:14,922 - INFO - Data scaling completed.
2024-11-02 19:20:14,925 - INFO - Feature Selection started.
2024-11-02 19:24:12,367 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 19:24:12,373 - INFO - Feature selection using RFE completed.
2024-11-02 19:24:12,374 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-11-02 19:24:12,376 - INFO - First fit started
2024-11-02 19:27:26,186 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 19:30:29,203 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 19:30:31,737 - INFO - away_goals (1st fit) Stacking Model MSE: 0.0924769360414686, R2: 0.9254370701841939, Stacking Model MAE: 0.1485435748277851, Stacking Model MAPE: inf%
2024-11-02 19:30:31,739 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 86.6543438077634%
2024-11-02 19:30:31,744 - INFO - Second fit started
2024-11-02 19:34:36,863 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0002s vs `on_predict_batch_end` time: 0.0023s). Check your callbacks.
2024-11-02 19:38:04,480 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 19:38:06,302 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08658387233630618, R2: 0.9318398904421061, Stacking Model MAE: 0.1443449007475659, Stacking Model MAPE: inf%
2024-11-02 19:38:06,313 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.6192236598891%
2024-11-02 19:38:06,324 - INFO - Start away_goals predictions
2024-11-02 19:38:06,326 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 19:38:06,664 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-11-02 19:38:06,664 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:38:09,663 - INFO - away_goals predictions: [ 1.16131766  0.64879657 -0.32932203 ...  1.0344949   0.93713395
  1.1110385 ]
2024-11-02 19:38:23,031 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpxbvw4w_x\tmphsqi3fxz\assets
2024-11-02 19:45:10,965 - INFO - Model directory checked/created.
2024-11-02 19:45:17,249 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:45:17,282 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:45:17,282 - INFO - Data loaded with 5111 rows
2024-11-02 19:45:17,282 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:45:17,748 - INFO - new real scores length: 274
2024-11-02 19:53:46,417 - INFO - Model directory checked/created.
2024-11-02 19:53:52,029 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:53:52,149 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:53:52,149 - INFO - Data loaded with 5111 rows
2024-11-02 19:53:52,149 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:53:52,683 - INFO - new real scores length: 274
2024-11-02 19:53:52,834 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 19:53:52,834 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 19:53:52,834 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 19:53:52,849 - INFO - data_with_error length: 0
2024-11-02 19:53:52,850 - INFO - prediction_df length: 5111
2024-11-02 19:53:52,850 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:53:54,783 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 19:53:54,786 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:53:54,792 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:53:54,797 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:53:54,800 - INFO - Data scaling started.
2024-11-02 19:53:54,821 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 19:53:54,833 - INFO - Data scaling completed.
2024-11-02 19:53:54,835 - INFO - Feature Selection started.
2024-11-02 19:56:15,984 - INFO - Model directory checked/created.
2024-11-02 19:56:21,594 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 19:56:21,684 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 19:56:21,699 - INFO - Data loaded with 5111 rows
2024-11-02 19:56:21,701 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 19:56:22,249 - INFO - new real scores length: 274
2024-11-02 19:56:22,398 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 19:56:22,401 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 19:56:22,401 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 19:56:22,401 - INFO - data_with_error length: 267
2024-11-02 19:56:22,401 - INFO - prediction_df length: 5111
2024-11-02 19:56:22,401 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 19:56:24,500 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 19:56:24,500 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 19:56:24,500 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 19:56:24,518 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 19:56:24,520 - INFO - Data scaling started.
2024-11-02 19:56:24,547 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 19:56:24,558 - INFO - Data scaling completed.
2024-11-02 19:56:24,560 - INFO - Feature Selection started.
2024-11-02 20:00:25,084 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 20:00:25,084 - INFO - Feature selection using RFE completed.
2024-11-02 20:00:25,084 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:00:25,084 - INFO - First fit started
2024-11-02 20:05:27,667 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 20:05:29,270 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09224322984576931, R2: 0.9256255043972352, Stacking Model MAE: 0.15102936031358705, Stacking Model MAPE: inf%
2024-11-02 20:05:29,283 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.5083179297597%
2024-11-02 20:05:29,285 - INFO - Second fit started
2024-11-02 20:10:09,759 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 20:10:11,272 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08777133764392316, R2: 0.9309051001251636, Stacking Model MAE: 0.1461203123312594, Stacking Model MAPE: inf%
2024-11-02 20:10:11,275 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.32347504621072%
2024-11-02 20:10:11,281 - INFO - Start away_goals predictions
2024-11-02 20:10:11,284 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:10:11,286 - ERROR - Error occurred while making prediction: This StandardScaler instance is not fitted yet. Call 'fit' with appropriate arguments before using this estimator.
2024-11-02 20:10:13,637 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpm2fr_kbx\tmp2rmgdlk0\assets
2024-11-02 20:16:05,904 - INFO - Model directory checked/created.
2024-11-02 20:16:10,621 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:16:10,721 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:16:10,721 - INFO - Data loaded with 5111 rows
2024-11-02 20:16:10,721 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:16:11,155 - INFO - new real scores length: 274
2024-11-02 20:16:11,287 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:16:11,304 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:16:11,304 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:16:11,304 - INFO - data_with_error length: 267
2024-11-02 20:16:11,304 - INFO - prediction_df length: 5111
2024-11-02 20:16:11,304 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:16:12,953 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 20:16:12,953 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:16:12,970 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:16:12,970 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:16:12,970 - INFO - Data scaling started.
2024-11-02 20:16:12,988 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 20:16:13,004 - INFO - Data scaling completed.
2024-11-02 20:16:13,004 - INFO - Feature Selection started.
2024-11-02 20:19:47,321 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 20:19:47,321 - INFO - Feature selection using RFE completed.
2024-11-02 20:19:47,321 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_poisson_xG']
2024-11-02 20:19:47,336 - INFO - First fit started
2024-11-02 20:24:16,122 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 20:24:17,573 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09470802932927622, R2: 0.9236381691894991, Stacking Model MAE: 0.15055373630182292, Stacking Model MAPE: inf%
2024-11-02 20:24:17,575 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.06469500924214%
2024-11-02 20:24:17,577 - INFO - Second fit started
2024-11-02 20:29:26,506 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 20:29:28,086 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08314920716557786, R2: 0.9345437098488221, Stacking Model MAE: 0.1425536360036738, Stacking Model MAPE: inf%
2024-11-02 20:29:28,088 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.5083179297597%
2024-11-02 20:29:28,092 - INFO - Start away_goals predictions
2024-11-02 20:29:28,094 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:29:28,111 - ERROR - Error occurred while making prediction: Input X contains NaN.
RandomForestRegressor does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values
2024-11-02 20:29:30,543 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp0we5xtd9\tmpqo74_7uu\assets
2024-11-02 20:31:42,057 - INFO - Model directory checked/created.
2024-11-02 20:31:48,153 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 20:31:48,189 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 20:31:48,191 - INFO - Data loaded with 5111 rows
2024-11-02 20:31:48,191 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 20:31:48,640 - INFO - new real scores length: 274
2024-11-02 20:31:48,774 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 20:31:48,774 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 20:31:48,774 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 20:31:48,774 - INFO - data_with error columns: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG',
       'home_goals_prediction_rounded', 'away_goals_prediction_rounded',
       'real_home_goals', 'real_away_goals', 'home_error', 'away_error'],
      dtype='object')
2024-11-02 20:31:48,789 - INFO - data_with_error length: 0
2024-11-02 20:31:48,790 - INFO - prediction_df length: 5111
2024-11-02 20:31:48,790 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:31:50,740 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 20:31:50,740 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 20:31:50,740 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 20:31:50,758 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 20:31:50,758 - INFO - Data scaling started.
2024-11-02 20:31:50,774 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 20:31:50,791 - INFO - Data scaling completed.
2024-11-02 20:31:50,791 - INFO - Feature Selection started.
2024-11-02 20:35:41,007 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 20:35:41,023 - INFO - Feature selection using RFE completed.
2024-11-02 20:35:41,024 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-11-02 20:35:41,024 - INFO - First fit started
2024-11-02 20:41:03,611 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 20:41:05,383 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09077820070234674, R2: 0.9268067380093667, Stacking Model MAE: 0.14752323956773347, Stacking Model MAPE: inf%
2024-11-02 20:41:05,391 - INFO - away_goals (1st fit) Stacking Model Within Range (0.3): 85.17560073937153%
2024-11-02 20:41:05,393 - INFO - Second fit started
2024-11-02 20:46:16,096 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 20:46:17,627 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.0851555556913922, R2: 0.9329642825069766, Stacking Model MAE: 0.14100996235411675, Stacking Model MAPE: inf%
2024-11-02 20:46:17,629 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.4343807763401%
2024-11-02 20:46:17,632 - INFO - Start away_goals predictions
2024-11-02 20:46:17,634 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 20:46:17,927 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-11-02 20:46:17,927 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 20:46:20,710 - INFO - away_goals predictions: [ 1.02949599  0.59474329 -0.09907196 ...  0.93339722  0.89452961
  0.97107781]
2024-11-02 20:46:33,013 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmptilhklfe\tmp1qi8fh8j\assets
2024-11-02 21:09:17,001 - INFO - Model directory checked/created.
2024-11-02 21:09:22,821 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 21:09:22,923 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 21:09:22,923 - INFO - Data loaded with 5111 rows
2024-11-02 21:09:22,936 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 21:09:23,518 - INFO - new real scores length: 274
2024-11-02 21:09:23,703 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 21:09:23,705 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 21:09:23,705 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 21:09:23,705 - INFO - running_id                                    0
Date                                          0
season_encoded                                0
league_encoded                                0
home_encoded                                  0
away_encoded                                  0
venue_encoded                                 0
home_league_position                          0
away_league_position                          0
Home_points_cum                               0
Away_points_cum                               0
Home_team_matches                             0
Away_team_matches                             0
Home_goal_difference_cum                      0
Away_goal_difference_cum                      0
Home_draws                                    0
Away_draws                                    0
home_draw_rate                                0
away_draw_rate                                0
home_average_points                           0
away_average_points                           0
home_win_rate                                 0
away_win_rate                                 0
Home_wins                                     0
Away_wins                                     0
home_xG_rolling_avg                           0
away_xG_rolling_avg                           0
home_shots_on_target_accuracy_rolling_avg     0
away_shots_on_target_accuracy_rolling_avg     0
home_shots_on_target_rolling_avg              0
away_shots_on_target_rolling_avg              0
home_saves_accuracy_rolling_avg               0
away_saves_accuracy_rolling_avg               0
home_goals_rolling_avg                        0
away_goals_rolling_avg                        0
home_goal_difference_rolling_avg              0
away_goal_difference_rolling_avg              0
referee_foul_rate                            30
referee_encoded                               0
Home_saves_mean                              29
Away_saves_mean                              22
Home_fouls_mean                              33
Away_fouls_mean                              31
Home_possession_mean                         31
away_possession_mean                         30
Home_shot_on_target_mean                     29
away_shot_on_target_mean                     22
home_team_elo                                 0
away_team_elo                                 0
home_poisson_xG                               0
away_poisson_xG                               0
home_goals_prediction_rounded                 0
away_goals_prediction_rounded                 0
real_home_goals                               0
real_away_goals                               0
home_error                                    0
away_error                                    0
dtype: int64
2024-11-02 21:09:23,705 - INFO - data_with_error length: 234
2024-11-02 21:09:23,719 - INFO - prediction_df length: 5111
2024-11-02 21:09:23,722 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 21:09:25,806 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 21:09:25,817 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 21:09:25,822 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 21:09:25,828 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 21:09:25,829 - INFO - Data scaling started.
2024-11-02 21:09:25,854 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 21:09:25,862 - INFO - Data scaling completed.
2024-11-02 21:09:25,864 - INFO - Feature Selection started.
2024-11-02 21:13:32,135 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 21:13:32,152 - INFO - Feature selection using RFE completed.
2024-11-02 21:13:32,152 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-11-02 21:13:32,152 - INFO - First fit started
2024-11-02 21:13:53,217 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_train_batch_end` time: 0.0025s). Check your callbacks.
2024-11-02 21:18:37,486 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 21:18:38,994 - WARNING - Callback method `on_predict_batch_begin` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_begin` time: 0.0002s). Check your callbacks.
2024-11-02 21:18:38,995 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 21:18:39,075 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09074521552329447, R2: 0.9268333335227554, Stacking Model MAE: 0.14638305980049454, Stacking Model MAPE: inf%
2024-11-02 21:18:39,079 - INFO - away_goals (1st fit) Stacking Model Within Range (0.3): 86.02587800369686%
2024-11-02 21:18:39,080 - INFO - Second fit started
2024-11-02 21:23:49,633 - WARNING - Callback method `on_predict_batch_begin` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_begin` time: 0.0002s). Check your callbacks.
2024-11-02 21:23:50,932 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 21:23:52,604 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08629191099502347, R2: 0.9320697267438507, Stacking Model MAE: 0.14466451094169874, Stacking Model MAPE: inf%
2024-11-02 21:23:52,604 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.6931608133087%
2024-11-02 21:23:52,604 - INFO - Start away_goals predictions
2024-11-02 21:23:52,604 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 21:23:52,626 - ERROR - Error occurred while making prediction: could not convert string to float: '2024-10-23 00:00:00'
2024-11-02 21:23:54,992 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpd7q_heud\tmpfwazfflg\assets
2024-11-02 22:24:20,199 - INFO - Model directory checked/created.
2024-11-02 22:24:25,865 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 22:24:25,949 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5111, 51)
2024-11-02 22:24:25,964 - INFO - Data loaded with 5111 rows
2024-11-02 22:24:25,966 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 22:24:26,449 - INFO - new real scores length: 274
2024-11-02 22:24:26,615 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 22:24:26,615 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 22:24:26,615 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 22:24:26,640 - INFO - data_with_error length: 234
2024-11-02 22:24:26,643 - INFO - prediction_df length: 5111
2024-11-02 22:24:26,646 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:24:28,600 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 22:24:28,616 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 22:24:28,618 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 22:24:28,635 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 22:24:28,635 - INFO - Data scaling started.
2024-11-02 22:24:28,666 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 22:24:28,666 - INFO - Data scaling completed.
2024-11-02 22:24:28,681 - INFO - Feature Selection started.
2024-11-02 22:28:28,612 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 22:28:28,619 - INFO - Feature selection using RFE completed.
2024-11-02 22:28:28,619 - INFO - Selected Features: ['running_id', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-11-02 22:28:28,621 - INFO - First fit started
2024-11-02 22:33:07,289 - WARNING - Callback method `on_predict_batch_end` is slow compared to the batch time (batch time: 0.0000s vs `on_predict_batch_end` time: 0.0002s). Check your callbacks.
2024-11-02 22:34:20,027 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 22:34:21,686 - INFO - away_goals (1st fit) Stacking Model MSE: 0.08950739006879967, R2: 0.9278313758070103, Stacking Model MAE: 0.1438706274158039, Stacking Model MAPE: inf%
2024-11-02 22:34:21,688 - INFO - away_goals (1st fit) Stacking Model Within Range (0.3): 86.02587800369686%
2024-11-02 22:34:21,690 - INFO - Second fit started
2024-11-02 22:39:44,403 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 22:39:46,058 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08547726430824511, R2: 0.9327110287083333, Stacking Model MAE: 0.1455455860783682, Stacking Model MAPE: inf%
2024-11-02 22:39:46,069 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.5452865064695%
2024-11-02 22:39:46,072 - INFO - Start away_goals predictions
2024-11-02 22:39:46,074 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 22:39:46,078 - INFO - Residual model train data selected
2024-11-02 22:39:46,088 - INFO - Residual model scaler loaded
2024-11-02 22:39:46,368 - INFO - Residual model successfully fitted
2024-11-02 22:39:46,718 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-11-02 22:39:46,718 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 22:39:49,441 - INFO - away_goals predictions: [ 1.13549286  0.76778383 -0.13817197 ...  1.0603691   0.96216413
  1.00664656]
2024-11-02 22:39:49,445 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-02 22:40:01,765 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpgafnucw4\tmp4c9j2fu2\assets
2024-11-02 23:38:24,847 - INFO - Model directory checked/created.
2024-11-02 23:38:30,631 - INFO - Data loaded from ./Model_build1/model_data_training_withPoisson.xlsx with shape: (13557, 63)
2024-11-02 23:38:30,654 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5282, 51)
2024-11-02 23:38:30,670 - INFO - Data loaded with 5282 rows
2024-11-02 23:38:30,675 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13524 Filtered data shape: (13524, 63)
2024-11-02 23:38:31,156 - INFO - new real scores length: 274
2024-11-02 23:38:32,061 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-02 23:38:32,063 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-02 23:38:32,065 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-02 23:38:32,076 - INFO - data_with_error length: 239
2024-11-02 23:38:32,079 - INFO - prediction_df length: 5282
2024-11-02 23:38:32,083 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:38:35,559 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-02 23:38:35,561 - INFO - Data prepared for modeling. Feature shape: (13524, 50), Target shape: (13524,)
2024-11-02 23:38:35,572 - INFO - Data split into train and test. Train shape: (10819, 50), Test shape: (2705, 50)
2024-11-02 23:38:35,582 - INFO - Data split into train2 and test2. Train2 shape: (10819, 50), Test2 shape: (2705, 50)
2024-11-02 23:38:35,587 - INFO - Data scaling started.
2024-11-02 23:38:35,622 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-02 23:38:35,641 - INFO - Data scaling completed.
2024-11-02 23:38:35,643 - INFO - Feature Selection started.
2024-11-02 23:42:33,805 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-02 23:42:33,805 - INFO - Feature selection using RFE completed.
2024-11-02 23:42:33,805 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'away_draw_rate', 'home_average_points', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG']
2024-11-02 23:42:33,805 - INFO - First fit started
2024-11-02 23:47:48,657 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-02 23:47:50,356 - INFO - away_goals (1st fit) Stacking Model MSE: 0.09189628685086763, R2: 0.9259052399430511, Stacking Model MAE: 0.14704656218956583, Stacking Model MAPE: inf%
2024-11-02 23:47:50,356 - INFO - away_goals (1st fit) Stacking Model Within Range (0.3): 86.21072088724584%
2024-11-02 23:47:50,356 - INFO - Second fit started
2024-11-02 23:52:45,523 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-02 23:52:47,007 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.08529321114007385, R2: 0.9328559180944109, Stacking Model MAE: 0.14303522279502445, Stacking Model MAPE: inf%
2024-11-02 23:52:47,007 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 85.32347504621072%
2024-11-02 23:52:47,022 - INFO - Start away_goals predictions
2024-11-02 23:52:47,024 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-02 23:52:47,024 - INFO - Residual model train data selected
2024-11-02 23:52:47,024 - INFO - Residual model scaler loaded
2024-11-02 23:52:47,222 - INFO - Residual model successfully fitted
2024-11-02 23:52:47,540 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-11-02 23:52:47,540 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-02 23:52:50,289 - INFO - away_goals predictions: [0.90484959 0.88171829 0.72250029 ... 0.81572485 1.18316397 1.13831075]
2024-11-02 23:52:50,291 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-02 23:53:02,382 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmpcgln2w8q\tmppzfr48i5\assets
2024-11-03 02:00:23,115 - INFO - Model directory checked/created.
2024-11-03 02:00:29,353 - INFO - Data loaded from ./Model_build1/model_data_training_newPoisson.xlsx with shape: (13917, 65)
2024-11-03 02:00:29,405 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (5282, 51)
2024-11-03 02:00:29,408 - INFO - Data loaded with 5282 rows
2024-11-03 02:00:29,412 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 65)
2024-11-03 02:00:29,921 - INFO - new real scores length: 274
2024-11-03 02:00:30,072 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 02:00:30,072 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 02:00:30,072 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 02:00:30,087 - INFO - data_with_error length: 234
2024-11-03 02:00:30,091 - INFO - prediction_df length: 5282
2024-11-03 02:00:30,094 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:00:32,271 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-03 02:00:32,272 - INFO - Data prepared for modeling. Feature shape: (13883, 50), Target shape: (13883,)
2024-11-03 02:00:32,272 - INFO - Data split into train and test. Train shape: (11106, 50), Test shape: (2777, 50)
2024-11-03 02:00:32,272 - INFO - Data split into train2 and test2. Train2 shape: (11106, 50), Test2 shape: (2777, 50)
2024-11-03 02:00:32,272 - INFO - Data scaling started.
2024-11-03 02:00:32,309 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-03 02:00:32,309 - INFO - Data scaling completed.
2024-11-03 02:00:32,309 - INFO - Feature Selection started.
2024-11-03 02:04:51,272 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-03 02:04:51,272 - INFO - Feature selection using RFE completed.
2024-11-03 02:04:51,272 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Away_points_cum', 'Home_goal_difference_cum', 'home_draw_rate', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:04:51,272 - INFO - First fit started
2024-11-03 02:10:58,208 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-03 02:11:00,059 - INFO - away_goals (1st fit) Stacking Model MSE: 0.12851649258240214, R2: 0.9030238557812534, Stacking Model MAE: 0.17860757006014627, Stacking Model MAPE: inf%
2024-11-03 02:11:00,061 - INFO - away_goals (1st fit) Stacking Model Within Range (0.3): 81.63485776017285%
2024-11-03 02:11:00,063 - INFO - Second fit started
2024-11-03 02:13:56,978 - INFO - Model directory checked/created.
2024-11-03 02:14:03,709 - INFO - Data loaded from ./Model_build1/model_data_training_newPoisson.xlsx with shape: (13917, 65)
2024-11-03 02:14:03,750 - INFO - Data loaded from ./Model_build1/merged_data_prediction.csv with shape: (3760, 51)
2024-11-03 02:14:03,756 - INFO - Data loaded with 3760 rows
2024-11-03 02:14:03,758 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 65)
2024-11-03 02:14:04,228 - INFO - new real scores length: 274
2024-11-03 02:14:04,358 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 02:14:04,373 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 02:14:04,375 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 02:14:04,375 - INFO - data_with_error length: 173
2024-11-03 02:14:04,375 - INFO - prediction_df length: 3760
2024-11-03 02:14:04,389 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:14:06,395 - INFO - Imputer saved to ./models/imputer_away_goals.pkl
2024-11-03 02:14:06,397 - INFO - Data prepared for modeling. Feature shape: (13883, 50), Target shape: (13883,)
2024-11-03 02:14:06,402 - INFO - Data split into train and test. Train shape: (11106, 50), Test shape: (2777, 50)
2024-11-03 02:14:06,409 - INFO - Data split into train2 and test2. Train2 shape: (11106, 50), Test2 shape: (2777, 50)
2024-11-03 02:14:06,411 - INFO - Data scaling started.
2024-11-03 02:14:06,430 - INFO - Scaler saved to ./models/scaler_away_goals.pkl
2024-11-03 02:14:06,438 - INFO - Data scaling completed.
2024-11-03 02:14:06,439 - INFO - Feature Selection started.
2024-11-03 02:18:20,575 - INFO - RFE selector saved to ./models/rfe_away_goals_selector.pkl
2024-11-03 02:18:20,575 - INFO - Feature selection using RFE completed.
2024-11-03 02:18:20,575 - INFO - Selected Features: ['running_id', 'home_encoded', 'away_encoded', 'venue_encoded', 'Home_points_cum', 'Home_goal_difference_cum', 'home_draw_rate', 'away_average_points', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:18:20,575 - INFO - First fit started
2024-11-03 02:21:05,743 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0004s vs `on_train_batch_end` time: 0.0025s). Check your callbacks.
2024-11-03 02:22:49,824 - WARNING - Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0004s vs `on_train_batch_end` time: 0.0005s). Check your callbacks.
2024-11-03 02:24:08,614 - INFO - Stacking model for away_goals trained successfully on first split.
2024-11-03 02:24:10,351 - INFO - away_goals (1st fit) Stacking Model MSE: 0.12497639979471191, R2: 0.905695143659007, Stacking Model MAE: 0.17478152430131952, Stacking Model MAPE: inf%
2024-11-03 02:24:10,353 - INFO - away_goals (1st fit) Stacking Model Within Range (0.3): 82.39106949945985%
2024-11-03 02:24:10,355 - INFO - Second fit started
2024-11-03 02:29:34,527 - INFO - Stacking model for away_goals trained successfully on second split.
2024-11-03 02:29:36,269 - INFO - away_goals (2nd fit) Stacking Model MSE: 0.12906985048956218, R2: 0.8968699421654114, Stacking Model MAE: 0.17145831649080384, Stacking Model MAPE: inf%
2024-11-03 02:29:36,276 - INFO - away_goals (2nd fit) Stacking Model Within Range (0.3): 83.43536190133237%
2024-11-03 02:29:36,279 - INFO - Start away_goals predictions
2024-11-03 02:29:36,281 - INFO - columns of Prediction_df: Index(['running_id', 'season_encoded', 'league_encoded', 'home_encoded',
       'away_encoded', 'venue_encoded', 'home_league_position',
       'away_league_position', 'Home_points_cum', 'Away_points_cum',
       'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum',
       'Away_goal_difference_cum', 'Home_draws', 'Away_draws',
       'home_draw_rate', 'away_draw_rate', 'home_average_points',
       'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins',
       'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg',
       'home_shots_on_target_accuracy_rolling_avg',
       'away_shots_on_target_accuracy_rolling_avg',
       'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg',
       'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg',
       'home_goals_rolling_avg', 'away_goals_rolling_avg',
       'home_goal_difference_rolling_avg', 'away_goal_difference_rolling_avg',
       'referee_foul_rate', 'referee_encoded', 'Home_saves_mean',
       'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean',
       'Home_possession_mean', 'away_possession_mean',
       'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo',
       'away_team_elo', 'home_poisson_xG', 'away_poisson_xG'],
      dtype='object')
2024-11-03 02:29:36,284 - INFO - Residual model train data selected
2024-11-03 02:29:36,310 - INFO - Residual model scaler loaded
2024-11-03 02:29:36,589 - INFO - Residual model successfully fitted
2024-11-03 02:29:36,967 - INFO - Imputer loaded from ./models/imputer_away_goals.pkl
2024-11-03 02:29:36,967 - INFO - Prediction Selected Features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
2024-11-03 02:29:39,277 - INFO - away_goals predictions: [0.3571516  2.07177101 0.33172624 ... 1.00266185 2.13609946 0.97860891]
2024-11-03 02:29:39,277 - INFO - residual model prediction error: X has 30 features, but RandomForestRegressor is expecting 50 features as input.
2024-11-03 02:29:50,788 - INFO - Assets written to: \\192.168.0.77\Betting\Chatgpt\tempdir\tmp04cjr2iw\tmpdl7kdh0d\assets
2024-11-03 17:52:29,167 - INFO - Model directory checked/created.
2024-11-03 17:52:48,972 - INFO - Data loaded from ./Model_build1/data/model_data_training_newPoisson.xlsx with shape: (13917, 69)
2024-11-03 17:52:49,092 - INFO - Data loaded from ./Model_build1/data/merged_data_prediction.csv with shape: (3760, 55)
2024-11-03 17:52:49,093 - INFO - Data loaded with 3760 rows
2024-11-03 17:52:49,105 - INFO - Data filtered to only include away_goals from 0 to 6. rows: 13883 Filtered data shape: (13883, 69)
2024-11-03 17:52:51,018 - INFO - new real scores length: 274
2024-11-03 17:52:51,055 - INFO - Home MSE: 2.3183520599250937, Away MSE: 1.8614232209737829
2024-11-03 17:52:51,055 - INFO - Home R2: -0.2766731553578048, Away R2: -0.5502581836024207
2024-11-03 17:52:51,055 - INFO - Outcome MSE: 10.92134831460674, Outcome R2: -0.835518777848504
2024-11-03 17:52:51,068 - INFO - data_with_error length: 173
2024-11-03 17:52:51,073 - INFO - prediction_df length: 3760
2024-11-03 17:52:51,079 - INFO - Numeric features: ['running_id', 'season_encoded', 'league_encoded', 'home_encoded', 'away_encoded', 'venue_encoded', 'home_league_position', 'away_league_position', 'Home_points_cum', 'Away_points_cum', 'Home_team_matches', 'Away_team_matches', 'Home_goal_difference_cum', 'Away_goal_difference_cum', 'Home_draws', 'Away_draws', 'home_draw_rate', 'away_draw_rate', 'home_average_points', 'away_average_points', 'home_win_rate', 'away_win_rate', 'Home_wins', 'Away_wins', 'home_xG_rolling_avg', 'away_xG_rolling_avg', 'home_shots_on_target_accuracy_rolling_avg', 'away_shots_on_target_accuracy_rolling_avg', 'home_shots_on_target_rolling_avg', 'away_shots_on_target_rolling_avg', 'home_saves_accuracy_rolling_avg', 'away_saves_accuracy_rolling_avg', 'home_goals_rolling_avg', 'away_goals_rolling_avg', 'away_goal_difference_rolling_avg', 'home_goal_difference_rolling_avg', 'referee_foul_rate', 'referee_encoded', 'Home_saves_mean', 'Away_saves_mean', 'Home_fouls_mean', 'Away_fouls_mean', 'Home_possession_mean', 'away_possession_mean', 'Home_shot_on_target_mean', 'away_shot_on_target_mean', 'Home_offsides_mean', 'Away_offsides_mean', 'Home_passes_mean', 'Away_passes_mean', 'home_team_elo', 'away_team_elo', 'home_poisson_xG', 'away_poisson_xG']
